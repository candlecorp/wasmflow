var Vl=Object.defineProperty;var Ql=(r,e,t)=>e in r?Vl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var F=(r,e,t)=>(Ql(r,typeof e!="symbol"?e+"":e,t),t);import{s as ut,f as Qe,h as Oi,i as be,j as it,c as ct,u as dt,g as ft,d as ht,r as Gn,k as ee,l as Yl,b as es,m as Xl,p as $l,n as er,q as I,e as jl,v as Jl,w as Zl}from"../chunks/scheduler.eff79e75.js";import{S as Lt,i as Mt,e as Ce,a as J,d as Q,t as $,f as L,g as se,h as ae,j as fe,y as Fn,z as j,p as Rt,b as Tt,A as jt,s as xe,c as Ie,k as pe,x as de,r as st,u as at,v as ot,w as lt,B as en,C as Fs,D as pn,E as tn,m as Ft,n as xt,o as Or,F as Wl,G as Ya,H as Kl}from"../chunks/index.5d90bc61.js";import{w as eu}from"../chunks/index.765f5b7c.js";const tu=!1;var T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ts(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function wt(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function Ur(r,e){const t={},n={},i={$$scope:1};let s=r.length;for(;s--;){const a=r[s],o=e[s];if(o){for(const l in a)l in o||(n[l]=1);for(const l in o)i[l]||(t[l]=o[l],i[l]=1);r[s]=o}else for(const l in a)i[l]=1}for(const a in n)a in t||(t[a]=void 0);return t}const ru=tu;function nu(r){for(var e=r.length,t=0,n=0;n<e;){var i=r.charCodeAt(n++);if(i&4294967168)if(!(i&4294965248))t+=2;else{if(i>=55296&&i<=56319&&n<e){var s=r.charCodeAt(n);(s&64512)===56320&&(++n,i=((i&1023)<<10)+(s&1023)+65536)}i&4294901760?t+=4:t+=3}else{t++;continue}}return t}function iu(r,e,t){for(var n=r.length,i=t,s=0;s<n;){var a=r.charCodeAt(s++);if(a&4294967168)if(!(a&4294965248))e[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&s<n){var o=r.charCodeAt(s);(o&64512)===56320&&(++s,a=((a&1023)<<10)+(o&1023)+65536)}a&4294901760?(e[i++]=a>>18&7|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128):(e[i++]=a>>12&15|224,e[i++]=a>>6&63|128)}else{e[i++]=a;continue}e[i++]=a&63|128}}var su=new TextEncoder,au=50;function ou(r,e,t){su.encodeInto(r,e.subarray(t))}function lu(r,e,t){r.length>au?ou(r,e,t):iu(r,e,t)}var uu=4096;function Xa(r,e,t){for(var n=e,i=n+t,s=[],a="";n<i;){var o=r[n++];if(!(o&128))s.push(o);else if((o&224)===192){var l=r[n++]&63;s.push((o&31)<<6|l)}else if((o&240)===224){var l=r[n++]&63,u=r[n++]&63;s.push((o&31)<<12|l<<6|u)}else if((o&248)===240){var l=r[n++]&63,u=r[n++]&63,c=r[n++]&63,d=(o&7)<<18|l<<12|u<<6|c;d>65535&&(d-=65536,s.push(d>>>10&1023|55296),d=56320|d&1023),s.push(d)}else s.push(o);s.length>=uu&&(a+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(a+=String.fromCharCode.apply(String,s)),a}var cu=new TextDecoder,du=200;function fu(r,e,t){var n=r.subarray(e,e+t);return cu.decode(n)}function hu(r,e,t){return t>du?fu(r,e,t):Xa(r,e,t)}var mn=function(){function r(e,t){this.type=e,this.data=t}return r}(),pu=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pt=function(r){pu(e,r);function e(t){var n=r.call(this,t)||this,i=Object.create(e.prototype);return Object.setPrototypeOf(n,i),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:e.name}),n}return e}(Error),Mr=4294967295;function mu(r,e,t){var n=t/4294967296,i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function $a(r,e,t){var n=Math.floor(t/4294967296),i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function ja(r,e){var t=r.getInt32(e),n=r.getUint32(e+4);return t*4294967296+n}function vu(r,e){var t=r.getUint32(e),n=r.getUint32(e+4);return t*4294967296+n}var gu=-1,yu=4294967296-1,Eu=17179869184-1;function bu(r){var e=r.sec,t=r.nsec;if(e>=0&&t>=0&&e<=Eu)if(t===0&&e<=yu){var n=new Uint8Array(4),i=new DataView(n.buffer);return i.setUint32(0,e),n}else{var s=e/4294967296,a=e&4294967295,n=new Uint8Array(8),i=new DataView(n.buffer);return i.setUint32(0,t<<2|s&3),i.setUint32(4,a),n}else{var n=new Uint8Array(12),i=new DataView(n.buffer);return i.setUint32(0,t),$a(i,4,e),n}}function _u(r){var e=r.getTime(),t=Math.floor(e/1e3),n=(e-t*1e3)*1e6,i=Math.floor(n/1e9);return{sec:t+i,nsec:n-i*1e9}}function wu(r){if(r instanceof Date){var e=_u(r);return bu(e)}else return null}function Su(r){var e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:{var t=e.getUint32(0),n=0;return{sec:t,nsec:n}}case 8:{var i=e.getUint32(0),s=e.getUint32(4),t=(i&3)*4294967296+s,n=i>>>2;return{sec:t,nsec:n}}case 12:{var t=ja(e,4),n=e.getUint32(0);return{sec:t,nsec:n}}default:throw new pt("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(r.length))}}function Ru(r){var e=Su(r);return new Date(e.sec*1e3+e.nsec/1e6)}var Tu={type:gu,encode:wu,decode:Ru},Ja=function(){function r(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Tu)}return r.prototype.register=function(e){var t=e.type,n=e.encode,i=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=i;else{var s=1+t;this.builtInEncoders[s]=n,this.builtInDecoders[s]=i}},r.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){var i=this.builtInEncoders[n];if(i!=null){var s=i(e,t);if(s!=null){var a=-1-n;return new mn(a,s)}}}for(var n=0;n<this.encoders.length;n++){var i=this.encoders[n];if(i!=null){var s=i(e,t);if(s!=null){var a=n;return new mn(a,s)}}}return e instanceof mn?e:null},r.prototype.decode=function(e,t,n){var i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,n):new mn(t,e)},r.defaultCodec=new r,r}();function xn(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Uint8Array.from(r)}function Au(r){if(r instanceof ArrayBuffer)return new DataView(r);var e=xn(r);return new DataView(e.buffer,e.byteOffset,e.byteLength)}var Fu=100,xu=2048,Iu=function(){function r(e){var t,n,i,s,a,o,l,u;this.extensionCodec=(t=e==null?void 0:e.extensionCodec)!==null&&t!==void 0?t:Ja.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(n=e==null?void 0:e.useBigInt64)!==null&&n!==void 0?n:!1,this.maxDepth=(i=e==null?void 0:e.maxDepth)!==null&&i!==void 0?i:Fu,this.initialBufferSize=(s=e==null?void 0:e.initialBufferSize)!==null&&s!==void 0?s:xu,this.sortKeys=(a=e==null?void 0:e.sortKeys)!==null&&a!==void 0?a:!1,this.forceFloat32=(o=e==null?void 0:e.forceFloat32)!==null&&o!==void 0?o:!1,this.ignoreUndefined=(l=e==null?void 0:e.ignoreUndefined)!==null&&l!==void 0?l:!1,this.forceIntegerToFloat=(u=e==null?void 0:e.forceIntegerToFloat)!==null&&u!==void 0?u:!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return r.prototype.reinitializeState=function(){this.pos=0},r.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},r.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},r.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)},r.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)},r.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),i=new DataView(t);n.set(this.bytes),this.view=i,this.bytes=n},r.prototype.encodeNil=function(){this.writeU8(192)},r.prototype.encodeBoolean=function(e){e===!1?this.writeU8(194):this.writeU8(195)},r.prototype.encodeNumber=function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)},r.prototype.encodeNumberAsFloat=function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},r.prototype.encodeBigInt64=function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))},r.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error("Too long string: ".concat(e," bytes in UTF-8"))},r.prototype.encodeString=function(e){var t=5,n=nu(e);this.ensureBufferSizeToWrite(t+n),this.writeStringHeader(n),lu(e,this.bytes,this.pos),this.pos+=n},r.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)))},r.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error("Too large binary: ".concat(t));var n=xn(e);this.writeU8a(n)},r.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error("Too large array: ".concat(n));for(var i=0,s=e;i<s.length;i++){var a=s[i];this.doEncode(a,t+1)}},r.prototype.countWithoutUndefined=function(e,t){for(var n=0,i=0,s=t;i<s.length;i++){var a=s[i];e[a]!==void 0&&n++}return n},r.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error("Too large map object: ".concat(i));for(var s=0,a=n;s<a.length;s++){var o=a[s],l=e[o];this.ignoreUndefined&&l===void 0||(this.encodeString(o),this.doEncode(l,t+1))}},r.prototype.encodeExtension=function(e){var t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error("Too large extension object: ".concat(t));this.writeI8(e.type),this.writeU8a(e.data)},r.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},r.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},r.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},r.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},r.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},r.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},r.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},r.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},r.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},r.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),mu(this.view,this.pos,e),this.pos+=8},r.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),$a(this.view,this.pos,e),this.pos+=8},r.prototype.writeBigUint64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8},r.prototype.writeBigInt64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8},r}();function Cu(r,e){var t=new Iu(e);return t.encodeSharedRef(r)}function hi(r){return"".concat(r<0?"-":"","0x").concat(Math.abs(r).toString(16).padStart(2,"0"))}var Ou=16,Uu=16,Nu=function(){function r(e,t){e===void 0&&(e=Ou),t===void 0&&(t=Uu),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return r.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},r.prototype.find=function(e,t,n){var i=this.caches[n-1];e:for(var s=0,a=i;s<a.length;s++){for(var o=a[s],l=o.bytes,u=0;u<n;u++)if(l[u]!==e[t+u])continue e;return o.str}return null},r.prototype.store=function(e,t){var n=this.caches[e.length-1],i={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)},r.prototype.decode=function(e,t,n){var i=this.find(e,t,n);if(i!=null)return this.hit++,i;this.miss++;var s=Xa(e,t,n),a=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(a,s),s},r}(),Du=globalThis&&globalThis.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},pi=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},xs=globalThis&&globalThis.__asyncValues||function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(o,l){a=r[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},dr=globalThis&&globalThis.__await||function(r){return this instanceof dr?(this.v=r,this):new dr(r)},Pu=globalThis&&globalThis.__asyncGenerator||function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){n[f]&&(i[f]=function(h){return new Promise(function(v,g){s.push([f,h,v,g])>1||o(f,h)})})}function o(f,h){try{l(n[f](h))}catch(v){d(s[0][3],v)}}function l(f){f.value instanceof dr?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}function u(f){o("next",f)}function c(f){o("throw",f)}function d(f,h){f(h),s.shift(),s.length&&o(s[0][0],s[0][1])}},Is="array",vn="map_key",ku="map_value",Lu=function(r){return typeof r=="string"||typeof r=="number"},Br=-1,rs=new DataView(new ArrayBuffer(0)),Mu=new Uint8Array(rs.buffer);try{rs.getInt8(0)}catch(r){if(!(r instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var Ui=RangeError,Cs=new Ui("Insufficient data"),Bu=new Nu,qu=function(){function r(e){var t,n,i,s,a,o,l;this.totalPos=0,this.pos=0,this.view=rs,this.bytes=Mu,this.headByte=Br,this.stack=[],this.extensionCodec=(t=e==null?void 0:e.extensionCodec)!==null&&t!==void 0?t:Ja.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(n=e==null?void 0:e.useBigInt64)!==null&&n!==void 0?n:!1,this.maxStrLength=(i=e==null?void 0:e.maxStrLength)!==null&&i!==void 0?i:Mr,this.maxBinLength=(s=e==null?void 0:e.maxBinLength)!==null&&s!==void 0?s:Mr,this.maxArrayLength=(a=e==null?void 0:e.maxArrayLength)!==null&&a!==void 0?a:Mr,this.maxMapLength=(o=e==null?void 0:e.maxMapLength)!==null&&o!==void 0?o:Mr,this.maxExtLength=(l=e==null?void 0:e.maxExtLength)!==null&&l!==void 0?l:Mr,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:Bu}return r.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=Br,this.stack.length=0},r.prototype.setBuffer=function(e){this.bytes=xn(e),this.view=Au(this.bytes),this.pos=0},r.prototype.appendBuffer=function(e){if(this.headByte===Br&&!this.hasRemaining(1))this.setBuffer(e);else{var t=this.bytes.subarray(this.pos),n=xn(e),i=new Uint8Array(t.length+n.length);i.set(t),i.set(n,t.length),this.setBuffer(i)}},r.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},r.prototype.createExtraByteError=function(e){var t=this,n=t.view,i=t.pos;return new RangeError("Extra ".concat(n.byteLength-i," of ").concat(n.byteLength," byte(s) found at buffer[").concat(e,"]"))},r.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},r.prototype.decodeMulti=function(e){return pi(this,function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}})},r.prototype.decodeAsync=function(e){var t,n,i,s,a,o,l;return Du(this,void 0,void 0,function(){var u,c,d,f,h,v,g,m;return pi(this,function(E){switch(E.label){case 0:u=!1,E.label=1;case 1:E.trys.push([1,6,7,12]),t=!0,n=xs(e),E.label=2;case 2:return[4,n.next()];case 3:if(i=E.sent(),s=i.done,!!s)return[3,5];l=i.value,t=!1;try{if(d=l,u)throw this.createExtraByteError(this.totalPos);this.appendBuffer(d);try{c=this.doDecodeSync(),u=!0}catch(w){if(!(w instanceof Ui))throw w}this.totalPos+=this.pos}finally{t=!0}E.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return f=E.sent(),a={error:f},[3,12];case 7:return E.trys.push([7,,10,11]),!t&&!s&&(o=n.return)?[4,o.call(n)]:[3,9];case 8:E.sent(),E.label=9;case 9:return[3,11];case 10:if(a)throw a.error;return[7];case 11:return[7];case 12:if(u){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,c]}throw h=this,v=h.headByte,g=h.pos,m=h.totalPos,new RangeError("Insufficient data in parsing ".concat(hi(v)," at ").concat(m," (").concat(g," in the current buffer)"))}})})},r.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},r.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},r.prototype.decodeMultiAsync=function(e,t){return Pu(this,arguments,function(){var i,s,a,o,l,u,c,d,f,h,v,g;return pi(this,function(m){switch(m.label){case 0:i=t,s=-1,m.label=1;case 1:m.trys.push([1,15,16,21]),a=!0,o=xs(e),m.label=2;case 2:return[4,dr(o.next())];case 3:if(l=m.sent(),f=l.done,!!f)return[3,14];g=l.value,a=!1,m.label=4;case 4:if(m.trys.push([4,,12,13]),u=g,t&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(u),i&&(s=this.readArraySize(),i=!1,this.complete()),m.label=5;case 5:m.trys.push([5,10,,11]),m.label=6;case 6:return[4,dr(this.doDecodeSync())];case 7:return[4,m.sent()];case 8:return m.sent(),--s===0?[3,9]:[3,6];case 9:return[3,11];case 10:if(c=m.sent(),!(c instanceof Ui))throw c;return[3,11];case 11:return this.totalPos+=this.pos,[3,13];case 12:return a=!0,[7];case 13:return[3,2];case 14:return[3,21];case 15:return d=m.sent(),h={error:d},[3,21];case 16:return m.trys.push([16,,19,20]),!a&&!f&&(v=o.return)?[4,dr(v.call(o))]:[3,18];case 17:m.sent(),m.label=18;case 18:return[3,20];case 19:if(h)throw h.error;return[7];case 20:return[7];case 21:return[2]}})})},r.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){var n=e-128;if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e<160){var n=e-144;if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else{var i=e-160;t=this.decodeUtf8String(i,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){var i=this.lookU8();t=this.decodeUtf8String(i,1)}else if(e===218){var i=this.lookU16();t=this.decodeUtf8String(i,2)}else if(e===219){var i=this.lookU32();t=this.decodeUtf8String(i,4)}else if(e===220){var n=this.readU16();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===221){var n=this.readU32();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===222){var n=this.readU16();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===223){var n=this.readU32();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===196){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(e===197){var n=this.lookU16();t=this.decodeBinary(n,2)}else if(e===198){var n=this.lookU32();t=this.decodeBinary(n,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){var n=this.lookU8();t=this.decodeExtension(n,1)}else if(e===200){var n=this.lookU16();t=this.decodeExtension(n,2)}else if(e===201){var n=this.lookU32();t=this.decodeExtension(n,4)}else throw new pt("Unrecognized type byte: ".concat(hi(e)));this.complete();for(var s=this.stack;s.length>0;){var a=s[s.length-1];if(a.type===Is)if(a.array[a.position]=t,a.position++,a.position===a.size)s.pop(),t=a.array;else continue e;else if(a.type===vn){if(!Lu(t))throw new pt("The type of key must be string or number but "+typeof t);if(t==="__proto__")throw new pt("The key __proto__ is not allowed");a.key=t,a.type=ku;continue e}else if(a.map[a.key]=t,a.readCount++,a.readCount===a.size)s.pop(),t=a.map;else{a.key=null,a.type=vn;continue e}}return t}},r.prototype.readHeadByte=function(){return this.headByte===Br&&(this.headByte=this.readU8()),this.headByte},r.prototype.complete=function(){this.headByte=Br},r.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new pt("Unrecognized array type byte: ".concat(hi(e)))}}},r.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new pt("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:vn,size:e,key:null,readCount:0,map:{}})},r.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new pt("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:Is,size:e,array:new Array(e),position:0})},r.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new pt("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw Cs;var i=this.pos+t,s;return this.stateIsMapKey()&&(!((n=this.keyDecoder)===null||n===void 0)&&n.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,i,e):s=hu(this.bytes,i,e),this.pos+=t+e,s},r.prototype.stateIsMapKey=function(){if(this.stack.length>0){var e=this.stack[this.stack.length-1];return e.type===vn}return!1},r.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new pt("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw Cs;var n=this.pos+t,i=this.bytes.subarray(n,n+e);return this.pos+=t+e,i},r.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new pt("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,n,this.context)},r.prototype.lookU8=function(){return this.view.getUint8(this.pos)},r.prototype.lookU16=function(){return this.view.getUint16(this.pos)},r.prototype.lookU32=function(){return this.view.getUint32(this.pos)},r.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},r.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},r.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},r.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},r.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},r.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},r.prototype.readU64=function(){var e=vu(this.view,this.pos);return this.pos+=8,e},r.prototype.readI64=function(){var e=ja(this.view,this.pos);return this.pos+=8,e},r.prototype.readU64AsBigInt=function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e},r.prototype.readI64AsBigInt=function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e},r.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},r.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},r}();function zu(r,e){var t=new qu(e);return t.decode(r)}function Hu(){for(var r=0,e,t,n="";r<arguments.length;)(e=arguments[r++])&&(t=Za(e))&&(n&&(n+=" "),n+=t);return n}function Za(r){if(typeof r=="string")return r;for(var e,t="",n=0;n<r.length;n++)r[n]&&(e=Za(r[n]))&&(t&&(t+=" "),t+=e);return t}var ns="-";function Gu(r){var e=Qu(r),t=r.conflictingClassGroups,n=r.conflictingClassGroupModifiers,i=n===void 0?{}:n;function s(o){var l=o.split(ns);return l[0]===""&&l.length!==1&&l.shift(),Wa(l,e)||Vu(o)}function a(o,l){var u=t[o]||[];return l&&i[o]?[].concat(u,i[o]):u}return{getClassGroupId:s,getConflictingClassGroupIds:a}}function Wa(r,e){var a;if(r.length===0)return e.classGroupId;var t=r[0],n=e.nextPart.get(t),i=n?Wa(r.slice(1),n):void 0;if(i)return i;if(e.validators.length!==0){var s=r.join(ns);return(a=e.validators.find(function(o){var l=o.validator;return l(s)}))==null?void 0:a.classGroupId}}var Os=/^\[(.+)\]$/;function Vu(r){if(Os.test(r)){var e=Os.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}}function Qu(r){var e=r.theme,t=r.prefix,n={nextPart:new Map,validators:[]},i=Xu(Object.entries(r.classGroups),t);return i.forEach(function(s){var a=s[0],o=s[1];Ni(o,n,a,e)}),n}function Ni(r,e,t,n){r.forEach(function(i){if(typeof i=="string"){var s=i===""?e:Us(e,i);s.classGroupId=t;return}if(typeof i=="function"){if(Yu(i)){Ni(i(n),e,t,n);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(function(a){var o=a[0],l=a[1];Ni(l,Us(e,o),t,n)})})}function Us(r,e){var t=r;return e.split(ns).forEach(function(n){t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t}function Yu(r){return r.isThemeGetter}function Xu(r,e){return e?r.map(function(t){var n=t[0],i=t[1],s=i.map(function(a){return typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(function(o){var l=o[0],u=o[1];return[e+l,u]})):a});return[n,s]}):r}function $u(r){if(r<1)return{get:function(){},set:function(){}};var e=0,t=new Map,n=new Map;function i(s,a){t.set(s,a),e++,e>r&&(e=0,n=t,t=new Map)}return{get:function(a){var o=t.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set:function(a,o){t.has(a)?t.set(a,o):i(a,o)}}}var Ka="!";function ju(r){var e=r.separator||":",t=e.length===1,n=e[0],i=e.length;return function(a){for(var o=[],l=0,u=0,c,d=0;d<a.length;d++){var f=a[d];if(l===0){if(f===n&&(t||a.slice(d,d+i)===e)){o.push(a.slice(u,d)),u=d+i;continue}if(f==="/"){c=d;continue}}f==="["?l++:f==="]"&&l--}var h=o.length===0?a:a.substring(u),v=h.startsWith(Ka),g=v?h.substring(1):h,m=c&&c>u?c-u:void 0;return{modifiers:o,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:m}}}function Ju(r){if(r.length<=1)return r;var e=[],t=[];return r.forEach(function(n){var i=n[0]==="[";i?(e.push.apply(e,t.sort().concat([n])),t=[]):t.push(n)}),e.push.apply(e,t.sort()),e}function Zu(r){return{cache:$u(r.cacheSize),splitModifiers:ju(r),...Gu(r)}}var Wu=/\s+/;function Ku(r,e){var t=e.splitModifiers,n=e.getClassGroupId,i=e.getConflictingClassGroupIds,s=new Set;return r.trim().split(Wu).map(function(a){var o=t(a),l=o.modifiers,u=o.hasImportantModifier,c=o.baseClassName,d=o.maybePostfixModifierPosition,f=n(d?c.substring(0,d):c),h=!!d;if(!f){if(!d)return{isTailwindClass:!1,originalClassName:a};if(f=n(c),!f)return{isTailwindClass:!1,originalClassName:a};h=!1}var v=Ju(l).join(":"),g=u?v+Ka:v;return{isTailwindClass:!0,modifierId:g,classGroupId:f,originalClassName:a,hasPostfixModifier:h}}).reverse().filter(function(a){if(!a.isTailwindClass)return!0;var o=a.modifierId,l=a.classGroupId,u=a.hasPostfixModifier,c=o+l;return s.has(c)?!1:(s.add(c),i(l,u).forEach(function(d){return s.add(o+d)}),!0)}).reverse().map(function(a){return a.originalClassName}).join(" ")}function ec(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var n,i,s,a=o;function o(u){var c=e[0],d=e.slice(1),f=d.reduce(function(h,v){return v(h)},c());return n=Zu(f),i=n.cache.get,s=n.cache.set,a=l,l(u)}function l(u){var c=i(u);if(c)return c;var d=Ku(u,n);return s(u,d),d}return function(){return a(Hu.apply(null,arguments))}}function ce(r){var e=function(n){return n[r]||[]};return e.isThemeGetter=!0,e}var eo=/^\[(?:([a-z-]+):)?(.+)\]$/i,tc=/^\d+\/\d+$/,rc=new Set(["px","full","screen"]),nc=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ic=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,sc=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function We(r){return Zt(r)||rc.has(r)||tc.test(r)||Di(r)}function Di(r){return nr(r,"length",dc)}function ac(r){return nr(r,"size",to)}function oc(r){return nr(r,"position",to)}function lc(r){return nr(r,"url",fc)}function gn(r){return nr(r,"number",Zt)}function Zt(r){return!Number.isNaN(Number(r))}function uc(r){return r.endsWith("%")&&Zt(r.slice(0,-1))}function qr(r){return Ns(r)||nr(r,"number",Ns)}function K(r){return eo.test(r)}function zr(){return!0}function Ht(r){return nc.test(r)}function cc(r){return nr(r,"",hc)}function nr(r,e,t){var n=eo.exec(r);return n?n[1]?n[1]===e:t(n[2]):!1}function dc(r){return ic.test(r)}function to(){return!1}function fc(r){return r.startsWith("url(")}function Ns(r){return Number.isInteger(Number(r))}function hc(r){return sc.test(r)}function pc(){var r=ce("colors"),e=ce("spacing"),t=ce("blur"),n=ce("brightness"),i=ce("borderColor"),s=ce("borderRadius"),a=ce("borderSpacing"),o=ce("borderWidth"),l=ce("contrast"),u=ce("grayscale"),c=ce("hueRotate"),d=ce("invert"),f=ce("gap"),h=ce("gradientColorStops"),v=ce("gradientColorStopPositions"),g=ce("inset"),m=ce("margin"),E=ce("opacity"),w=ce("padding"),A=ce("saturate"),S=ce("scale"),B=ce("sepia"),M=ce("skew"),W=ce("space"),Z=ce("translate"),P=function(){return["auto","contain","none"]},oe=function(){return["auto","hidden","clip","visible","scroll"]},ne=function(){return["auto",K,e]},N=function(){return[K,e]},ie=function(){return["",We]},re=function(){return["auto",Zt,K]},q=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},me=function(){return["solid","dashed","dotted","double","none"]},Ae=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},_e=function(){return["start","end","center","between","around","evenly","stretch"]},ye=function(){return["","0",K]},Pe=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Oe=function(){return[Zt,gn]},Fe=function(){return[Zt,K]};return{cacheSize:500,theme:{colors:[zr],spacing:[We],blur:["none","",Ht,K],brightness:Oe(),borderColor:[r],borderRadius:["none","","full",Ht,K],borderSpacing:N(),borderWidth:ie(),contrast:Oe(),grayscale:ye(),hueRotate:Fe(),invert:ye(),gap:N(),gradientColorStops:[r],gradientColorStopPositions:[uc,Di],inset:ne(),margin:ne(),opacity:Oe(),padding:N(),saturate:Oe(),scale:Oe(),sepia:ye(),skew:Fe(),space:N(),translate:N()},classGroups:{aspect:[{aspect:["auto","square","video",K]}],container:["container"],columns:[{columns:[Ht]}],"break-after":[{"break-after":Pe()}],"break-before":[{"break-before":Pe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(q(),[K])}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",qr]}],basis:[{basis:ne()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",K]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",qr]}],"grid-cols":[{"grid-cols":[zr]}],"col-start-end":[{col:["auto",{span:["full",qr]},K]}],"col-start":[{"col-start":re()}],"col-end":[{"col-end":re()}],"grid-rows":[{"grid-rows":[zr]}],"row-start-end":[{row:["auto",{span:[qr]},K]}],"row-start":[{"row-start":re()}],"row-end":[{"row-end":re()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",K]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",K]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(_e())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(_e(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(_e(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[W]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[W]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",K,e]}],"min-w":[{"min-w":["min","max","fit",K,We]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ht]},Ht,K]}],h:[{h:[K,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",K,We]}],"max-h":[{"max-h":[K,e,"min","max","fit"]}],"font-size":[{text:["base",Ht,Di]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gn]}],"font-family":[{font:[zr]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",K]}],"line-clamp":[{"line-clamp":["none",Zt,gn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",K,We]}],"list-image":[{"list-image":["none",K]}],"list-style-type":[{list:["none","disc","decimal",K]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[E]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[E]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(me(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",We]}],"underline-offset":[{"underline-offset":["auto",K,We]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",K]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",K]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[E]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(q(),[oc])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ac]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lc]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[E]}],"border-style":[{border:[].concat(me(),["hidden"])}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[E]}],"divide-style":[{divide:me()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:[""].concat(me())}],"outline-offset":[{"outline-offset":[K,We]}],"outline-w":[{outline:[We]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ie()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[E]}],"ring-offset-w":[{"ring-offset":[We]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Ht,cc]}],"shadow-color":[{shadow:[zr]}],opacity:[{opacity:[E]}],"mix-blend":[{"mix-blend":Ae()}],"bg-blend":[{"bg-blend":Ae()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ht,K]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[A]}],sepia:[{sepia:[B]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[E]}],"backdrop-saturate":[{"backdrop-saturate":[A]}],"backdrop-sepia":[{"backdrop-sepia":[B]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",K]}],duration:[{duration:Fe()}],ease:[{ease:["linear","in","out","in-out",K]}],delay:[{delay:Fe()}],animate:[{animate:["none","spin","ping","pulse","bounce",K]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[qr,K]}],"translate-x":[{"translate-x":[Z]}],"translate-y":[{"translate-y":[Z]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",K]}],accent:[{accent:["auto",r]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",K]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",K]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[We,gn]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var At=ec(pc);function mi(r){let e,t,n,i,s,a;const o=r[10].default,l=ct(o,r,r[9],null);let u=[{type:t=r[0]?void 0:r[1]},{href:r[0]},{role:n=r[0]?"link":"button"},r[3],{class:r[2]}],c={};for(let d=0;d<u.length;d+=1)c=be(c,u[d]);return{c(){e=se(r[0]?"a":"button"),l&&l.c(),this.h()},l(d){e=ae(d,((r[0]?"a":"button")||"null").toUpperCase(),{type:!0,href:!0,role:!0,class:!0});var f=fe(e);l&&l.l(f),f.forEach(L),this.h()},h(){Fn(r[0]?"a":"button")(e,c)},m(d,f){J(d,e,f),l&&l.m(e,null),i=!0,s||(a=[j(e,"click",r[11]),j(e,"change",r[12]),j(e,"keydown",r[13]),j(e,"keyup",r[14]),j(e,"touchstart",r[15],{passive:!0}),j(e,"touchend",r[16]),j(e,"touchcancel",r[17]),j(e,"mouseenter",r[18]),j(e,"mouseleave",r[19])],s=!0)},p(d,f){l&&l.p&&(!i||f&512)&&dt(l,o,d,d[9],i?ht(o,d[9],f,null):ft(d[9]),null),Fn(d[0]?"a":"button")(e,c=Ur(u,[(!i||f&3&&t!==(t=d[0]?void 0:d[1]))&&{type:t},(!i||f&1)&&{href:d[0]},(!i||f&1&&n!==(n=d[0]?"link":"button"))&&{role:n},f&8&&d[3],(!i||f&4)&&{class:d[2]}]))},i(d){i||(Q(l,d),i=!0)},o(d){$(l,d),i=!1},d(d){d&&L(e),l&&l.d(d),s=!1,Gn(a)}}}function mc(r){let e=r[0]?"a":"button",t,n,i=(r[0]?"a":"button")&&mi(r);return{c(){i&&i.c(),t=Ce()},l(s){i&&i.l(s),t=Ce()},m(s,a){i&&i.m(s,a),J(s,t,a),n=!0},p(s,[a]){s[0],e?ut(e,s[0]?"a":"button")?(i.d(1),i=mi(s),e=s[0]?"a":"button",i.c(),i.m(t.parentNode,t)):i.p(s,a):(i=mi(s),e=s[0]?"a":"button",i.c(),i.m(t.parentNode,t))},i(s){n||(Q(i,s),n=!0)},o(s){$(i,s),n=!1},d(s){s&&L(t),i&&i.d(s)}}}function vc(r,e,t){const n=["pill","outline","size","href","type","color","shadow"];let i=Qe(e,n),{$$slots:s={},$$scope:a}=e;const o=Oi("group");let{pill:l=!1}=e,{outline:u=!1}=e,{size:c=o?"sm":"md"}=e,{href:d=void 0}=e,{type:f="button"}=e,{color:h=o?u?"dark":"alternative":"primary"}=e,{shadow:v=!1}=e;const g={alternative:"text-gray-900 bg-white border border-gray-200 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-400 hover:text-primary-700 focus:text-primary-700 dark:focus:text-white dark:hover:text-white",blue:"text-white bg-blue-700 hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-700",dark:"text-white bg-gray-800 hover:bg-gray-900 dark:bg-gray-800 dark:hover:bg-gray-700",green:"text-white bg-green-700 hover:bg-green-800 dark:bg-green-600 dark:hover:bg-green-700",light:"text-gray-900 bg-white border border-gray-300 hover:bg-gray-100 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600",primary:"text-white bg-primary-700 hover:bg-primary-800 dark:bg-primary-600 dark:hover:bg-primary-700",purple:"text-white bg-purple-700 hover:bg-purple-800 dark:bg-purple-600 dark:hover:bg-purple-700",red:"text-white bg-red-700 hover:bg-red-800 dark:bg-red-600 dark:hover:bg-red-700",yellow:"text-white bg-yellow-400 hover:bg-yellow-500 ",none:""},m={alternative:"focus:ring-gray-200 dark:focus:ring-gray-700",blue:"focus:ring-blue-300 dark:focus:ring-blue-800",dark:"focus:ring-gray-300 dark:focus:ring-gray-700",green:"focus:ring-green-300 dark:focus:ring-green-800",light:"focus:ring-gray-200 dark:focus:ring-gray-700",primary:"focus:ring-primary-300 dark:focus:ring-primary-800",purple:"focus:ring-purple-300 dark:focus:ring-purple-900",red:"focus:ring-red-300 dark:focus:ring-red-900",yellow:"focus:ring-yellow-300 dark:focus:ring-yellow-900",none:""},E={alternative:"shadow-gray-500/50 dark:shadow-gray-800/80",blue:"shadow-blue-500/50 dark:shadow-blue-800/80",dark:"shadow-gray-500/50 dark:shadow-gray-800/80",green:"shadow-green-500/50 dark:shadow-green-800/80",light:"shadow-gray-500/50 dark:shadow-gray-800/80",primary:"shadow-primary-500/50 dark:shadow-primary-800/80",purple:"shadow-purple-500/50 dark:shadow-purple-800/80",red:"shadow-red-500/50 dark:shadow-red-800/80 ",yellow:"shadow-yellow-500/50 dark:shadow-yellow-800/80 ",none:""},w={alternative:"text-gray-900 hover:text-white border border-gray-800 hover:bg-gray-900 focus:bg-gray-900 focus:text-white focus:ring-gray-300 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-800",blue:"text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-600",dark:"text-gray-900 hover:text-white border border-gray-800 hover:bg-gray-900 focus:bg-gray-900 focus:text-white dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-600",green:"text-green-700 hover:text-white border border-green-700 hover:bg-green-800 dark:border-green-500 dark:text-green-500 dark:hover:text-white dark:hover:bg-green-600",light:"text-gray-500 hover:text-gray-900 bg-white border border-gray-200 dark:border-gray-600 dark:hover:text-white dark:text-gray-400 hover:bg-gray-50 dark:bg-gray-700 dark:hover:bg-gray-600",primary:"text-primary-700 hover:text-white border border-primary-700 hover:bg-primary-700 dark:border-primary-500 dark:text-primary-500 dark:hover:text-white dark:hover:bg-primary-600",purple:"text-purple-700 hover:text-white border border-purple-700 hover:bg-purple-800 dark:border-purple-400 dark:text-purple-400 dark:hover:text-white dark:hover:bg-purple-500",red:"text-red-700 hover:text-white border border-red-700 hover:bg-red-800 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600",yellow:"text-yellow-400 hover:text-white border border-yellow-400 hover:bg-yellow-500 dark:border-yellow-300 dark:text-yellow-300 dark:hover:text-white dark:hover:bg-yellow-400",none:""},A={xs:"px-3 py-2 text-xs",sm:"px-4 py-2 text-sm",md:"px-5 py-2.5 text-sm",lg:"px-5 py-3 text-base",xl:"px-6 py-3.5 text-base"},S=()=>u||h==="alternative"||h==="light";let B;function M(q){ee.call(this,r,q)}function W(q){ee.call(this,r,q)}function Z(q){ee.call(this,r,q)}function P(q){ee.call(this,r,q)}function oe(q){ee.call(this,r,q)}function ne(q){ee.call(this,r,q)}function N(q){ee.call(this,r,q)}function ie(q){ee.call(this,r,q)}function re(q){ee.call(this,r,q)}return r.$$set=q=>{t(27,e=be(be({},e),it(q))),t(3,i=Qe(e,n)),"pill"in q&&t(4,l=q.pill),"outline"in q&&t(5,u=q.outline),"size"in q&&t(6,c=q.size),"href"in q&&t(0,d=q.href),"type"in q&&t(1,f=q.type),"color"in q&&t(7,h=q.color),"shadow"in q&&t(8,v=q.shadow),"$$scope"in q&&t(9,a=q.$$scope)},r.$$.update=()=>{t(2,B=At("text-center font-medium",o?"focus:ring-2":"focus:ring-4",o&&"focus:z-10",o||"focus:outline-none","inline-flex items-center justify-center "+A[c],u?w[h]:g[h],h==="alternative"&&(o?"dark:bg-gray-700 dark:text-white dark:border-gray-700 dark:hover:border-gray-600 dark:hover:bg-gray-600":"dark:bg-transparent dark:border-gray-600 dark:hover:border-gray-700"),u&&h==="dark"&&(o?"dark:text-white dark:border-white":"dark:text-gray-400 dark:border-gray-700"),m[h],S()&&o&&"border-l-0 first:border-l",o?l&&"first:rounded-l-full last:rounded-r-full"||"first:rounded-l-lg last:rounded-r-lg":l&&"rounded-full"||"rounded-lg",v&&"shadow-lg",v&&E[h],e.disabled&&"cursor-not-allowed opacity-50",e.class))},e=it(e),[d,f,B,i,l,u,c,h,v,a,s,M,W,Z,P,oe,ne,N,ie,re]}class gc extends Lt{constructor(e){super(),Mt(this,e,vc,mc,ut,{pill:4,outline:5,size:6,href:0,type:1,color:7,shadow:8})}}function yc(r){let e;const t=r[5].default,n=ct(t,r,r[4],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&16)&&dt(n,t,i,i[4],e?ht(t,i[4],s,null):ft(i[4]),null)},i(i){e||(Q(n,i),e=!0)},o(i){$(n,i),e=!1},d(i){n&&n.d(i)}}}function Ec(r){let e=r[0],t,n,i=r[0]&&vi(r);return{c(){i&&i.c(),t=Ce()},l(s){i&&i.l(s),t=Ce()},m(s,a){i&&i.m(s,a),J(s,t,a),n=!0},p(s,a){s[0]?e?ut(e,s[0])?(i.d(1),i=vi(s),e=s[0],i.c(),i.m(t.parentNode,t)):i.p(s,a):(i=vi(s),e=s[0],i.c(),i.m(t.parentNode,t)):e&&(i.d(1),i=null,e=s[0])},i(s){n||(Q(i,s),n=!0)},o(s){$(i,s),n=!1},d(s){s&&L(t),i&&i.d(s)}}}function vi(r){let e,t,n,i;const s=r[5].default,a=ct(s,r,r[4],null);let o=[r[3]],l={};for(let u=0;u<o.length;u+=1)l=be(l,o[u]);return{c(){e=se(r[0]),a&&a.c(),this.h()},l(u){e=ae(u,(r[0]||"null").toUpperCase(),{});var c=fe(e);a&&a.l(c),c.forEach(L),this.h()},h(){Fn(r[0])(e,l)},m(u,c){J(u,e,c),a&&a.m(e,null),t=!0,n||(i=Yl(r[2].call(null,e)),n=!0)},p(u,c){a&&a.p&&(!t||c&16)&&dt(a,s,u,u[4],t?ht(s,u[4],c,null):ft(u[4]),null),Fn(u[0])(e,l=Ur(o,[c&8&&u[3]]))},i(u){t||(Q(a,u),t=!0)},o(u){$(a,u),t=!1},d(u){u&&L(e),a&&a.d(u),n=!1,i()}}}function bc(r){let e,t,n,i;const s=[Ec,yc],a=[];function o(l,u){return l[1]?0:1}return e=o(r),t=a[e]=s[e](r),{c(){t.c(),n=Ce()},l(l){t.l(l),n=Ce()},m(l,u){a[e].m(l,u),J(l,n,u),i=!0},p(l,[u]){let c=e;e=o(l),e===c?a[e].p(l,u):(Rt(),$(a[c],1,1,()=>{a[c]=null}),Tt(),t=a[e],t?t.p(l,u):(t=a[e]=s[e](l),t.c()),Q(t,1),t.m(n.parentNode,n))},i(l){i||(Q(t),i=!0)},o(l){$(t),i=!1},d(l){l&&L(n),a[e].d(l)}}}function _c(r,e,t){const n=["tag","show","use"];let i=Qe(e,n),{$$slots:s={},$$scope:a}=e,{tag:o="div"}=e,{show:l}=e,{use:u=()=>{}}=e;return r.$$set=c=>{e=be(be({},e),it(c)),t(3,i=Qe(e,n)),"tag"in c&&t(0,o=c.tag),"show"in c&&t(1,l=c.show),"use"in c&&t(2,u=c.use),"$$scope"in c&&t(4,a=c.$$scope)},[o,l,u,i,a,s]}class wc extends Lt{constructor(e){super(),Mt(this,e,_c,bc,ut,{tag:0,show:1,use:2})}}function Sc(r){let e;const t=r[7].default,n=ct(t,r,r[6],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&64)&&dt(n,t,i,i[6],e?ht(t,i[6],s,null):ft(i[6]),null)},i(i){e||(Q(n,i),e=!0)},o(i){$(n,i),e=!1},d(i){n&&n.d(i)}}}function Rc(r){let e,t;const n=r[7].default,i=ct(n,r,r[6],null);let s=[r[3],{class:r[2]}],a={};for(let o=0;o<s.length;o+=1)a=be(a,s[o]);return{c(){e=se("label"),i&&i.c(),this.h()},l(o){e=ae(o,"LABEL",{class:!0});var l=fe(e);i&&i.l(l),l.forEach(L),this.h()},h(){jt(e,a)},m(o,l){J(o,e,l),i&&i.m(e,null),r[8](e),t=!0},p(o,l){i&&i.p&&(!t||l&64)&&dt(i,n,o,o[6],t?ht(n,o[6],l,null):ft(o[6]),null),jt(e,a=Ur(s,[l&8&&o[3],(!t||l&4)&&{class:o[2]}]))},i(o){t||(Q(i,o),t=!0)},o(o){$(i,o),t=!1},d(o){o&&L(e),i&&i.d(o),r[8](null)}}}function Tc(r){let e,t,n,i;const s=[Rc,Sc],a=[];function o(l,u){return l[0]?0:1}return e=o(r),t=a[e]=s[e](r),{c(){t.c(),n=Ce()},l(l){t.l(l),n=Ce()},m(l,u){a[e].m(l,u),J(l,n,u),i=!0},p(l,[u]){let c=e;e=o(l),e===c?a[e].p(l,u):(Rt(),$(a[c],1,1,()=>{a[c]=null}),Tt(),t=a[e],t?t.p(l,u):(t=a[e]=s[e](l),t.c()),Q(t,1),t.m(n.parentNode,n))},i(l){i||(Q(t),i=!0)},o(l){$(t),i=!1},d(l){l&&L(n),a[e].d(l)}}}function Ac(r,e,t){let n;const i=["color","defaultClass","show"];let s=Qe(e,i),{$$slots:a={},$$scope:o}=e,{color:l="gray"}=e,{defaultClass:u="text-sm font-medium block"}=e,{show:c=!0}=e,d;const f={gray:"text-gray-900 dark:text-gray-300",green:"text-green-700 dark:text-green-500",red:"text-red-700 dark:text-red-500",disabled:"text-gray-400 dark:text-gray-500"};function h(v){es[v?"unshift":"push"](()=>{d=v,t(1,d)})}return r.$$set=v=>{t(10,e=be(be({},e),it(v))),t(3,s=Qe(e,i)),"color"in v&&t(4,l=v.color),"defaultClass"in v&&t(5,u=v.defaultClass),"show"in v&&t(0,c=v.show),"$$scope"in v&&t(6,o=v.$$scope)},r.$$.update=()=>{if(r.$$.dirty&18){const v=d==null?void 0:d.control;t(4,l=v!=null&&v.disabled?"disabled":l)}t(2,n=At(u,f[l],e.class))},e=it(e),[c,d,n,s,l,u,o,a,h]}class is extends Lt{constructor(e){super(),Mt(this,e,Ac,Tc,ut,{color:4,defaultClass:5,show:0})}}function Fc(r){let e,t,n,i,s,a,o,l;const u=r[8].default,c=ct(u,r,r[7],null);let d=[r[6],{type:"file"},{class:"hidden"}],f={};for(let h=0;h<d.length;h+=1)f=be(f,d[h]);return{c(){e=se("button"),t=se("label"),c&&c.c(),n=xe(),i=se("input"),this.h()},l(h){e=ae(h,"BUTTON",{class:!0,type:!0});var v=fe(e);t=ae(v,"LABEL",{class:!0,tabindex:!0});var g=fe(t);c&&c.l(g),n=Ie(g),i=ae(g,"INPUT",{type:!0,class:!0}),g.forEach(L),v.forEach(L),this.h()},h(){jt(i,f),pe(t,"class","flex flex-col items-center"),pe(t,"tabindex","0"),pe(e,"class",s=At(r[2],r[5].class)),pe(e,"type","button")},m(h,v){J(h,e,v),de(e,t),c&&c.m(t,null),de(t,n),de(t,i),i.autofocus&&i.focus(),r[21](i),a=!0,o||(l=[j(i,"change",r[20]),j(i,"change",r[18]),j(i,"click",r[19]),j(e,"keydown",r[4]),j(e,"focus",r[9]),j(e,"blur",r[10]),j(e,"mouseenter",r[11]),j(e,"mouseleave",r[12]),j(e,"mouseover",r[13]),j(e,"dragenter",r[14]),j(e,"dragleave",r[15]),j(e,"dragover",r[16]),j(e,"drop",r[17])],o=!0)},p(h,[v]){c&&c.p&&(!a||v&128)&&dt(c,u,h,h[7],a?ht(u,h[7],v,null):ft(h[7]),null),jt(i,f=Ur(d,[v&64&&h[6],{type:"file"},{class:"hidden"}])),(!a||v&36&&s!==(s=At(h[2],h[5].class)))&&pe(e,"class",s)},i(h){a||(Q(c,h),a=!0)},o(h){$(c,h),a=!1},d(h){h&&L(e),c&&c.d(h),r[21](null),o=!1,Gn(l)}}}function xc(r,e,t){const n=["value","files","defaultClass"];let i=Qe(e,n),{$$slots:s={},$$scope:a}=e,{value:o=""}=e,{files:l=void 0}=e,{defaultClass:u="flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"}=e,c;function d(P){[" ","Enter"].includes(P.key)&&(P.preventDefault(),c.click())}function f(P){ee.call(this,r,P)}function h(P){ee.call(this,r,P)}function v(P){ee.call(this,r,P)}function g(P){ee.call(this,r,P)}function m(P){ee.call(this,r,P)}function E(P){ee.call(this,r,P)}function w(P){ee.call(this,r,P)}function A(P){ee.call(this,r,P)}function S(P){ee.call(this,r,P)}function B(P){ee.call(this,r,P)}function M(P){ee.call(this,r,P)}function W(){o=this.value,l=this.files,t(0,o),t(1,l)}function Z(P){es[P?"unshift":"push"](()=>{c=P,t(3,c)})}return r.$$set=P=>{t(5,e=be(be({},e),it(P))),t(6,i=Qe(e,n)),"value"in P&&t(0,o=P.value),"files"in P&&t(1,l=P.files),"defaultClass"in P&&t(2,u=P.defaultClass),"$$scope"in P&&t(7,a=P.$$scope)},e=it(e),[o,l,u,c,d,e,i,a,s,f,h,v,g,m,E,w,A,S,B,M,W,Z]}class Ic extends Lt{constructor(e){super(),Mt(this,e,xc,Fc,ut,{value:0,files:1,defaultClass:2})}}const Cc=r=>({}),Ds=r=>({}),Oc=r=>({props:r[0]&72}),Ps=r=>({props:{...r[6],class:r[3]}}),Uc=r=>({}),ks=r=>({});function Ls(r){let e,t,n;const i=r[11].left,s=ct(i,r,r[26],ks);return{c(){e=se("div"),s&&s.c(),this.h()},l(a){e=ae(a,"DIV",{class:!0});var o=fe(e);s&&s.l(o),o.forEach(L),this.h()},h(){pe(e,"class",t=At(r[2],r[4].classLeft)+" left-0 pl-2.5 pointer-events-none")},m(a,o){J(a,e,o),s&&s.m(e,null),n=!0},p(a,o){s&&s.p&&(!n||o[0]&67108864)&&dt(s,i,a,a[26],n?ht(i,a[26],o,Uc):ft(a[26]),ks),(!n||o[0]&20&&t!==(t=At(a[2],a[4].classLeft)+" left-0 pl-2.5 pointer-events-none"))&&pe(e,"class",t)},i(a){n||(Q(s,a),n=!0)},o(a){$(s,a),n=!1},d(a){a&&L(e),s&&s.d(a)}}}function Nc(r){let e,t,n,i=[r[6],{type:r[1]},{class:r[3]}],s={};for(let a=0;a<i.length;a+=1)s=be(s,i[a]);return{c(){e=se("input"),this.h()},l(a){e=ae(a,"INPUT",{class:!0}),this.h()},h(){jt(e,s)},m(a,o){J(a,e,o),e.autofocus&&e.focus(),en(e,r[0]),t||(n=[j(e,"input",r[25]),j(e,"blur",r[12]),j(e,"change",r[13]),j(e,"click",r[14]),j(e,"contextmenu",r[15]),j(e,"focus",r[16]),j(e,"keydown",r[17]),j(e,"keypress",r[18]),j(e,"keyup",r[19]),j(e,"mouseover",r[20]),j(e,"mouseenter",r[21]),j(e,"mouseleave",r[22]),j(e,"paste",r[23]),j(e,"input",r[24])],t=!0)},p(a,o){jt(e,s=Ur(i,[o[0]&64&&a[6],o[0]&2&&{type:a[1]},o[0]&8&&{class:a[3]}])),o[0]&1&&e.value!==a[0]&&en(e,a[0])},d(a){a&&L(e),t=!1,Gn(n)}}}function Ms(r){let e,t,n;const i=r[11].right,s=ct(i,r,r[26],Ds);return{c(){e=se("div"),s&&s.c(),this.h()},l(a){e=ae(a,"DIV",{class:!0});var o=fe(e);s&&s.l(o),o.forEach(L),this.h()},h(){pe(e,"class",t=At(r[2],r[4].classRight)+" right-0 pr-2.5")},m(a,o){J(a,e,o),s&&s.m(e,null),n=!0},p(a,o){s&&s.p&&(!n||o[0]&67108864)&&dt(s,i,a,a[26],n?ht(i,a[26],o,Cc):ft(a[26]),Ds),(!n||o[0]&20&&t!==(t=At(a[2],a[4].classRight)+" right-0 pr-2.5"))&&pe(e,"class",t)},i(a){n||(Q(s,a),n=!0)},o(a){$(s,a),n=!1},d(a){a&&L(e),s&&s.d(a)}}}function Dc(r){let e,t,n,i,s=r[5].left&&Ls(r);const a=r[11].default,o=ct(a,r,r[26],Ps),l=o||Nc(r);let u=r[5].right&&Ms(r);return{c(){s&&s.c(),e=xe(),l&&l.c(),t=xe(),u&&u.c(),n=Ce()},l(c){s&&s.l(c),e=Ie(c),l&&l.l(c),t=Ie(c),u&&u.l(c),n=Ce()},m(c,d){s&&s.m(c,d),J(c,e,d),l&&l.m(c,d),J(c,t,d),u&&u.m(c,d),J(c,n,d),i=!0},p(c,d){c[5].left?s?(s.p(c,d),d[0]&32&&Q(s,1)):(s=Ls(c),s.c(),Q(s,1),s.m(e.parentNode,e)):s&&(Rt(),$(s,1,1,()=>{s=null}),Tt()),o?o.p&&(!i||d[0]&67108936)&&dt(o,a,c,c[26],i?ht(a,c[26],d,Oc):ft(c[26]),Ps):l&&l.p&&(!i||d[0]&75)&&l.p(c,i?d:[-1,-1]),c[5].right?u?(u.p(c,d),d[0]&32&&Q(u,1)):(u=Ms(c),u.c(),Q(u,1),u.m(n.parentNode,n)):u&&(Rt(),$(u,1,1,()=>{u=null}),Tt())},i(c){i||(Q(s),Q(l,c),Q(u),i=!0)},o(c){$(s),$(l,c),$(u),i=!1},d(c){c&&(L(e),L(t),L(n)),s&&s.d(c),l&&l.d(c),u&&u.d(c)}}}function Pc(r){let e,t;return e=new wc({props:{class:"relative w-full",show:r[5].left||r[5].right,$$slots:{default:[Dc]},$$scope:{ctx:r}}}),{c(){st(e.$$.fragment)},l(n){at(e.$$.fragment,n)},m(n,i){ot(e,n,i),t=!0},p(n,i){const s={};i[0]&32&&(s.show=n[5].left||n[5].right),i[0]&67108991&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){lt(e,n)}}}function kc(r){return r&&r==="xs"?"sm":r==="xl"?"lg":r}function Lc(r,e,t){let n;const i=["type","value","size","defaultClass","color","floatClass"];let s=Qe(e,i),{$$slots:a={},$$scope:o}=e;const l=Xl(a);let{type:u="text"}=e,{value:c=void 0}=e,{size:d=void 0}=e,{defaultClass:f="block w-full disabled:cursor-not-allowed disabled:opacity-50"}=e,{color:h="base"}=e,{floatClass:v="flex absolute inset-y-0 items-center text-gray-500 dark:text-gray-400"}=e;const g={base:"border-gray-300 dark:border-gray-600",tinted:"border-gray-300 dark:border-gray-500",green:"border-green-500 dark:border-green-400",red:"border-red-500 dark:border-red-400"},m={base:"focus:border-primary-500 focus:ring-primary-500 dark:focus:border-primary-500 dark:focus:ring-primary-500",green:"focus:ring-green-500 focus:border-green-500 dark:focus:border-green-500 dark:focus:ring-green-500",red:"focus:ring-red-500 focus:border-red-500 dark:focus:ring-red-500 dark:focus:border-red-500"},E={base:"bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400",tinted:"bg-gray-50 text-gray-900 dark:bg-gray-600 dark:text-white dark:placeholder-gray-400",green:"bg-green-50 text-green-900 placeholder-green-700 dark:text-green-400 dark:placeholder-green-500 dark:bg-gray-700",red:"bg-red-50 text-red-900 placeholder-red-700 dark:text-red-500 dark:placeholder-red-500 dark:bg-gray-700"};let w=Oi("background"),A=Oi("group");const S={sm:"sm:text-xs",md:"text-sm",lg:"sm:text-base"},B={sm:"pl-9",md:"pl-10",lg:"pl-11"},M={sm:"pr-9",md:"pr-10",lg:"pr-11"},W={sm:"p-2",md:"p-2.5",lg:"p-3"};let Z;function P(D){ee.call(this,r,D)}function oe(D){ee.call(this,r,D)}function ne(D){ee.call(this,r,D)}function N(D){ee.call(this,r,D)}function ie(D){ee.call(this,r,D)}function re(D){ee.call(this,r,D)}function q(D){ee.call(this,r,D)}function me(D){ee.call(this,r,D)}function Ae(D){ee.call(this,r,D)}function _e(D){ee.call(this,r,D)}function ye(D){ee.call(this,r,D)}function Pe(D){ee.call(this,r,D)}function Oe(D){ee.call(this,r,D)}function Fe(){c=this.value,t(0,c)}return r.$$set=D=>{t(4,e=be(be({},e),it(D))),t(6,s=Qe(e,i)),"type"in D&&t(1,u=D.type),"value"in D&&t(0,c=D.value),"size"in D&&t(7,d=D.size),"defaultClass"in D&&t(8,f=D.defaultClass),"color"in D&&t(9,h=D.color),"floatClass"in D&&t(2,v=D.floatClass),"$$scope"in D&&t(26,o=D.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&128&&t(10,n=d||kc(A==null?void 0:A.size)||"md");{const D=h==="base"&&w?"tinted":h;t(3,Z=At([f,l.left&&B[n]||l.right&&M[n]||W[n],m[h],E[D],g[D],S[n],A||"rounded-lg",A&&"first:rounded-l-lg last:rounded-r-lg",A&&"border-l-0 first:border-l last:border-r",e.class]))}},e=it(e),[c,u,v,Z,e,l,s,d,f,h,n,a,P,oe,ne,N,ie,re,q,me,Ae,_e,ye,Pe,Oe,Fe,o]}class ro extends Lt{constructor(e){super(),Mt(this,e,Lc,Pc,ut,{type:1,value:0,size:7,defaultClass:8,color:9,floatClass:2},null,[-1,-1])}}function Bs(r,e,t){const n=r.slice();return n[0]=e[t].value,n[17]=e[t].name,n}function qs(r){let e,t;return{c(){e=se("option"),t=Ft(r[2]),this.h()},l(n){e=ae(n,"OPTION",{});var i=fe(e);t=xt(i,r[2]),i.forEach(L),this.h()},h(){e.disabled=!0,e.selected=!0,e.__value="",en(e,e.__value)},m(n,i){J(n,e,i),de(e,t)},p(n,i){i&4&&Or(t,n[2])},d(n){n&&L(e)}}}function zs(r){let e;const t=r[10].default,n=ct(t,r,r[9],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s&512)&&dt(n,t,i,i[9],e?ht(t,i[9],s,null):ft(i[9]),null)},i(i){e||(Q(n,i),e=!0)},o(i){$(n,i),e=!1},d(i){n&&n.d(i)}}}function Hs(r){let e,t=r[17]+"",n,i;return{c(){e=se("option"),n=Ft(t),this.h()},l(s){e=ae(s,"OPTION",{});var a=fe(e);n=xt(a,t),a.forEach(L),this.h()},h(){e.__value=i=r[0],en(e,e.__value)},m(s,a){J(s,e,a),de(e,n)},p(s,a){a&2&&t!==(t=s[17]+"")&&Or(n,t),a&2&&i!==(i=s[0])&&(e.__value=i,en(e,e.__value))},d(s){s&&L(e)}}}function Mc(r){let e,t,n,i,s=r[2]&&qs(r),a=wt(r[1]),o=[];for(let d=0;d<a.length;d+=1)o[d]=Hs(Bs(r,a,d));let l=null;a.length||(l=zs(r));let u=[r[4],{class:r[3]}],c={};for(let d=0;d<u.length;d+=1)c=be(c,u[d]);return{c(){e=se("select"),s&&s.c(),t=Ce();for(let d=0;d<o.length;d+=1)o[d].c();l&&l.c(),this.h()},l(d){e=ae(d,"SELECT",{class:!0});var f=fe(e);s&&s.l(f),t=Ce();for(let h=0;h<o.length;h+=1)o[h].l(f);l&&l.l(f),f.forEach(L),this.h()},h(){jt(e,c),r[0]===void 0&&$l(()=>r[14].call(e))},m(d,f){J(d,e,f),s&&s.m(e,null),de(e,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(e,null);l&&l.m(e,null),"value"in c&&(c.multiple?Fs:pn)(e,c.value),e.autofocus&&e.focus(),pn(e,r[0],!0),n||(i=[j(e,"change",r[14]),j(e,"change",r[11]),j(e,"contextmenu",r[12]),j(e,"input",r[13])],n=!0)},p(d,[f]){if(d[2]?s?s.p(d,f):(s=qs(d),s.c(),s.m(e,t)):s&&(s.d(1),s=null),f&514){a=wt(d[1]);let h;for(h=0;h<a.length;h+=1){const v=Bs(d,a,h);o[h]?o[h].p(v,f):(o[h]=Hs(v),o[h].c(),o[h].m(e,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=a.length,!a.length&&l?l.p(d,f):a.length?l&&(Rt(),$(l,1,1,()=>{l=null}),Tt()):(l=zs(d),l.c(),Q(l,1),l.m(e,null))}jt(e,c=Ur(u,[f&16&&d[4],{class:d[3]}])),f&24&&"value"in c&&(c.multiple?Fs:pn)(e,c.value),f&3&&pn(e,d[0])},i:er,o:er,d(d){d&&L(e),s&&s.d(),tn(o,d),l&&l.d(),n=!1,Gn(i)}}}const Bc="block w-full";function qc(r,e,t){const n=["items","value","placeholder","underline","size","defaultClass","underlineClass"];let i=Qe(e,n),{$$slots:s={},$$scope:a}=e,{items:o=[]}=e,{value:l=void 0}=e,{placeholder:u="Choose option ..."}=e,{underline:c=!1}=e,{size:d="md"}=e,{defaultClass:f="text-gray-900 bg-gray-50 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"}=e,{underlineClass:h="text-gray-500 bg-transparent border-0 border-b-2 border-gray-200 appearance-none dark:text-gray-400 dark:border-gray-700 focus:outline-none focus:ring-0 focus:border-gray-200 peer"}=e;const v={sm:"text-sm p-2",md:"text-sm p-2.5",lg:"text-base py-3 px-4"};let g;function m(S){ee.call(this,r,S)}function E(S){ee.call(this,r,S)}function w(S){ee.call(this,r,S)}function A(){l=Wl(this),t(0,l),t(1,o)}return r.$$set=S=>{t(16,e=be(be({},e),it(S))),t(4,i=Qe(e,n)),"items"in S&&t(1,o=S.items),"value"in S&&t(0,l=S.value),"placeholder"in S&&t(2,u=S.placeholder),"underline"in S&&t(5,c=S.underline),"size"in S&&t(6,d=S.size),"defaultClass"in S&&t(7,f=S.defaultClass),"underlineClass"in S&&t(8,h=S.underlineClass),"$$scope"in S&&t(9,a=S.$$scope)},r.$$.update=()=>{t(3,g=At(Bc,c?h:f,v[d],c&&"!px-0",e.class))},e=it(e),[l,o,u,g,i,c,d,f,h,a,s,m,E,w,A]}class zc extends Lt{constructor(e){super(),Mt(this,e,qc,Mc,ut,{items:1,value:0,placeholder:2,underline:5,size:6,defaultClass:7,underlineClass:8})}}var Pi=function(r,e){return Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},Pi(r,e)};function ss(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Pi(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Hc(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})}function no(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function rn(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function In(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function Cn(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}function fr(r){return this instanceof fr?(this.v=r,this):new fr(r)}function Gc(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){n[f]&&(i[f]=function(h){return new Promise(function(v,g){s.push([f,h,v,g])>1||o(f,h)})})}function o(f,h){try{l(n[f](h))}catch(v){d(s[0][3],v)}}function l(f){f.value instanceof fr?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}function u(f){o("next",f)}function c(f){o("throw",f)}function d(f,h){f(h),s.shift(),s.length&&o(s[0][0],s[0][1])}}function Vc(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof rn=="function"?rn(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(o,l){a=r[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}function Te(r){return typeof r=="function"}function Qc(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var gi=Qc(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Gs(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var as=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,i,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=rn(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var c=this.initialTeardown;if(Te(c))try{c()}catch(g){s=g instanceof gi?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=rn(d),h=f.next();!h.done;h=f.next()){var v=h.value;try{Vs(v)}catch(g){s=s??[],g instanceof gi?s=Cn(Cn([],In(s)),In(g.errors)):s.push(g)}}}catch(g){n={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}if(s)throw new gi(s)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Vs(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Gs(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&Gs(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}();as.EMPTY;function io(r){return r instanceof as||r&&"closed"in r&&Te(r.remove)&&Te(r.add)&&Te(r.unsubscribe)}function Vs(r){Te(r)?r():r.unsubscribe()}var so={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ki={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i=ki.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,Cn([r,e],In(t))):setTimeout.apply(void 0,Cn([r,e],In(t)))},clearTimeout:function(r){var e=ki.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(r)},delegate:void 0};function ao(r){ki.setTimeout(function(){throw r})}function Qs(){}function Yc(r){r()}var os=function(r){ss(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,io(t)&&t.add(n)):n.destination=Jc,n}return e.create=function(t,n,i){return new Li(t,n,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(as),Xc=Function.prototype.bind;function yi(r,e){return Xc.call(r,e)}var $c=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){yn(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){yn(n)}else yn(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){yn(t)}},r}(),Li=function(r){ss(e,r);function e(t,n,i){var s=r.call(this)||this,a;if(Te(t)||!t)a={next:t??void 0,error:n??void 0,complete:i??void 0};else{var o;s&&so.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=function(){return s.unsubscribe()},a={next:t.next&&yi(t.next,o),error:t.error&&yi(t.error,o),complete:t.complete&&yi(t.complete,o)}):a=t}return s.destination=new $c(a),s}return e}(os);function yn(r){ao(r)}function jc(r){throw r}var Jc={closed:!0,next:Qs,error:jc,complete:Qs},ls=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Zc(r){return r}function Wc(r){return r.length===0?Zc:r.length===1?r[0]:function(t){return r.reduce(function(n,i){return i(n)},t)}}var Bt=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this,s=ed(e)?e:new Li(e,t,n);return Yc(function(){var a=i,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=Ys(t),new t(function(i,s){var a=new Li({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:i});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[ls]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Wc(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=Ys(e),new e(function(n,i){var s;t.subscribe(function(a){return s=a},function(a){return i(a)},function(){return n(s)})})},r.create=function(e){return new r(e)},r}();function Ys(r){var e;return(e=r??so.Promise)!==null&&e!==void 0?e:Promise}function Kc(r){return r&&Te(r.next)&&Te(r.error)&&Te(r.complete)}function ed(r){return r&&r instanceof os||Kc(r)&&io(r)}function td(r){return Te(r==null?void 0:r.lift)}function oo(r){return function(e){if(td(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function rd(r,e,t,n,i){return new nd(r,e,t,n,i)}var nd=function(r){ss(e,r);function e(t,n,i,s,a,o){var l=r.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=n?function(u){try{n(u)}catch(c){t.error(c)}}:r.prototype._next,l._error=s?function(u){try{s(u)}catch(c){t.error(c)}finally{this.unsubscribe()}}:r.prototype._error,l._complete=i?function(){try{i()}catch(u){t.error(u)}finally{this.unsubscribe()}}:r.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(os),lo=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function uo(r){return Te(r==null?void 0:r.then)}function co(r){return Te(r[ls])}function fo(r){return Symbol.asyncIterator&&Te(r==null?void 0:r[Symbol.asyncIterator])}function ho(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function id(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var po=id();function mo(r){return Te(r==null?void 0:r[po])}function vo(r){return Gc(this,arguments,function(){var t,n,i,s;return no(this,function(a){switch(a.label){case 0:t=r.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,fr(t.read())];case 3:return n=a.sent(),i=n.value,s=n.done,s?[4,fr(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,fr(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function go(r){return Te(r==null?void 0:r.getReader)}function us(r){if(r instanceof Bt)return r;if(r!=null){if(co(r))return sd(r);if(lo(r))return ad(r);if(uo(r))return od(r);if(fo(r))return yo(r);if(mo(r))return ld(r);if(go(r))return ud(r)}throw ho(r)}function sd(r){return new Bt(function(e){var t=r[ls]();if(Te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function ad(r){return new Bt(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function od(r){return new Bt(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ao)})}function ld(r){return new Bt(function(e){var t,n;try{for(var i=rn(r),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.complete()})}function yo(r){return new Bt(function(e){cd(r,e).catch(function(t){return e.error(t)})})}function ud(r){return yo(vo(r))}function cd(r,e){var t,n,i,s;return Hc(this,void 0,void 0,function(){var a,o;return no(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Vc(r),l.label=1;case 1:return[4,t.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(a=n.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),i={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Wt(r,e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function Eo(r,e){return e===void 0&&(e=0),oo(function(t,n){t.subscribe(rd(n,function(i){return Wt(n,r,function(){return n.next(i)},e)},function(){return Wt(n,r,function(){return n.complete()},e)},function(i){return Wt(n,r,function(){return n.error(i)},e)}))})}function bo(r,e){return e===void 0&&(e=0),oo(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function dd(r,e){return us(r).pipe(bo(e),Eo(e))}function fd(r,e){return us(r).pipe(bo(e),Eo(e))}function hd(r,e){return new Bt(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function pd(r,e){return new Bt(function(t){var n;return Wt(t,e,function(){n=r[po](),Wt(t,e,function(){var i,s,a;try{i=n.next(),s=i.value,a=i.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return Te(n==null?void 0:n.return)&&n.return()}})}function _o(r,e){if(!r)throw new Error("Iterable cannot be null");return new Bt(function(t){Wt(t,e,function(){var n=r[Symbol.asyncIterator]();Wt(t,e,function(){n.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function md(r,e){return _o(vo(r),e)}function vd(r,e){if(r!=null){if(co(r))return dd(r,e);if(lo(r))return hd(r,e);if(uo(r))return fd(r,e);if(fo(r))return _o(r,e);if(mo(r))return pd(r,e);if(go(r))return md(r,e)}throw ho(r)}function gd(r,e){return e?vd(r,e):us(r)}function yd(r){for(var e=r.length,t=0,n=0;n<e;){var i=r.charCodeAt(n++);if(i&4294967168)if(!(i&4294965248))t+=2;else{if(i>=55296&&i<=56319&&n<e){var s=r.charCodeAt(n);(s&64512)===56320&&(++n,i=((i&1023)<<10)+(s&1023)+65536)}i&4294901760?t+=4:t+=3}else{t++;continue}}return t}function Ed(r,e,t){for(var n=r.length,i=t,s=0;s<n;){var a=r.charCodeAt(s++);if(a&4294967168)if(!(a&4294965248))e[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&s<n){var o=r.charCodeAt(s);(o&64512)===56320&&(++s,a=((a&1023)<<10)+(o&1023)+65536)}a&4294901760?(e[i++]=a>>18&7|240,e[i++]=a>>12&63|128,e[i++]=a>>6&63|128):(e[i++]=a>>12&15|224,e[i++]=a>>6&63|128)}else{e[i++]=a;continue}e[i++]=a&63|128}}var bd=new TextEncoder,_d=50;function wd(r,e,t){bd.encodeInto(r,e.subarray(t))}function Sd(r,e,t){r.length>_d?wd(r,e,t):Ed(r,e,t)}var Rd=4096;function wo(r,e,t){for(var n=e,i=n+t,s=[],a="";n<i;){var o=r[n++];if(!(o&128))s.push(o);else if((o&224)===192){var l=r[n++]&63;s.push((o&31)<<6|l)}else if((o&240)===224){var l=r[n++]&63,u=r[n++]&63;s.push((o&31)<<12|l<<6|u)}else if((o&248)===240){var l=r[n++]&63,u=r[n++]&63,c=r[n++]&63,d=(o&7)<<18|l<<12|u<<6|c;d>65535&&(d-=65536,s.push(d>>>10&1023|55296),d=56320|d&1023),s.push(d)}else s.push(o);s.length>=Rd&&(a+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(a+=String.fromCharCode.apply(String,s)),a}var Td=new TextDecoder,Ad=200;function Fd(r,e,t){var n=r.subarray(e,e+t);return Td.decode(n)}function xd(r,e,t){return t>Ad?Fd(r,e,t):wo(r,e,t)}var En=function(){function r(e,t){this.type=e,this.data=t}return r}(),Id=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mt=function(r){Id(e,r);function e(t){var n=r.call(this,t)||this,i=Object.create(e.prototype);return Object.setPrototypeOf(n,i),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:e.name}),n}return e}(Error),Hr=4294967295;function Cd(r,e,t){var n=t/4294967296,i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function So(r,e,t){var n=Math.floor(t/4294967296),i=t;r.setUint32(e,n),r.setUint32(e+4,i)}function Ro(r,e){var t=r.getInt32(e),n=r.getUint32(e+4);return t*4294967296+n}function Od(r,e){var t=r.getUint32(e),n=r.getUint32(e+4);return t*4294967296+n}var Ud=-1,Nd=4294967296-1,Dd=17179869184-1;function Pd(r){var e=r.sec,t=r.nsec;if(e>=0&&t>=0&&e<=Dd)if(t===0&&e<=Nd){var n=new Uint8Array(4),i=new DataView(n.buffer);return i.setUint32(0,e),n}else{var s=e/4294967296,a=e&4294967295,n=new Uint8Array(8),i=new DataView(n.buffer);return i.setUint32(0,t<<2|s&3),i.setUint32(4,a),n}else{var n=new Uint8Array(12),i=new DataView(n.buffer);return i.setUint32(0,t),So(i,4,e),n}}function kd(r){var e=r.getTime(),t=Math.floor(e/1e3),n=(e-t*1e3)*1e6,i=Math.floor(n/1e9);return{sec:t+i,nsec:n-i*1e9}}function Ld(r){if(r instanceof Date){var e=kd(r);return Pd(e)}else return null}function Md(r){var e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(r.byteLength){case 4:{var t=e.getUint32(0),n=0;return{sec:t,nsec:n}}case 8:{var i=e.getUint32(0),s=e.getUint32(4),t=(i&3)*4294967296+s,n=i>>>2;return{sec:t,nsec:n}}case 12:{var t=Ro(e,4),n=e.getUint32(0);return{sec:t,nsec:n}}default:throw new mt("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(r.length))}}function Bd(r){var e=Md(r);return new Date(e.sec*1e3+e.nsec/1e6)}var qd={type:Ud,encode:Ld,decode:Bd},To=function(){function r(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(qd)}return r.prototype.register=function(e){var t=e.type,n=e.encode,i=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=i;else{var s=1+t;this.builtInEncoders[s]=n,this.builtInDecoders[s]=i}},r.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++){var i=this.builtInEncoders[n];if(i!=null){var s=i(e,t);if(s!=null){var a=-1-n;return new En(a,s)}}}for(var n=0;n<this.encoders.length;n++){var i=this.encoders[n];if(i!=null){var s=i(e,t);if(s!=null){var a=n;return new En(a,s)}}}return e instanceof En?e:null},r.prototype.decode=function(e,t,n){var i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,n):new En(t,e)},r.defaultCodec=new r,r}();function On(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Uint8Array.from(r)}function zd(r){if(r instanceof ArrayBuffer)return new DataView(r);var e=On(r);return new DataView(e.buffer,e.byteOffset,e.byteLength)}var Hd=100,Gd=2048,Vd=function(){function r(e){var t,n,i,s,a,o,l,u;this.extensionCodec=(t=e==null?void 0:e.extensionCodec)!==null&&t!==void 0?t:To.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(n=e==null?void 0:e.useBigInt64)!==null&&n!==void 0?n:!1,this.maxDepth=(i=e==null?void 0:e.maxDepth)!==null&&i!==void 0?i:Hd,this.initialBufferSize=(s=e==null?void 0:e.initialBufferSize)!==null&&s!==void 0?s:Gd,this.sortKeys=(a=e==null?void 0:e.sortKeys)!==null&&a!==void 0?a:!1,this.forceFloat32=(o=e==null?void 0:e.forceFloat32)!==null&&o!==void 0?o:!1,this.ignoreUndefined=(l=e==null?void 0:e.ignoreUndefined)!==null&&l!==void 0?l:!1,this.forceIntegerToFloat=(u=e==null?void 0:e.forceIntegerToFloat)!==null&&u!==void 0?u:!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return r.prototype.reinitializeState=function(){this.pos=0},r.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},r.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},r.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,t)},r.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(t*2)},r.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),i=new DataView(t);n.set(this.bytes),this.view=i,this.bytes=n},r.prototype.encodeNil=function(){this.writeU8(192)},r.prototype.encodeBoolean=function(e){e===!1?this.writeU8(194):this.writeU8(195)},r.prototype.encodeNumber=function(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)},r.prototype.encodeNumberAsFloat=function(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},r.prototype.encodeBigInt64=function(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))},r.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error("Too long string: ".concat(e," bytes in UTF-8"))},r.prototype.encodeString=function(e){var t=5,n=yd(e);this.ensureBufferSizeToWrite(t+n),this.writeStringHeader(n),Sd(e,this.bytes,this.pos),this.pos+=n},r.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(n!=null)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,t);else throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)))},r.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw new Error("Too large binary: ".concat(t));var n=On(e);this.writeU8a(n)},r.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw new Error("Too large array: ".concat(n));for(var i=0,s=e;i<s.length;i++){var a=s[i];this.doEncode(a,t+1)}},r.prototype.countWithoutUndefined=function(e,t){for(var n=0,i=0,s=t;i<s.length;i++){var a=s[i];e[a]!==void 0&&n++}return n},r.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw new Error("Too large map object: ".concat(i));for(var s=0,a=n;s<a.length;s++){var o=a[s],l=e[o];this.ignoreUndefined&&l===void 0||(this.encodeString(o),this.doEncode(l,t+1))}},r.prototype.encodeExtension=function(e){var t=e.data.length;if(t===1)this.writeU8(212);else if(t===2)this.writeU8(213);else if(t===4)this.writeU8(214);else if(t===8)this.writeU8(215);else if(t===16)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw new Error("Too large extension object: ".concat(t));this.writeI8(e.type),this.writeU8a(e.data)},r.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},r.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},r.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},r.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},r.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},r.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},r.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},r.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},r.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},r.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),Cd(this.view,this.pos,e),this.pos+=8},r.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),So(this.view,this.pos,e),this.pos+=8},r.prototype.writeBigUint64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8},r.prototype.writeBigInt64=function(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8},r}();function Ao(r,e){var t=new Vd(e);return t.encodeSharedRef(r)}function Ei(r){return"".concat(r<0?"-":"","0x").concat(Math.abs(r).toString(16).padStart(2,"0"))}var Qd=16,Yd=16,Xd=function(){function r(e,t){e===void 0&&(e=Qd),t===void 0&&(t=Yd),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return r.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},r.prototype.find=function(e,t,n){var i=this.caches[n-1];e:for(var s=0,a=i;s<a.length;s++){for(var o=a[s],l=o.bytes,u=0;u<n;u++)if(l[u]!==e[t+u])continue e;return o.str}return null},r.prototype.store=function(e,t){var n=this.caches[e.length-1],i={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)},r.prototype.decode=function(e,t,n){var i=this.find(e,t,n);if(i!=null)return this.hit++,i;this.miss++;var s=wo(e,t,n),a=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(a,s),s},r}(),$d=globalThis&&globalThis.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},bi=globalThis&&globalThis.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Xs=globalThis&&globalThis.__asyncValues||function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(o,l){a=r[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},hr=globalThis&&globalThis.__await||function(r){return this instanceof hr?(this.v=r,this):new hr(r)},jd=globalThis&&globalThis.__asyncGenerator||function(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){n[f]&&(i[f]=function(h){return new Promise(function(v,g){s.push([f,h,v,g])>1||o(f,h)})})}function o(f,h){try{l(n[f](h))}catch(v){d(s[0][3],v)}}function l(f){f.value instanceof hr?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}function u(f){o("next",f)}function c(f){o("throw",f)}function d(f,h){f(h),s.shift(),s.length&&o(s[0][0],s[0][1])}},$s="array",bn="map_key",Jd="map_value",Zd=function(r){return typeof r=="string"||typeof r=="number"},Gr=-1,cs=new DataView(new ArrayBuffer(0)),Wd=new Uint8Array(cs.buffer);try{cs.getInt8(0)}catch(r){if(!(r instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}var Mi=RangeError,js=new Mi("Insufficient data"),Kd=new Xd,ef=function(){function r(e){var t,n,i,s,a,o,l;this.totalPos=0,this.pos=0,this.view=cs,this.bytes=Wd,this.headByte=Gr,this.stack=[],this.extensionCodec=(t=e==null?void 0:e.extensionCodec)!==null&&t!==void 0?t:To.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(n=e==null?void 0:e.useBigInt64)!==null&&n!==void 0?n:!1,this.maxStrLength=(i=e==null?void 0:e.maxStrLength)!==null&&i!==void 0?i:Hr,this.maxBinLength=(s=e==null?void 0:e.maxBinLength)!==null&&s!==void 0?s:Hr,this.maxArrayLength=(a=e==null?void 0:e.maxArrayLength)!==null&&a!==void 0?a:Hr,this.maxMapLength=(o=e==null?void 0:e.maxMapLength)!==null&&o!==void 0?o:Hr,this.maxExtLength=(l=e==null?void 0:e.maxExtLength)!==null&&l!==void 0?l:Hr,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:Kd}return r.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=Gr,this.stack.length=0},r.prototype.setBuffer=function(e){this.bytes=On(e),this.view=zd(this.bytes),this.pos=0},r.prototype.appendBuffer=function(e){if(this.headByte===Gr&&!this.hasRemaining(1))this.setBuffer(e);else{var t=this.bytes.subarray(this.pos),n=On(e),i=new Uint8Array(t.length+n.length);i.set(t),i.set(n,t.length),this.setBuffer(i)}},r.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},r.prototype.createExtraByteError=function(e){var t=this,n=t.view,i=t.pos;return new RangeError("Extra ".concat(n.byteLength-i," of ").concat(n.byteLength," byte(s) found at buffer[").concat(e,"]"))},r.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},r.prototype.decodeMulti=function(e){return bi(this,function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}})},r.prototype.decodeAsync=function(e){var t,n,i,s,a,o,l;return $d(this,void 0,void 0,function(){var u,c,d,f,h,v,g,m;return bi(this,function(E){switch(E.label){case 0:u=!1,E.label=1;case 1:E.trys.push([1,6,7,12]),t=!0,n=Xs(e),E.label=2;case 2:return[4,n.next()];case 3:if(i=E.sent(),s=i.done,!!s)return[3,5];l=i.value,t=!1;try{if(d=l,u)throw this.createExtraByteError(this.totalPos);this.appendBuffer(d);try{c=this.doDecodeSync(),u=!0}catch(w){if(!(w instanceof Mi))throw w}this.totalPos+=this.pos}finally{t=!0}E.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return f=E.sent(),a={error:f},[3,12];case 7:return E.trys.push([7,,10,11]),!t&&!s&&(o=n.return)?[4,o.call(n)]:[3,9];case 8:E.sent(),E.label=9;case 9:return[3,11];case 10:if(a)throw a.error;return[7];case 11:return[7];case 12:if(u){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,c]}throw h=this,v=h.headByte,g=h.pos,m=h.totalPos,new RangeError("Insufficient data in parsing ".concat(Ei(v)," at ").concat(m," (").concat(g," in the current buffer)"))}})})},r.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},r.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},r.prototype.decodeMultiAsync=function(e,t){return jd(this,arguments,function(){var i,s,a,o,l,u,c,d,f,h,v,g;return bi(this,function(m){switch(m.label){case 0:i=t,s=-1,m.label=1;case 1:m.trys.push([1,15,16,21]),a=!0,o=Xs(e),m.label=2;case 2:return[4,hr(o.next())];case 3:if(l=m.sent(),f=l.done,!!f)return[3,14];g=l.value,a=!1,m.label=4;case 4:if(m.trys.push([4,,12,13]),u=g,t&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(u),i&&(s=this.readArraySize(),i=!1,this.complete()),m.label=5;case 5:m.trys.push([5,10,,11]),m.label=6;case 6:return[4,hr(this.doDecodeSync())];case 7:return[4,m.sent()];case 8:return m.sent(),--s===0?[3,9]:[3,6];case 9:return[3,11];case 10:if(c=m.sent(),!(c instanceof Mi))throw c;return[3,11];case 11:return this.totalPos+=this.pos,[3,13];case 12:return a=!0,[7];case 13:return[3,2];case 14:return[3,21];case 15:return d=m.sent(),h={error:d},[3,21];case 16:return m.trys.push([16,,19,20]),!a&&!f&&(v=o.return)?[4,hr(v.call(o))]:[3,18];case 17:m.sent(),m.label=18;case 18:return[3,20];case 19:if(h)throw h.error;return[7];case 20:return[7];case 21:return[2]}})})},r.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){var n=e-128;if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e<160){var n=e-144;if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else{var i=e-160;t=this.decodeUtf8String(i,0)}else if(e===192)t=null;else if(e===194)t=!1;else if(e===195)t=!0;else if(e===202)t=this.readF32();else if(e===203)t=this.readF64();else if(e===204)t=this.readU8();else if(e===205)t=this.readU16();else if(e===206)t=this.readU32();else if(e===207)this.useBigInt64?t=this.readU64AsBigInt():t=this.readU64();else if(e===208)t=this.readI8();else if(e===209)t=this.readI16();else if(e===210)t=this.readI32();else if(e===211)this.useBigInt64?t=this.readI64AsBigInt():t=this.readI64();else if(e===217){var i=this.lookU8();t=this.decodeUtf8String(i,1)}else if(e===218){var i=this.lookU16();t=this.decodeUtf8String(i,2)}else if(e===219){var i=this.lookU32();t=this.decodeUtf8String(i,4)}else if(e===220){var n=this.readU16();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===221){var n=this.readU32();if(n!==0){this.pushArrayState(n),this.complete();continue e}else t=[]}else if(e===222){var n=this.readU16();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===223){var n=this.readU32();if(n!==0){this.pushMapState(n),this.complete();continue e}else t={}}else if(e===196){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(e===197){var n=this.lookU16();t=this.decodeBinary(n,2)}else if(e===198){var n=this.lookU32();t=this.decodeBinary(n,4)}else if(e===212)t=this.decodeExtension(1,0);else if(e===213)t=this.decodeExtension(2,0);else if(e===214)t=this.decodeExtension(4,0);else if(e===215)t=this.decodeExtension(8,0);else if(e===216)t=this.decodeExtension(16,0);else if(e===199){var n=this.lookU8();t=this.decodeExtension(n,1)}else if(e===200){var n=this.lookU16();t=this.decodeExtension(n,2)}else if(e===201){var n=this.lookU32();t=this.decodeExtension(n,4)}else throw new mt("Unrecognized type byte: ".concat(Ei(e)));this.complete();for(var s=this.stack;s.length>0;){var a=s[s.length-1];if(a.type===$s)if(a.array[a.position]=t,a.position++,a.position===a.size)s.pop(),t=a.array;else continue e;else if(a.type===bn){if(!Zd(t))throw new mt("The type of key must be string or number but "+typeof t);if(t==="__proto__")throw new mt("The key __proto__ is not allowed");a.key=t,a.type=Jd;continue e}else if(a.map[a.key]=t,a.readCount++,a.readCount===a.size)s.pop(),t=a.map;else{a.key=null,a.type=bn;continue e}}return t}},r.prototype.readHeadByte=function(){return this.headByte===Gr&&(this.headByte=this.readU8()),this.headByte},r.prototype.complete=function(){this.headByte=Gr},r.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new mt("Unrecognized array type byte: ".concat(Ei(e)))}}},r.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new mt("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:bn,size:e,key:null,readCount:0,map:{}})},r.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new mt("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:$s,size:e,array:new Array(e),position:0})},r.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new mt("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw js;var i=this.pos+t,s;return this.stateIsMapKey()&&(!((n=this.keyDecoder)===null||n===void 0)&&n.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,i,e):s=xd(this.bytes,i,e),this.pos+=t+e,s},r.prototype.stateIsMapKey=function(){if(this.stack.length>0){var e=this.stack[this.stack.length-1];return e.type===bn}return!1},r.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new mt("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw js;var n=this.pos+t,i=this.bytes.subarray(n,n+e);return this.pos+=t+e,i},r.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new mt("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,n,this.context)},r.prototype.lookU8=function(){return this.view.getUint8(this.pos)},r.prototype.lookU16=function(){return this.view.getUint16(this.pos)},r.prototype.lookU32=function(){return this.view.getUint32(this.pos)},r.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},r.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},r.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},r.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},r.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},r.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},r.prototype.readU64=function(){var e=Od(this.view,this.pos);return this.pos+=8,e},r.prototype.readI64=function(){var e=Ro(this.view,this.pos);return this.pos+=8,e},r.prototype.readU64AsBigInt=function(){var e=this.view.getBigUint64(this.pos);return this.pos+=8,e},r.prototype.readI64AsBigInt=function(){var e=this.view.getBigInt64(this.pos);return this.pos+=8,e},r.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},r.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},r}();function tf(r,e){var t=new ef(e);return t.decode(r)}function rf(r){const e=new Uint8Array(3);return e[0]=r>>8>>8%256,e[1]=r>>8%256,e[2]=r%256,e}function Js(r){const e=new Uint8Array(2);return e[0]=r>>8%256,e[1]=r%256,e}function Zs(r){return r[0]<<8|r[1]}var Bi={exports:{}},_i,Ws;function nf(){if(Ws)return _i;Ws=1;var r=1e3,e=r*60,t=e*60,n=t*24,i=n*7,s=n*365.25;_i=function(c,d){d=d||{};var f=typeof c;if(f==="string"&&c.length>0)return a(c);if(f==="number"&&isFinite(c))return d.long?l(c):o(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function a(c){if(c=String(c),!(c.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(d){var f=parseFloat(d[1]),h=(d[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return f*s;case"weeks":case"week":case"w":return f*i;case"days":case"day":case"d":return f*n;case"hours":case"hour":case"hrs":case"hr":case"h":return f*t;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function o(c){var d=Math.abs(c);return d>=n?Math.round(c/n)+"d":d>=t?Math.round(c/t)+"h":d>=e?Math.round(c/e)+"m":d>=r?Math.round(c/r)+"s":c+"ms"}function l(c){var d=Math.abs(c);return d>=n?u(c,d,n,"day"):d>=t?u(c,d,t,"hour"):d>=e?u(c,d,e,"minute"):d>=r?u(c,d,r,"second"):c+" ms"}function u(c,d,f,h){var v=d>=f*1.5;return Math.round(c/f)+" "+h+(v?"s":"")}return _i}function sf(r){t.debug=t,t.default=t,t.coerce=l,t.disable=s,t.enable=i,t.enabled=a,t.humanize=nf(),t.destroy=u,Object.keys(r).forEach(c=>{t[c]=r[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let d=0;for(let f=0;f<c.length;f++)d=(d<<5)-d+c.charCodeAt(f),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(c){let d,f=null,h,v;function g(...m){if(!g.enabled)return;const E=g,w=Number(new Date),A=w-(d||w);E.diff=A,E.prev=d,E.curr=w,d=w,m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let S=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(M,W)=>{if(M==="%%")return"%";S++;const Z=t.formatters[W];if(typeof Z=="function"){const P=m[S];M=Z.call(E,P),m.splice(S,1),S--}return M}),t.formatArgs.call(E,m),(E.log||t.log).apply(E,m)}return g.namespace=c,g.useColors=t.useColors(),g.color=t.selectColor(c),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(h!==t.namespaces&&(h=t.namespaces,v=t.enabled(c)),v),set:m=>{f=m}}),typeof t.init=="function"&&t.init(g),g}function n(c,d){const f=t(this.namespace+(typeof d>"u"?":":d)+c);return f.log=this.log,f}function i(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let d;const f=(typeof c=="string"?c:"").split(/[\s,]+/),h=f.length;for(d=0;d<h;d++)f[d]&&(c=f[d].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.slice(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function s(){const c=[...t.names.map(o),...t.skips.map(o).map(d=>"-"+d)].join(",");return t.enable(""),c}function a(c){if(c[c.length-1]==="*")return!0;let d,f;for(d=0,f=t.skips.length;d<f;d++)if(t.skips[d].test(c))return!1;for(d=0,f=t.names.length;d<f;d++)if(t.names[d].test(c))return!0;return!1}function o(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var af=sf;(function(r,e){e.formatArgs=n,e.save=i,e.load=s,e.useColors=t,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let c=0,d=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(c++,f==="%c"&&(d=c))}),l.splice(d,0,u)}e.log=console.debug||console.log||(()=>{});function i(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof I.process<"u"&&"env"in I.process&&(l={}.DEBUG),l}function a(){try{return localStorage}catch{}}r.exports=af(e);const{formatters:o}=r.exports;o.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Bi,Bi.exports);var of=Bi.exports;const lf=ts(of),Nt=lf("wick");class uf{constructor(e,t,n){F(this,"operation");F(this,"packet");F(this,"context");this.operation=e,this.packet=t,this.context=n}intoPayload(){var t;this.packet.setContext(this.context);const e=this.packet.intoPayload();return(t=e.metadata)==null||t.set(this.operation.asEncoded(),4),Nt("context packet %o",e),e}}class Kt{constructor(e,t,n=0){F(this,"data");F(this,"port");F(this,"context");F(this,"flags",0);this.port=e,this.data=t,this.flags=n}static Done(e){return new Kt(e,void 0,Kr.DONE_FLAG)}static OpenBracket(e){return new Kt(e,void 0,Kr.OPEN_BRACKET)}static CloseBracket(e){return new Kt(e,void 0,Kr.CLOSE_BRACKET)}setFlags(e){this.flags=e}setContext(e){this.context=e}intoPayload(){let e=new Uint8Array;this.context&&(Nt("packet context %o",this.context),e=Ao(this.context));const n=new Vn(this.flags,this.port,e).encode(),i=new Uint8Array(4+8+n.length);let s=0;return i[s++]=202,i.set(rf(8+n.length),s),s+=3,i.set([0,0,0,0,0,0,0,0],s),s+=8,i.set(n,s),Nt("packet metadata %o",i),{data:this.data?I.Buffer.from(this.data):null,metadata:I.Buffer.from(i)}}}var Kr;(function(r){r[r.DONE_FLAG=128]="DONE_FLAG",r[r.OPEN_BRACKET=64]="OPEN_BRACKET",r[r.CLOSE_BRACKET=32]="CLOSE_BRACKET"})(Kr||(Kr={}));class Vn{constructor(e,t,n){F(this,"flags");F(this,"port");F(this,"context");this.flags=e,this.port=t,this.context=n}encode(){const e=new TextEncoder().encode(this.port),t=this.context||new Uint8Array,n=1+2+e.length+2+t.length,i=new Uint8Array(n);let s=0;return i.set([this.flags%256],s),s+=1,i.set(Js(e.length),s),s+=2,i.set(e,s),s+=e.length,i.set(Js(t.length),s),s+=2,t.length&&i.set(t,s),i}static decode(e){let t=0;e[0]==202&&(t+=4);const n=e[t++],i=Zs(e.slice(t,t+2));t+=2;const s=e.slice(t,t+i);t+=i;const a=new TextDecoder().decode(s),o=Zs(e.slice(t,t+2));t+=2;const l=e.slice(t,t+o),u=l.length?l:void 0;return new Vn(n,a,u)}}var qi={exports:{}},wi,Ks;function cf(){if(Ks)return wi;Ks=1;var r=1e3,e=r*60,t=e*60,n=t*24,i=n*7,s=n*365.25;wi=function(c,d){d=d||{};var f=typeof c;if(f==="string"&&c.length>0)return a(c);if(f==="number"&&isFinite(c))return d.long?l(c):o(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function a(c){if(c=String(c),!(c.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(d){var f=parseFloat(d[1]),h=(d[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return f*s;case"weeks":case"week":case"w":return f*i;case"days":case"day":case"d":return f*n;case"hours":case"hour":case"hrs":case"hr":case"h":return f*t;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function o(c){var d=Math.abs(c);return d>=n?Math.round(c/n)+"d":d>=t?Math.round(c/t)+"h":d>=e?Math.round(c/e)+"m":d>=r?Math.round(c/r)+"s":c+"ms"}function l(c){var d=Math.abs(c);return d>=n?u(c,d,n,"day"):d>=t?u(c,d,t,"hour"):d>=e?u(c,d,e,"minute"):d>=r?u(c,d,r,"second"):c+" ms"}function u(c,d,f,h){var v=d>=f*1.5;return Math.round(c/f)+" "+h+(v?"s":"")}return wi}function df(r){t.debug=t,t.default=t,t.coerce=l,t.disable=s,t.enable=i,t.enabled=a,t.humanize=cf(),t.destroy=u,Object.keys(r).forEach(c=>{t[c]=r[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let d=0;for(let f=0;f<c.length;f++)d=(d<<5)-d+c.charCodeAt(f),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(c){let d,f=null,h,v;function g(...m){if(!g.enabled)return;const E=g,w=Number(new Date),A=w-(d||w);E.diff=A,E.prev=d,E.curr=w,d=w,m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let S=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(M,W)=>{if(M==="%%")return"%";S++;const Z=t.formatters[W];if(typeof Z=="function"){const P=m[S];M=Z.call(E,P),m.splice(S,1),S--}return M}),t.formatArgs.call(E,m),(E.log||t.log).apply(E,m)}return g.namespace=c,g.useColors=t.useColors(),g.color=t.selectColor(c),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(h!==t.namespaces&&(h=t.namespaces,v=t.enabled(c)),v),set:m=>{f=m}}),typeof t.init=="function"&&t.init(g),g}function n(c,d){const f=t(this.namespace+(typeof d>"u"?":":d)+c);return f.log=this.log,f}function i(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let d;const f=(typeof c=="string"?c:"").split(/[\s,]+/),h=f.length;for(d=0;d<h;d++)f[d]&&(c=f[d].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.slice(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function s(){const c=[...t.names.map(o),...t.skips.map(o).map(d=>"-"+d)].join(",");return t.enable(""),c}function a(c){if(c[c.length-1]==="*")return!0;let d,f;for(d=0,f=t.skips.length;d<f;d++)if(t.skips[d].test(c))return!1;for(d=0,f=t.names.length;d<f;d++)if(t.names[d].test(c))return!0;return!1}function o(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var ff=df;(function(r,e){e.formatArgs=n,e.save=i,e.load=s,e.useColors=t,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let c=0,d=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(c++,f==="%c"&&(d=c))}),l.splice(d,0,u)}e.log=console.debug||console.log||(()=>{});function i(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof I.process<"u"&&"env"in I.process&&(l={}.DEBUG),l}function a(){try{return localStorage}catch{}}r.exports=ff(e);const{formatters:o}=r.exports;o.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(qi,qi.exports);var hf=qi.exports;const Qn=ts(hf),ve=Qn("wasmrs");class pf extends Error{matcher(){return new RegExp(this.toString().replace(/^Error: /,""))}}class mf extends pf{constructor(e,t,n){super(`Host call not implemented. Guest called host with binding = '${e}', namespace = '${t}', & operation = '${n}'`)}}var or;(function(r){r.OP_LIST="__op_list",r.INIT_BUFFERS="__init_buffers",r.CONSOLE_LOG="__console_log",r.SEND="__send"})(or||(or={}));var Ke;(function(r){r.START="_start",r.OP_LIST_REQUEST="__wasmrs_op_list_request",r.INIT="__wasmrs_init",r.SEND="__wasmrs_send"})(Ke||(Ke={}));function ea(r){return r[0]<<24|r[1]<<16|r[2]<<8|r[3]}function ta(r){const e=new Uint8Array(4);return e[0]=(r>>24)%256,e[1]=(r>>16)%256,e[2]=(r>>8)%256,e[3]=r%256,e}function vf(r){const e=new Uint8Array(3);return e[0]=r>>8>>8%256,e[1]=r>>8%256,e[2]=r%256,e}function gf(r){return r[0]<<16|r[1]<<8|r[2]}function Sn(r){return r[0]<<8|r[1]}class yf{constructor(e,t){F(this,"guestRequest");F(this,"guestResponse");F(this,"hostResponse");F(this,"guestError");F(this,"hostError");F(this,"hostCallback");F(this,"writer");this.hostCallback=e||((n,i,s)=>{throw new mf(n,i,s)}),this.writer=t||(()=>{})}}let zi;class Dt{constructor(e){F(this,"module");this.module=e}static from(e){if(e instanceof Dt)return e;if(e instanceof WebAssembly.Module)return new Dt(e);if("module"in e&&e.module instanceof WebAssembly.Module)return new Dt(e.module);throw new Error(`cannot convert ${e} to WasmRsModule`)}static async compile(e){const t=WebAssembly.compile(e);return new Dt(await t)}static async compileStreaming(e){if(!WebAssembly.compileStreaming){console.warn("WebAssembly.compileStreaming is not supported on this browser, wasm execution will be impacted.");const n=new Uint8Array(await(await e).arrayBuffer());return Dt.compile(n)}const t=WebAssembly.compileStreaming(e);return new Dt(await t)}async instantiate(e={}){const t=new ds(e);let n;if(e.wasi){if(!zi)throw new Error("Wasi options provided but no WASI implementation found");n=await zi.create(e.wasi)}const i=Ef(t,n);ve("instantiating wasm module");const s=await WebAssembly.instantiate(this.module,i);return n&&n.initialize(s),await t.initialize(s),t}customSection(e){return WebAssembly.Module.customSections(this.module,e)}}class ds extends EventTarget{constructor(t={}){super();F(this,"guestBufferStart",0);F(this,"hostBufferStart",0);F(this,"state");F(this,"guestSend");F(this,"guestOpListRequest");F(this,"textEncoder");F(this,"textDecoder");F(this,"instance");F(this,"operations",new Fo([],[]));this.state=new yf(t.hostCall,t.writer),this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder("utf-8"),this.guestSend=()=>{},this.guestOpListRequest=()=>{}}static setWasi(t){zi=t}initialize(t){this.instance=t;const n=this.instance.exports[Ke.START];n!=null&&(ve(">>>",`${Ke.START}()`),n([]));const i=this.getProtocolExport(Ke.INIT),s=512*1024;ve(">>>",`${Ke.INIT}(${s},${s},${s})`),i(s,s,s);const a=this.getProtocolExport(Ke.OP_LIST_REQUEST);a!=null&&(ve(">>>",`${Ke.OP_LIST_REQUEST}()`),a()),this.guestSend=this.getProtocolExport(Ke.SEND),this.guestOpListRequest=this.getProtocolExport(Ke.OP_LIST_REQUEST),ve("initialized wasm module")}getProtocolExport(t){const n=this.instance.exports[t];if(n==null)throw new Error(`WebAssembly module does not export ${t}`);return n}send(t){const n=this.getCallerMemory(),i=new Uint8Array(n.buffer);ve(`writing ${t.length} bytes to guest memory buffer`,t,this.guestBufferStart),i.set(vf(t.length),this.guestBufferStart),i.set(t,this.guestBufferStart+3),ve(">>>",` ${Ke.SEND}(${t.length})`),this.guestSend(t.length)}getCallerMemory(){return this.instance.exports.memory}close(){}}function Ef(r,e){return e?(ve("enabling wasi"),{wasi_snapshot_preview1:e.getImports(),wasmrs:ra(r)}):(ve("disabling wasi"),{wasmrs:ra(r)})}class bf extends Event{constructor(t,n){super(t);F(this,"payload");this.payload=n}}function ra(r){return{[or.CONSOLE_LOG](e,t){ve("<<< __console_log %o bytes @ %o",t,e);const i=new Uint8Array(r.getCallerMemory().buffer).slice(e,e+t);console.log(r.textDecoder.decode(i))},[or.INIT_BUFFERS](e,t){ve("<<< __init_buffers(%o, %o)",e,t),r.guestBufferStart=e,r.hostBufferStart=t},[or.SEND](e){ve("<<< __send(%o)",e);const n=new Uint8Array(r.getCallerMemory().buffer).slice(r.hostBufferStart,r.hostBufferStart+e);ve(`'frame' event: ${n.length} bytes`,Array.from(n).map(a=>a>16&&a<127?String.fromCharCode(a):`\\x${a.toString(16)}`).join(""));let i=!1,s=0;for(;!i;){const a=gf(n.slice(s,3)),o=n.slice(s+3,s+3+a);r.dispatchEvent(new bf("frame",o)),s+=3+a,i=s>=n.length}},[or.OP_LIST](e,t){ve("<<< __op_list(%o,%o)",e,t);const i=new Uint8Array(r.getCallerMemory().buffer).slice(e,e+t);if(t===0)return;if(i.slice(0,4).toString()!==Sf.toString())throw new Error("invalid op_list magic bytes");const s=Sn(i.slice(4,6));if(ve("op_list bytes: %o",i),s==1){const a=_f(i.slice(6),r.textDecoder);ve("module operations: %o",a),r.operations=a}}}}function _f(r,e){const t=[],n=[];let i=ea(r.slice(0,4));ve("decoding %o operations",i);let s=4;for(;i>0;){const a=r[s++],o=r[s++],l=ea(r.slice(s,s+4));s+=4;const u=Sn(r.slice(s,s+2));s+=2;const c=e.decode(r.slice(s,s+u));s+=u;const d=Sn(r.slice(s,s+2));s+=2;const f=e.decode(r.slice(s,s+d));s+=d;const h=Sn(r.slice(s,s+2));s+=2+h;const v=new wf(l,a,c,f);o===1?n.push(v):t.push(v),i--}return new Fo(t,n)}class Fo{constructor(e,t){F(this,"imports");F(this,"exports");this.imports=e,this.exports=t}getExport(e,t){const n=this.exports.find(i=>i.namespace===e&&i.operation===t);if(!n)throw new Error(`operation ${e}::${t} not found in exports`);return n}getImport(e,t){const n=this.imports.find(i=>i.namespace===e&&i.operation===t);if(!n)throw new Error(`operation ${e}::${t} not found in imports`);return n}}class wf{constructor(e,t,n,i){F(this,"index");F(this,"kind");F(this,"namespace");F(this,"operation");this.index=e,this.kind=t,this.namespace=n,this.operation=i}asEncoded(){const e=ta(this.index),t=new Uint8Array(e.length+4);return t.set(e),t.set(ta(0),e.length),t}}var na;(function(r){r[r.RR=0]="RR",r[r.FNF=1]="FNF",r[r.RS=2]="RS",r[r.RC=3]="RC"})(na||(na={}));const Sf=Uint8Array.from([0,119,114,115]);var Si={},fs={},Ye={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Frame=r.Lengths=r.Flags=r.FrameTypes=void 0;var e;(function(t){t[t.RESERVED=0]="RESERVED",t[t.SETUP=1]="SETUP",t[t.LEASE=2]="LEASE",t[t.KEEPALIVE=3]="KEEPALIVE",t[t.REQUEST_RESPONSE=4]="REQUEST_RESPONSE",t[t.REQUEST_FNF=5]="REQUEST_FNF",t[t.REQUEST_STREAM=6]="REQUEST_STREAM",t[t.REQUEST_CHANNEL=7]="REQUEST_CHANNEL",t[t.REQUEST_N=8]="REQUEST_N",t[t.CANCEL=9]="CANCEL",t[t.PAYLOAD=10]="PAYLOAD",t[t.ERROR=11]="ERROR",t[t.METADATA_PUSH=12]="METADATA_PUSH",t[t.RESUME=13]="RESUME",t[t.RESUME_OK=14]="RESUME_OK",t[t.EXT=63]="EXT"})(e=r.FrameTypes||(r.FrameTypes={})),function(t){t[t.NONE=0]="NONE",t[t.COMPLETE=64]="COMPLETE",t[t.FOLLOWS=128]="FOLLOWS",t[t.IGNORE=512]="IGNORE",t[t.LEASE=64]="LEASE",t[t.METADATA=256]="METADATA",t[t.NEXT=32]="NEXT",t[t.RESPOND=128]="RESPOND",t[t.RESUME_ENABLE=128]="RESUME_ENABLE"}(r.Flags||(r.Flags={})),function(t){function n(d){return(d&t.METADATA)===t.METADATA}t.hasMetadata=n;function i(d){return(d&t.COMPLETE)===t.COMPLETE}t.hasComplete=i;function s(d){return(d&t.NEXT)===t.NEXT}t.hasNext=s;function a(d){return(d&t.FOLLOWS)===t.FOLLOWS}t.hasFollows=a;function o(d){return(d&t.IGNORE)===t.IGNORE}t.hasIgnore=o;function l(d){return(d&t.RESPOND)===t.RESPOND}t.hasRespond=l;function u(d){return(d&t.LEASE)===t.LEASE}t.hasLease=u;function c(d){return(d&t.RESUME_ENABLE)===t.RESUME_ENABLE}t.hasResume=c}(r.Flags||(r.Flags={})),function(t){t[t.FRAME=3]="FRAME",t[t.HEADER=6]="HEADER",t[t.METADATA=3]="METADATA",t[t.REQUEST=3]="REQUEST"}(r.Lengths||(r.Lengths={})),function(t){function n(s){return s.streamId===0}t.isConnection=n;function i(s){return e.REQUEST_RESPONSE<=s.type&&s.type<=e.REQUEST_CHANNEL}t.isRequest=i}(r.Frame||(r.Frame={}))})(Ye);(function(r){var e=T&&T.__generator||function(p,_){var y={label:0,sent:function(){if(R[0]&1)throw R[1];return R[1]},trys:[],ops:[]},b,C,R,x;return x={next:he(0),throw:he(1),return:he(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function he(k){return function(Ve){return Ge([k,Ve])}}function Ge(k){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,C&&(R=k[0]&2?C.return:k[0]?C.throw||((R=C.return)&&R.call(C),0):C.next)&&!(R=R.call(C,k[1])).done)return R;switch(C=0,R&&(k=[k[0]&2,R.value]),k[0]){case 0:case 1:R=k;break;case 4:return y.label++,{value:k[1],done:!1};case 5:y.label++,C=k[1],k=[0];continue;case 7:k=y.ops.pop(),y.trys.pop();continue;default:if(R=y.trys,!(R=R.length>0&&R[R.length-1])&&(k[0]===6||k[0]===2)){y=0;continue}if(k[0]===3&&(!R||k[1]>R[0]&&k[1]<R[3])){y.label=k[1];break}if(k[0]===6&&y.label<R[1]){y.label=R[1],R=k;break}if(R&&y.label<R[2]){y.label=R[2],y.ops.push(k);break}R[2]&&y.ops.pop(),y.trys.pop();continue}k=_.call(p,y)}catch(Ve){k=[6,Ve],C=0}finally{b=R=0}if(k[0]&5)throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Deserializer=r.sizeOfFrame=r.serializeFrame=r.deserializeFrame=r.serializeFrameWithLength=r.deserializeFrames=r.deserializeFrameWithLength=r.writeUInt64BE=r.readUInt64BE=r.writeUInt24BE=r.readUInt24BE=r.MAX_VERSION=r.MAX_TTL=r.MAX_STREAM_ID=r.MAX_RESUME_LENGTH=r.MAX_REQUEST_N=r.MAX_REQUEST_COUNT=r.MAX_MIME_LENGTH=r.MAX_METADATA_LENGTH=r.MAX_LIFETIME=r.MAX_KEEPALIVE=r.MAX_CODE=r.FRAME_TYPE_OFFFSET=r.FLAGS_MASK=void 0;var t=Ye;r.FLAGS_MASK=1023,r.FRAME_TYPE_OFFFSET=10,r.MAX_CODE=2147483647,r.MAX_KEEPALIVE=2147483647,r.MAX_LIFETIME=2147483647,r.MAX_METADATA_LENGTH=16777215,r.MAX_MIME_LENGTH=255,r.MAX_REQUEST_COUNT=2147483647,r.MAX_REQUEST_N=2147483647,r.MAX_RESUME_LENGTH=65535,r.MAX_STREAM_ID=2147483647,r.MAX_TTL=2147483647,r.MAX_VERSION=65535;var n=4294967296;function i(p,_){var y=p.readUInt8(_)<<16,b=p.readUInt8(_+1)<<8,C=p.readUInt8(_+2);return y|b|C}r.readUInt24BE=i;function s(p,_,y){return y=p.writeUInt8(_>>>16,y),y=p.writeUInt8(_>>>8&255,y),p.writeUInt8(_&255,y)}r.writeUInt24BE=s;function a(p,_){var y=p.readUInt32BE(_),b=p.readUInt32BE(_+4);return y*n+b}r.readUInt64BE=a;function o(p,_,y){var b=_/n|0,C=_%n;return y=p.writeUInt32BE(b,y),p.writeUInt32BE(C,y)}r.writeUInt64BE=o;var l=6,u=3;function c(p){var _=i(p,0);return h(p.slice(u,u+_))}r.deserializeFrameWithLength=c;function d(p){var _,y,b,C,R,x;return e(this,function(he){switch(he.label){case 0:_=0,he.label=1;case 1:return _+u<p.length?(y=i(p,_),b=_+u,C=b+y,C>p.length?[3,3]:(R=p.slice(b,C),x=h(R),_=C,[4,[x,_]])):[3,3];case 2:return he.sent(),[3,1];case 3:return[2]}})}r.deserializeFrames=d;function f(p){var _=v(p),y=I.Buffer.allocUnsafe(_.length+u);return s(y,_.length,0),_.copy(y,u),y}r.serializeFrameWithLength=f;function h(p){var _=0,y=p.readInt32BE(_);_+=4;var b=p.readUInt16BE(_);_+=2;var C=b>>>r.FRAME_TYPE_OFFFSET,R=b&r.FLAGS_MASK;switch(C){case t.FrameTypes.SETUP:return S(p,y,R);case t.FrameTypes.PAYLOAD:return ni(p,y,R);case t.FrameTypes.ERROR:return Z(p,y,R);case t.FrameTypes.KEEPALIVE:return N(p,y,R);case t.FrameTypes.REQUEST_FNF:return Oe(p,y,R);case t.FrameTypes.REQUEST_RESPONSE:return Fe(p,y,R);case t.FrameTypes.REQUEST_STREAM:return $e(p,y,R);case t.FrameTypes.REQUEST_CHANNEL:return je(p,y,R);case t.FrameTypes.METADATA_PUSH:return D(p,y,R);case t.FrameTypes.REQUEST_N:return Zn(p,y,R);case t.FrameTypes.RESUME:return ai(p,y,R);case t.FrameTypes.RESUME_OK:return ui(p,y,R);case t.FrameTypes.CANCEL:return ei(p,y,R);case t.FrameTypes.LEASE:return me(p,y,R)}}r.deserializeFrame=h;function v(p){switch(p.type){case t.FrameTypes.SETUP:return w(p);case t.FrameTypes.PAYLOAD:return ti(p);case t.FrameTypes.ERROR:return M(p);case t.FrameTypes.KEEPALIVE:return oe(p);case t.FrameTypes.REQUEST_FNF:case t.FrameTypes.REQUEST_RESPONSE:return Ae(p);case t.FrameTypes.REQUEST_STREAM:case t.FrameTypes.REQUEST_CHANNEL:return Ct(p);case t.FrameTypes.METADATA_PUSH:return ye(p);case t.FrameTypes.REQUEST_N:return Ze(p);case t.FrameTypes.RESUME:return ii(p);case t.FrameTypes.RESUME_OK:return oi(p);case t.FrameTypes.CANCEL:return Wn(p);case t.FrameTypes.LEASE:return re(p)}}r.serializeFrame=v;function g(p){switch(p.type){case t.FrameTypes.SETUP:return A(p);case t.FrameTypes.PAYLOAD:return ri(p);case t.FrameTypes.ERROR:return W(p);case t.FrameTypes.KEEPALIVE:return ne(p);case t.FrameTypes.REQUEST_FNF:case t.FrameTypes.REQUEST_RESPONSE:return _e(p);case t.FrameTypes.REQUEST_STREAM:case t.FrameTypes.REQUEST_CHANNEL:return Ot(p);case t.FrameTypes.METADATA_PUSH:return Pe(p);case t.FrameTypes.REQUEST_N:return Jn();case t.FrameTypes.RESUME:return si(p);case t.FrameTypes.RESUME_OK:return li();case t.FrameTypes.CANCEL:return Kn();case t.FrameTypes.LEASE:return q(p)}}r.sizeOfFrame=g;var m=14,E=2;function w(p){var _=p.resumeToken!=null?p.resumeToken.byteLength:0,y=p.metadataMimeType!=null?I.Buffer.byteLength(p.metadataMimeType,"ascii"):0,b=p.dataMimeType!=null?I.Buffer.byteLength(p.dataMimeType,"ascii"):0,C=we(p),R=I.Buffer.allocUnsafe(l+m+(_?E+_:0)+y+b+C),x=le(p,R);return x=R.writeUInt16BE(p.majorVersion,x),x=R.writeUInt16BE(p.minorVersion,x),x=R.writeUInt32BE(p.keepAlive,x),x=R.writeUInt32BE(p.lifetime,x),p.flags&t.Flags.RESUME_ENABLE&&(x=R.writeUInt16BE(_,x),p.resumeToken!=null&&(x+=p.resumeToken.copy(R,x))),x=R.writeUInt8(y,x),p.metadataMimeType!=null&&(x+=R.write(p.metadataMimeType,x,x+y,"ascii")),x=R.writeUInt8(b,x),p.dataMimeType!=null&&(x+=R.write(p.dataMimeType,x,x+b,"ascii")),Ut(p,R,x),R}function A(p){var _=p.resumeToken!=null?p.resumeToken.byteLength:0,y=p.metadataMimeType!=null?I.Buffer.byteLength(p.metadataMimeType,"ascii"):0,b=p.dataMimeType!=null?I.Buffer.byteLength(p.dataMimeType,"ascii"):0,C=we(p);return l+m+(_?E+_:0)+y+b+C}function S(p,_,y){p.length;var b=l,C=p.readUInt16BE(b);b+=2;var R=p.readUInt16BE(b);b+=2;var x=p.readInt32BE(b);b+=4;var he=p.readInt32BE(b);b+=4;var Ge=null;if(y&t.Flags.RESUME_ENABLE){var k=p.readInt16BE(b);b+=2,Ge=p.slice(b,b+k),b+=k}var Ve=p.readUInt8(b);b+=1;var di=p.toString("ascii",b,b+Ve);b+=Ve;var kr=p.readUInt8(b);b+=1;var fi=p.toString("ascii",b,b+kr);b+=kr;var Lr={data:null,dataMimeType:fi,flags:y,keepAlive:x,lifetime:he,majorVersion:C,metadata:null,metadataMimeType:di,minorVersion:R,resumeToken:Ge,streamId:0,type:t.FrameTypes.SETUP};return He(p,Lr,b),Lr}var B=4;function M(p){var _=p.message!=null?I.Buffer.byteLength(p.message,"utf8"):0,y=I.Buffer.allocUnsafe(l+B+_),b=le(p,y);return b=y.writeUInt32BE(p.code,b),p.message!=null&&y.write(p.message,b,b+_,"utf8"),y}function W(p){var _=p.message!=null?I.Buffer.byteLength(p.message,"utf8"):0;return l+B+_}function Z(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R=p.length-b,x="";return R>0&&(x=p.toString("utf8",b,b+R),b+=R),{code:C,flags:y,message:x,streamId:_,type:t.FrameTypes.ERROR}}var P=8;function oe(p){var _=p.data!=null?p.data.byteLength:0,y=I.Buffer.allocUnsafe(l+P+_),b=le(p,y);return b=o(y,p.lastReceivedPosition,b),p.data!=null&&p.data.copy(y,b),y}function ne(p){var _=p.data!=null?p.data.byteLength:0;return l+P+_}function N(p,_,y){p.length;var b=l,C=a(p,b);b+=8;var R=null;return b<p.length&&(R=p.slice(b,p.length)),{data:R,flags:y,lastReceivedPosition:C,streamId:0,type:t.FrameTypes.KEEPALIVE}}var ie=8;function re(p){var _=p.metadata!=null?p.metadata.byteLength:0,y=I.Buffer.allocUnsafe(l+ie+_),b=le(p,y);return b=y.writeUInt32BE(p.ttl,b),b=y.writeUInt32BE(p.requestCount,b),p.metadata!=null&&p.metadata.copy(y,b),y}function q(p){var _=p.metadata!=null?p.metadata.byteLength:0;return l+ie+_}function me(p,_,y){var b=l,C=p.readUInt32BE(b);b+=4;var R=p.readUInt32BE(b);b+=4;var x=null;return b<p.length&&(x=p.slice(b,p.length)),{flags:y,metadata:x,requestCount:R,streamId:0,ttl:C,type:t.FrameTypes.LEASE}}function Ae(p){var _=we(p),y=I.Buffer.allocUnsafe(l+_),b=le(p,y);return Ut(p,y,b),y}function _e(p){var _=we(p);return l+_}function ye(p){var _=p.metadata;if(_!=null){var y=I.Buffer.allocUnsafe(l+_.byteLength),b=le(p,y);return _.copy(y,b),y}else{var y=I.Buffer.allocUnsafe(l);return le(p,y),y}}function Pe(p){return l+(p.metadata!=null?p.metadata.byteLength:0)}function Oe(p,_,y){p.length;var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.REQUEST_FNF};return He(p,b,l),b}function Fe(p,_,y){var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.REQUEST_RESPONSE};return He(p,b,l),b}function D(p,_,y){return{flags:y,metadata:length===l?null:p.slice(l,length),streamId:0,type:t.FrameTypes.METADATA_PUSH}}var It=4;function Ct(p){var _=we(p),y=I.Buffer.allocUnsafe(l+It+_),b=le(p,y);return b=y.writeUInt32BE(p.requestN,b),Ut(p,y,b),y}function Ot(p){var _=we(p);return l+It+_}function $e(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R={data:null,flags:y,metadata:null,requestN:C,streamId:_,type:t.FrameTypes.REQUEST_STREAM};return He(p,R,b),R}function je(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R={data:null,flags:y,metadata:null,requestN:C,streamId:_,type:t.FrameTypes.REQUEST_CHANNEL};return He(p,R,b),R}var Je=4;function Ze(p){var _=I.Buffer.allocUnsafe(l+Je),y=le(p,_);return _.writeUInt32BE(p.requestN,y),_}function Jn(p){return l+Je}function Zn(p,_,y){p.length;var b=p.readInt32BE(l);return{flags:y,requestN:b,streamId:_,type:t.FrameTypes.REQUEST_N}}function Wn(p){var _=I.Buffer.allocUnsafe(l);return le(p,_),_}function Kn(p){return l}function ei(p,_,y){return p.length,{flags:y,streamId:_,type:t.FrameTypes.CANCEL}}function ti(p){var _=we(p),y=I.Buffer.allocUnsafe(l+_),b=le(p,y);return Ut(p,y,b),y}function ri(p){var _=we(p);return l+_}function ni(p,_,y){p.length;var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.PAYLOAD};return He(p,b,l),b}var Dr=22;function ii(p){var _=p.resumeToken.byteLength,y=I.Buffer.allocUnsafe(l+Dr+_),b=le(p,y);return b=y.writeUInt16BE(p.majorVersion,b),b=y.writeUInt16BE(p.minorVersion,b),b=y.writeUInt16BE(_,b),b+=p.resumeToken.copy(y,b),b=o(y,p.serverPosition,b),o(y,p.clientPosition,b),y}function si(p){var _=p.resumeToken.byteLength;return l+Dr+_}function ai(p,_,y){p.length;var b=l,C=p.readUInt16BE(b);b+=2;var R=p.readUInt16BE(b);b+=2;var x=p.readInt16BE(b);b+=2;var he=p.slice(b,b+x);b+=x;var Ge=a(p,b);b+=8;var k=a(p,b);return b+=8,{clientPosition:k,flags:y,majorVersion:C,minorVersion:R,resumeToken:he,serverPosition:Ge,streamId:0,type:t.FrameTypes.RESUME}}var Pr=8;function oi(p){var _=I.Buffer.allocUnsafe(l+Pr),y=le(p,_);return o(_,p.clientPosition,y),_}function li(p){return l+Pr}function ui(p,_,y){p.length;var b=a(p,l);return{clientPosition:b,flags:y,streamId:0,type:t.FrameTypes.RESUME_OK}}function le(p,_){var y=_.writeInt32BE(p.streamId,0);return _.writeUInt16BE(p.type<<r.FRAME_TYPE_OFFFSET|p.flags&r.FLAGS_MASK,y)}function we(p){var _=0;return p.data!=null&&(_+=p.data.byteLength),t.Flags.hasMetadata(p.flags)&&(_+=u,p.metadata!=null&&(_+=p.metadata.byteLength)),_}function Ut(p,_,y){if(t.Flags.hasMetadata(p.flags))if(p.metadata!=null){var b=p.metadata.byteLength;y=s(_,b,y),y+=p.metadata.copy(_,y)}else y=s(_,0,y);p.data!=null&&p.data.copy(_,y)}function He(p,_,y){if(t.Flags.hasMetadata(_.flags)){var b=i(p,y);y+=u,b>0&&(_.metadata=p.slice(y,y+b),y+=b)}y<p.length&&(_.data=p.slice(y,p.length))}var ci=function(){function p(){}return p.prototype.deserializeFrame=function(_){return h(_)},p.prototype.deserializeFrameWithLength=function(_){return c(_)},p.prototype.deserializeFrames=function(_){return d(_)},p}();r.Deserializer=ci})(fs);var xo={};Object.defineProperty(xo,"__esModule",{value:!0});var cn={},ia=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(cn,"__esModule",{value:!0});cn.Deferred=void 0;var Rf=function(){function r(){this._done=!1,this.onCloseCallbacks=[]}return Object.defineProperty(r.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0}),r.prototype.close=function(e){var t,n,i,s;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}if(this._done=!0,this._error=e,e){try{for(var a=ia(this.onCloseCallbacks),o=a.next();!o.done;o=a.next()){var l=o.value;l(e)}}catch(d){t={error:d}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return}try{for(var u=ia(this.onCloseCallbacks),c=u.next();!c.done;c=u.next()){var l=c.value;l()}}catch(d){i={error:d}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}},r.prototype.onClose=function(e){if(this._done){e(this._error);return}this.onCloseCallbacks.push(e)},r}();cn.Deferred=Rf;var qt={};(function(r){var e=T&&T.__extends||function(){var n=function(i,s){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},n(i,s)};return function(i,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");n(i,s);function a(){this.constructor=i}i.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}();Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorCodes=r.RSocketError=void 0;var t=function(n){e(i,n);function i(s,a){var o=n.call(this,a)||this;return o.code=s,o}return i}(Error);r.RSocketError=t,function(n){n[n.RESERVED=0]="RESERVED",n[n.INVALID_SETUP=1]="INVALID_SETUP",n[n.UNSUPPORTED_SETUP=2]="UNSUPPORTED_SETUP",n[n.REJECTED_SETUP=3]="REJECTED_SETUP",n[n.REJECTED_RESUME=4]="REJECTED_RESUME",n[n.CONNECTION_CLOSE=258]="CONNECTION_CLOSE",n[n.CONNECTION_ERROR=257]="CONNECTION_ERROR",n[n.APPLICATION_ERROR=513]="APPLICATION_ERROR",n[n.REJECTED=514]="REJECTED",n[n.CANCELED=515]="CANCELED",n[n.INVALID=516]="INVALID",n[n.RESERVED_EXTENSION=4294967295]="RESERVED_EXTENSION"}(r.ErrorCodes||(r.ErrorCodes={}))})(qt);var Io={};Object.defineProperty(Io,"__esModule",{value:!0});var Vr={},Ri={},sa;function Co(){return sa||(sa=1,function(r){var e=T&&T.__extends||function(){var d=function(f,h){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(v[m]=g[m])},d(f,h)};return function(f,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");d(f,h);function v(){this.constructor=f}f.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),t=T&&T.__awaiter||function(d,f,h,v){function g(m){return m instanceof h?m:new h(function(E){E(m)})}return new(h||(h=Promise))(function(m,E){function w(B){try{S(v.next(B))}catch(M){E(M)}}function A(B){try{S(v.throw(B))}catch(M){E(M)}}function S(B){B.done?m(B.value):g(B.value).then(w,A)}S((v=v.apply(d,f||[])).next())})},n=T&&T.__generator||function(d,f){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},v,g,m,E;return E={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function w(S){return function(B){return A([S,B])}}function A(S){if(v)throw new TypeError("Generator is already executing.");for(;h;)try{if(v=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return h.label++,{value:S[1],done:!1};case 5:h.label++,g=S[1],S=[0];continue;case 7:S=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){h=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){h.label=S[1];break}if(S[0]===6&&h.label<m[1]){h.label=m[1],m=S;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(S);break}m[2]&&h.ops.pop(),h.trys.pop();continue}S=f.call(d,h)}catch(B){S=[6,B],g=0}finally{v=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer=r.ResumableClientServerInputMultiplexerDemultiplexer=r.ClientServerInputMultiplexerDemultiplexer=r.StreamIdGenerator=void 0;var i=hs(),s=cn,a=qt,o=Ye;(function(d){function f(v){return new h(v)}d.create=f;var h=function(){function v(g){this.currentId=g}return v.prototype.next=function(g){var m=this.currentId+2;g(m)&&(this.currentId=m)},v}()})(r.StreamIdGenerator||(r.StreamIdGenerator={}));var l=function(d){e(f,d);function f(h,v,g){var m=d.call(this)||this;return m.streamIdSupplier=h,m.outbound=v,m.closeable=g,m.registry={},g.onClose(m.close.bind(m)),m}return f.prototype.handle=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.RESERVED)return;this.connectionFramesHandler.handle(h)}else if(o.Frame.isRequest(h)){if(this.registry[h.streamId])return;this.requestFramesHandler.handle(h,this)}else{var v=this.registry[h.streamId];if(!v)return;v.handle(h)}},f.prototype.connectionInbound=function(h){if(this.connectionFramesHandler)throw new Error("Connection frame handler has already been installed");this.connectionFramesHandler=h},f.prototype.handleRequestStream=function(h){if(this.requestFramesHandler)throw new Error("Stream handler has already been installed");this.requestFramesHandler=h},f.prototype.send=function(h){this.outbound.send(h)},Object.defineProperty(f.prototype,"connectionOutbound",{get:function(){return this},enumerable:!1,configurable:!0}),f.prototype.createRequestStream=function(h){var v=this;if(this.done){h.handleReject(new Error("Already closed"));return}var g=this.registry;this.streamIdSupplier.next(function(m){return h.handleReady(m,v)},Object.keys(g))},f.prototype.connect=function(h){this.registry[h.streamId]=h},f.prototype.disconnect=function(h){delete this.registry[h.streamId]},f.prototype.close=function(h){if(this.done){d.prototype.close.call(this,h);return}for(var v in this.registry){var g=this.registry[v];g.close(new Error("Closed. ".concat(h?"Original cause [".concat(h,"]."):"")))}d.prototype.close.call(this,h)},f}(s.Deferred);r.ClientServerInputMultiplexerDemultiplexer=l;var u=function(d){e(f,d);function f(h,v,g,m,E,w,A){var S=d.call(this,h,v,new s.Deferred)||this;return S.frameStore=m,S.token=E,S.sessionTimeout=A,w instanceof Function?S.reconnector=w:S.sessionStore=w,g.onClose(S.handleConnectionClose.bind(S)),S}return f.prototype.send=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.KEEPALIVE)h.lastReceivedPosition=this.frameStore.lastReceivedFramePosition;else if(h.type===i.FrameTypes.ERROR){this.outbound.send(h),this.sessionStore&&delete this.sessionStore[this.token],d.prototype.close.call(this,new a.RSocketError(h.code,h.message));return}}else this.frameStore.store(h);this.outbound.send(h)},f.prototype.handle=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.KEEPALIVE)try{this.frameStore.dropTo(h.lastReceivedPosition)}catch(v){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),this.close(v)}else if(h.type===i.FrameTypes.ERROR){d.prototype.handle.call(this,h),this.sessionStore&&delete this.sessionStore[this.token],d.prototype.close.call(this,new a.RSocketError(h.code,h.message));return}}else this.frameStore.record(h);d.prototype.handle.call(this,h)},f.prototype.resume=function(h,v,g){switch(this.outbound=v,h.type){case i.FrameTypes.RESUME:{if(clearTimeout(this.timeoutId),this.frameStore.lastReceivedFramePosition<h.clientPosition){var m=new a.RSocketError(i.ErrorCodes.REJECTED_RESUME,"Impossible to resume since first available client frame position is greater than last received server frame position");this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:m.code,message:m.message}),this.close(m);return}try{this.frameStore.dropTo(h.serverPosition)}catch(E){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:E.code,message:E.message}),this.close(E);return}this.outbound.send({type:i.FrameTypes.RESUME_OK,streamId:0,flags:i.Flags.NONE,clientPosition:this.frameStore.lastReceivedFramePosition});break}case i.FrameTypes.RESUME_OK:{try{this.frameStore.dropTo(h.clientPosition)}catch(E){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:E.code,message:E.message}),this.close(E)}break}}this.frameStore.drain(this.outbound.send.bind(this.outbound)),g.onClose(this.handleConnectionClose.bind(this)),this.connectionFramesHandler.resume()},f.prototype.handleConnectionClose=function(h){return t(this,void 0,void 0,function(){var v;return n(this,function(g){switch(g.label){case 0:if(this.connectionFramesHandler.pause(),!this.reconnector)return[3,5];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this.reconnector(this,this.frameStore)];case 2:return g.sent(),[3,4];case 3:return v=g.sent(),this.close(v),[3,4];case 4:return[3,6];case 5:this.timeoutId=setTimeout(this.close.bind(this),this.sessionTimeout),g.label=6;case 6:return[2]}})})},f}(l);r.ResumableClientServerInputMultiplexerDemultiplexer=u;var c=function(){function d(f,h,v){this.outbound=f,this.closeable=h,this.delegate=v,this.resumed=!1}return d.prototype.close=function(){this.delegate.close()},d.prototype.onClose=function(f){this.delegate.onClose(f)},Object.defineProperty(d.prototype,"connectionOutbound",{get:function(){return this.delegate.connectionOutbound},enumerable:!1,configurable:!0}),d.prototype.createRequestStream=function(f){this.delegate.createRequestStream(f)},d.prototype.connectionInbound=function(f){this.delegate.connectionInbound(f)},d.prototype.handleRequestStream=function(f){this.delegate.handleRequestStream(f)},d.prototype.handle=function(f){var h=this;if(!this.resumed){if(f.type===i.FrameTypes.RESUME_OK){this.resumed=!0,this.delegate.resume(f,this.outbound,this.closeable);return}else this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,code:i.ErrorCodes.CONNECTION_ERROR,message:"Incomplete RESUME handshake. Unexpected frame ".concat(f.type," received"),flags:i.Flags.NONE}),this.closeable.close(),this.closeable.onClose(function(){return h.delegate.close(new a.RSocketError(i.ErrorCodes.CONNECTION_ERROR,"Incomplete RESUME handshake. Unexpected frame ".concat(f.type," received")))});return}this.delegate.handle(f)},d}();r.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer=c}(Ri)),Ri}var Ne={},br={},et={},Oo=T&&T.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(et,"__esModule",{value:!0});et.fragmentWithRequestN=et.fragment=et.isFragmentable=void 0;var G=Ye;function Tf(r,e,t){return e===0?!1:r.data.byteLength+(r.metadata?r.metadata.byteLength+G.Lengths.METADATA:0)+(t==G.FrameTypes.REQUEST_STREAM||t==G.FrameTypes.REQUEST_CHANNEL?G.Lengths.REQUEST:0)>e}et.isFragmentable=Tf;function Af(r,e,t,n,i){var s,a,o,l,u,c,d,d,f,h,v,v,g,m;return i===void 0&&(i=!1),Oo(this,function(E){switch(E.label){case 0:return s=(m=(g=e.data)===null||g===void 0?void 0:g.byteLength)!==null&&m!==void 0?m:0,a=n!==G.FrameTypes.PAYLOAD,o=t,e.metadata?(u=e.metadata.byteLength,u!==0?[3,1]:(o-=G.Lengths.METADATA,l=I.Buffer.allocUnsafe(0),[3,6])):[3,6];case 1:return c=0,a?(o-=G.Lengths.METADATA,d=Math.min(u,c+o),l=e.metadata.slice(c,d),o-=l.byteLength,c=d,o!==0?[3,3]:(a=!1,[4,{type:n,flags:G.Flags.FOLLOWS|G.Flags.METADATA,data:void 0,metadata:l,streamId:r}])):[3,3];case 2:E.sent(),l=void 0,o=t,E.label=3;case 3:return c<u?(o-=G.Lengths.METADATA,d=Math.min(u,c+o),l=e.metadata.slice(c,d),o-=l.byteLength,c=d,o===0||s===0?[4,{type:G.FrameTypes.PAYLOAD,flags:G.Flags.NEXT|G.Flags.METADATA|(c===u&&i&&s===0?G.Flags.COMPLETE:G.Flags.FOLLOWS),data:void 0,metadata:l,streamId:r}]:[3,5]):[3,6];case 4:E.sent(),l=void 0,o=t,E.label=5;case 5:return[3,3];case 6:return f=0,a?(v=Math.min(s,f+o),h=e.data.slice(f,v),o-=h.byteLength,f=v,[4,{type:n,flags:G.Flags.FOLLOWS|(l?G.Flags.METADATA:G.Flags.NONE),data:h,metadata:l,streamId:r}]):[3,8];case 7:E.sent(),l=void 0,h=void 0,o=t,E.label=8;case 8:return f<s?(v=Math.min(s,f+o),h=e.data.slice(f,v),o-=h.byteLength,f=v,[4,{type:G.FrameTypes.PAYLOAD,flags:f===s?(i?G.Flags.COMPLETE:G.Flags.NONE)|G.Flags.NEXT|(l?G.Flags.METADATA:0):G.Flags.FOLLOWS|G.Flags.NEXT|(l?G.Flags.METADATA:0),data:h,metadata:l,streamId:r}]):[3,10];case 9:return E.sent(),l=void 0,h=void 0,o=t,[3,8];case 10:return[2]}})}et.fragment=Af;function Ff(r,e,t,n,i,s){var a,o,l,u,c,d,f,f,h,v,g,g,m,E;return s===void 0&&(s=!1),Oo(this,function(w){switch(w.label){case 0:return a=(E=(m=e.data)===null||m===void 0?void 0:m.byteLength)!==null&&E!==void 0?E:0,o=!0,l=t,e.metadata?(c=e.metadata.byteLength,c!==0?[3,1]:(l-=G.Lengths.METADATA,u=I.Buffer.allocUnsafe(0),[3,6])):[3,6];case 1:return d=0,o?(l-=G.Lengths.METADATA+G.Lengths.REQUEST,f=Math.min(c,d+l),u=e.metadata.slice(d,f),l-=u.byteLength,d=f,l!==0?[3,3]:(o=!1,[4,{type:n,flags:G.Flags.FOLLOWS|G.Flags.METADATA,data:void 0,requestN:i,metadata:u,streamId:r}])):[3,3];case 2:w.sent(),u=void 0,l=t,w.label=3;case 3:return d<c?(l-=G.Lengths.METADATA,f=Math.min(c,d+l),u=e.metadata.slice(d,f),l-=u.byteLength,d=f,l===0||a===0?[4,{type:G.FrameTypes.PAYLOAD,flags:G.Flags.NEXT|G.Flags.METADATA|(d===c&&s&&a===0?G.Flags.COMPLETE:G.Flags.FOLLOWS),data:void 0,metadata:u,streamId:r}]:[3,5]):[3,6];case 4:w.sent(),u=void 0,l=t,w.label=5;case 5:return[3,3];case 6:return h=0,o?(l-=G.Lengths.REQUEST,g=Math.min(a,h+l),v=e.data.slice(h,g),l-=v.byteLength,h=g,[4,{type:n,flags:G.Flags.FOLLOWS|(u?G.Flags.METADATA:G.Flags.NONE),data:v,requestN:i,metadata:u,streamId:r}]):[3,8];case 7:w.sent(),u=void 0,v=void 0,l=t,w.label=8;case 8:return h<a?(g=Math.min(a,h+l),v=e.data.slice(h,g),l-=v.byteLength,h=g,[4,{type:G.FrameTypes.PAYLOAD,flags:h===a?(s?G.Flags.COMPLETE:G.Flags.NONE)|G.Flags.NEXT|(u?G.Flags.METADATA:0):G.Flags.FOLLOWS|G.Flags.NEXT|(u?G.Flags.METADATA:0),data:v,metadata:u,streamId:r}]):[3,10];case 9:return w.sent(),u=void 0,v=void 0,l=t,[3,8];case 10:return[2]}})}et.fragmentWithRequestN=Ff;var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.cancel=tt.reassemble=tt.add=void 0;function xf(r,e,t){return r.hasFragments?(r.data=r.data?I.Buffer.concat([r.data,e]):e,r.metadata&&t&&(r.metadata=I.Buffer.concat([r.metadata,t])),!0):(r.hasFragments=!0,r.data=e,t&&(r.metadata=t),!0)}tt.add=xf;function If(r,e,t){r.hasFragments=!1;var n=r.data?I.Buffer.concat([r.data,e]):e;if(r.data=void 0,r.metadata){var i=t?I.Buffer.concat([r.metadata,t]):r.metadata;return r.metadata=void 0,{data:n,metadata:i}}return{data:n}}tt.reassemble=If;function Cf(r){r.hasFragments=!1,r.data=void 0,r.metadata=void 0}tt.cancel=Cf;var Of=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Uf=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Nf=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Of(e,r,t);return Uf(e,r),e},Hi=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(br,"__esModule",{value:!0});br.RequestChannelResponderStream=br.RequestChannelRequesterStream=void 0;var ke=qt,lr=et,O=Ye,vt=Nf(tt),Df=function(){function r(e,t,n,i,s,a){this.payload=e,this.isComplete=t,this.receiver=n,this.fragmentSize=i,this.initialRequestN=s,this.leaseManager=a,this.streamType=O.FrameTypes.REQUEST_CHANNEL}return r.prototype.handleReady=function(e,t){var n,i;if(this.outboundDone)return!1;this.streamId=e,this.stream=t,t.connect(this);var s=this.isComplete;if(s&&(this.outboundDone=s),(0,lr.isFragmentable)(this.payload,this.fragmentSize,O.FrameTypes.REQUEST_CHANNEL))try{for(var a=Hi((0,lr.fragmentWithRequestN)(e,this.payload,this.fragmentSize,O.FrameTypes.REQUEST_CHANNEL,this.initialRequestN,s)),o=a.next();!o.done;o=a.next()){var l=o.value;this.stream.send(l)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}else this.stream.send({type:O.FrameTypes.REQUEST_CHANNEL,data:this.payload.data,metadata:this.payload.metadata,requestN:this.initialRequestN,flags:(this.payload.metadata!==void 0?O.Flags.METADATA:O.Flags.NONE)|(s?O.Flags.COMPLETE:O.Flags.NONE),streamId:e});return this.hasExtension&&this.stream.send({type:O.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.inboundDone||(this.inboundDone=!0,this.outboundDone=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case O.FrameTypes.PAYLOAD:{var i=O.Flags.hasComplete(e.flags),s=O.Flags.hasNext(e.flags);if(i||!O.Flags.hasFollows(e.flags)){if(i&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this),!s)){this.receiver.onComplete();return}var a=this.hasFragments?vt.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,i);return}if(vt.add(this,e.data,e.metadata))return;t="Unexpected frame size";break}case O.FrameTypes.CANCEL:{if(this.outboundDone)return;this.outboundDone=!0,this.inboundDone&&this.stream.disconnect(this),this.receiver.cancel();return}case O.FrameTypes.REQUEST_N:{if(this.outboundDone)return;if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.request(e.requestN);return}case O.FrameTypes.ERROR:{var o=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,this.stream.disconnect(this),vt.cancel(this),o||this.receiver.cancel(),this.receiver.onError(new ke.RSocketError(e.code,e.message));return}case O.FrameTypes.EXT:this.receiver.onExtension(e.extendedType,e.extendedContent,O.Flags.hasIgnore(e.flags));return;default:t="Unexpected frame type [".concat(n,"]")}this.close(new ke.RSocketError(ke.ErrorCodes.CANCELED,t)),this.stream.send({type:O.FrameTypes.CANCEL,streamId:this.streamId,flags:O.Flags.NONE}),this.stream.disconnect(this)},r.prototype.request=function(e){if(!this.inboundDone){if(!this.streamId){this.initialRequestN+=e;return}this.stream.send({type:O.FrameTypes.REQUEST_N,flags:O.Flags.NONE,requestN:e,streamId:this.streamId})}},r.prototype.cancel=function(){var e,t=this.inboundDone,n=this.outboundDone;if(!(t&&n)){if(this.inboundDone=!0,this.outboundDone=!0,n||this.receiver.cancel(),!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:t?O.FrameTypes.ERROR:O.FrameTypes.CANCEL,flags:O.Flags.NONE,streamId:this.streamId,code:ke.ErrorCodes.CANCELED,message:"Cancelled"}),this.stream.disconnect(this),vt.cancel(this)}},r.prototype.onNext=function(e,t){var n,i;if(!this.outboundDone)if(t&&(this.outboundDone=!0,this.inboundDone&&this.stream.disconnect(this)),(0,lr.isFragmentable)(e,this.fragmentSize,O.FrameTypes.PAYLOAD))try{for(var s=Hi((0,lr.fragment)(this.streamId,e,this.fragmentSize,O.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:O.FrameTypes.PAYLOAD,streamId:this.streamId,flags:O.Flags.NEXT|(e.metadata?O.Flags.METADATA:O.Flags.NONE)|(t?O.Flags.COMPLETE:O.Flags.NONE),data:e.data,metadata:e.metadata})},r.prototype.onComplete=function(){if(!this.streamId){this.isComplete=!0;return}this.outboundDone||(this.outboundDone=!0,this.stream.send({type:O.FrameTypes.PAYLOAD,streamId:this.streamId,flags:O.Flags.COMPLETE,data:null,metadata:null}),this.inboundDone&&this.stream.disconnect(this))},r.prototype.onError=function(e){if(!this.outboundDone){var t=this.inboundDone;this.outboundDone=!0,this.inboundDone=!0,this.stream.send({type:O.FrameTypes.ERROR,streamId:this.streamId,flags:O.Flags.NONE,code:e instanceof ke.RSocketError?e.code:ke.ErrorCodes.APPLICATION_ERROR,message:e.message}),this.stream.disconnect(this),t||this.receiver.onError(e)}},r.prototype.onExtension=function(e,t,n){if(!this.outboundDone){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?O.Flags.IGNORE:O.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:O.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?O.Flags.IGNORE:O.Flags.NONE})}},r.prototype.close=function(e){if(!(this.inboundDone&&this.outboundDone)){var t=this.inboundDone,n=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,vt.cancel(this),n||this.receiver.cancel(),t||(e?this.receiver.onError(e):this.receiver.onComplete())}},r}();br.RequestChannelRequesterStream=Df;var Pf=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=O.FrameTypes.REQUEST_CHANNEL,t.connect(this),O.Flags.hasFollows(s.flags)){vt.add(this,s.data,s.metadata),this.initialRequestN=s.requestN,this.isComplete=O.Flags.hasComplete(s.flags);return}var a={data:s.data,metadata:s.metadata},o=O.Flags.hasComplete(s.flags);this.inboundDone=o;try{this.receiver=i(a,s.requestN,o,this),this.outboundDone&&this.defferedError&&this.receiver.onError(this.defferedError)}catch(l){this.outboundDone&&!this.inboundDone?this.cancel():this.inboundDone=!0,this.onError(l)}}return r.prototype.handle=function(e){var t,n=e.type;switch(n){case O.FrameTypes.PAYLOAD:{if(O.Flags.hasFollows(e.flags)){if(vt.add(this,e.data,e.metadata))return;t="Unexpected frame size";break}var i=this.hasFragments?vt.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata},s=O.Flags.hasComplete(e.flags);if(this.receiver){if(s&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this),!O.Flags.hasNext(e.flags))){this.receiver.onComplete();return}this.receiver.onNext(i,s)}else{var a=this.isComplete||s;a&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this));try{this.receiver=this.handler(i,this.initialRequestN,a,this),this.outboundDone&&this.defferedError}catch(u){this.outboundDone&&!this.inboundDone?this.cancel():this.inboundDone=!0,this.onError(u)}}return}case O.FrameTypes.REQUEST_N:{if(!this.receiver||this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.request(e.requestN);return}case O.FrameTypes.ERROR:case O.FrameTypes.CANCEL:{var a=this.inboundDone,o=this.outboundDone;if(this.inboundDone=!0,this.outboundDone=!0,this.stream.disconnect(this),vt.cancel(this),!this.receiver)return;if(o||this.receiver.cancel(),!a){var l=n===O.FrameTypes.CANCEL?new ke.RSocketError(ke.ErrorCodes.CANCELED,"Cancelled"):new ke.RSocketError(e.code,e.message);this.receiver.onError(l)}return}case O.FrameTypes.EXT:{if(!this.receiver||this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,O.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.stream.send({type:O.FrameTypes.ERROR,flags:O.Flags.NONE,code:ke.ErrorCodes.CANCELED,message:t,streamId:this.streamId}),this.stream.disconnect(this),this.close(new ke.RSocketError(ke.ErrorCodes.CANCELED,t))},r.prototype.onError=function(e){if(this.outboundDone){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}var t=this.inboundDone;this.outboundDone=!0,this.inboundDone=!0,this.stream.send({type:O.FrameTypes.ERROR,flags:O.Flags.NONE,code:e instanceof ke.RSocketError?e.code:ke.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this),t||(this.receiver?this.receiver.onError(e):this.defferedError=e)},r.prototype.onNext=function(e,t){var n,i;if(!this.outboundDone){if(t&&(this.outboundDone=!0),(0,lr.isFragmentable)(e,this.fragmentSize,O.FrameTypes.PAYLOAD))try{for(var s=Hi((0,lr.fragment)(this.streamId,e,this.fragmentSize,O.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:O.FrameTypes.PAYLOAD,flags:O.Flags.NEXT|(t?O.Flags.COMPLETE:O.Flags.NONE)|(e.metadata?O.Flags.METADATA:O.Flags.NONE),data:e.data,metadata:e.metadata,streamId:this.streamId});t&&this.inboundDone&&this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.outboundDone||(this.outboundDone=!0,this.stream.send({type:O.FrameTypes.PAYLOAD,flags:O.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.inboundDone&&this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.outboundDone&&this.inboundDone||this.stream.send({type:O.FrameTypes.EXT,streamId:this.streamId,flags:n?O.Flags.IGNORE:O.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.request=function(e){this.inboundDone||this.stream.send({type:O.FrameTypes.REQUEST_N,flags:O.Flags.NONE,streamId:this.streamId,requestN:e})},r.prototype.cancel=function(){this.inboundDone||(this.inboundDone=!0,this.stream.send({type:O.FrameTypes.CANCEL,flags:O.Flags.NONE,streamId:this.streamId}),this.outboundDone&&this.stream.disconnect(this))},r.prototype.close=function(e){if(this.inboundDone&&this.outboundDone){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}var t=this.inboundDone,n=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,vt.cancel(this);var i=this.receiver;i&&(n||i.cancel(),t||(e?i.onError(e):i.onComplete()))},r}();br.RequestChannelResponderStream=Pf;var _r={},kf=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Lf=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Mf=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kf(e,r,t);return Lf(e,r),e},Bf=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(_r,"__esModule",{value:!0});_r.RequestFnfResponderStream=_r.RequestFnFRequesterStream=void 0;var Rn=qt,aa=et,Le=Ye,Qr=Mf(tt),qf=function(){function r(e,t,n,i){this.payload=e,this.receiver=t,this.fragmentSize=n,this.leaseManager=i,this.streamType=Le.FrameTypes.REQUEST_FNF}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,(0,aa.isFragmentable)(this.payload,this.fragmentSize,Le.FrameTypes.REQUEST_FNF))try{for(var s=Bf((0,aa.fragment)(e,this.payload,this.fragmentSize,Le.FrameTypes.REQUEST_FNF)),a=s.next();!a.done;a=s.next()){var o=a.value;t.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else t.send({type:Le.FrameTypes.REQUEST_FNF,data:this.payload.data,metadata:this.payload.metadata,flags:this.payload.metadata?Le.Flags.METADATA:0,streamId:e});return this.done=!0,this.receiver.onComplete(),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.cancel=function(){var e;this.done||(this.done=!0,(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this))},r.prototype.handle=function(e){if(e.type==Le.FrameTypes.ERROR){this.close(new Rn.RSocketError(e.code,e.message));return}this.close(new Rn.RSocketError(Rn.ErrorCodes.CANCELED,"Received invalid frame"))},r.prototype.close=function(e){if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}e?this.receiver.onError(e):this.receiver.onComplete()},r}();_r.RequestFnFRequesterStream=qf;var zf=function(){function r(e,t,n,i){if(this.streamId=e,this.stream=t,this.handler=n,this.streamType=Le.FrameTypes.REQUEST_FNF,Le.Flags.hasFollows(i.flags)){Qr.add(this,i.data,i.metadata),t.connect(this);return}var s={data:i.data,metadata:i.metadata};try{this.cancellable=n(s,this)}catch{}}return r.prototype.handle=function(e){var t;if(e.type==Le.FrameTypes.PAYLOAD)if(Le.Flags.hasFollows(e.flags)){if(Qr.add(this,e.data,e.metadata))return;t="Unexpected fragment size"}else{this.stream.disconnect(this);var n=Qr.reassemble(this,e.data,e.metadata);try{this.cancellable=this.handler(n,this)}catch{}return}else t="Unexpected frame type [".concat(e.type,"]");this.done=!0,e.type!=Le.FrameTypes.CANCEL&&e.type!=Le.FrameTypes.ERROR&&this.stream.send({type:Le.FrameTypes.ERROR,streamId:this.streamId,flags:Le.Flags.NONE,code:Rn.ErrorCodes.CANCELED,message:t}),this.stream.disconnect(this),Qr.cancel(this)},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,Qr.cancel(this),(t=this.cancellable)===null||t===void 0||t.cancel()},r.prototype.onError=function(e){},r.prototype.onComplete=function(){},r}();_r.RequestFnfResponderStream=zf;var wr={},Hf=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Gf=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vf=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hf(e,r,t);return Gf(e,r),e},Uo=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(wr,"__esModule",{value:!0});wr.RequestResponseResponderStream=wr.RequestResponseRequesterStream=void 0;var pr=qt,Un=et,Y=Ye,gt=Vf(tt),Qf=function(){function r(e,t,n,i){this.payload=e,this.receiver=t,this.fragmentSize=n,this.leaseManager=i,this.streamType=Y.FrameTypes.REQUEST_RESPONSE}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,this.stream=t,t.connect(this),(0,Un.isFragmentable)(this.payload,this.fragmentSize,Y.FrameTypes.REQUEST_RESPONSE))try{for(var s=Uo((0,Un.fragment)(e,this.payload,this.fragmentSize,Y.FrameTypes.REQUEST_RESPONSE)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:Y.FrameTypes.REQUEST_RESPONSE,data:this.payload.data,metadata:this.payload.metadata,flags:this.payload.metadata?Y.Flags.METADATA:0,streamId:e});return this.hasExtension&&this.stream.send({type:Y.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case Y.FrameTypes.PAYLOAD:{var i=Y.Flags.hasComplete(e.flags),s=Y.Flags.hasNext(e.flags);if(i||!Y.Flags.hasFollows(e.flags)){if(this.done=!0,this.stream.disconnect(this),!s){this.receiver.onComplete();return}var a=this.hasFragments?gt.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,!0);return}if(!gt.add(this,e.data,e.metadata)){t="Unexpected fragment size";break}return}case Y.FrameTypes.ERROR:{this.done=!0,this.stream.disconnect(this),gt.cancel(this),this.receiver.onError(new pr.RSocketError(e.code,e.message));return}case Y.FrameTypes.EXT:{if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,Y.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.close(new pr.RSocketError(pr.ErrorCodes.CANCELED,t)),this.stream.send({type:Y.FrameTypes.CANCEL,streamId:this.streamId,flags:Y.Flags.NONE}),this.stream.disconnect(this)},r.prototype.cancel=function(){var e;if(!this.done){if(this.done=!0,!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:Y.FrameTypes.CANCEL,flags:Y.Flags.NONE,streamId:this.streamId}),this.stream.disconnect(this),gt.cancel(this)}},r.prototype.onExtension=function(e,t,n){if(!this.done){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?Y.Flags.IGNORE:Y.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:Y.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?Y.Flags.IGNORE:Y.Flags.NONE})}},r.prototype.close=function(e){this.done||(this.done=!0,gt.cancel(this),e?this.receiver.onError(e):this.receiver.onComplete())},r}();wr.RequestResponseRequesterStream=Qf;var Yf=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=Y.FrameTypes.REQUEST_RESPONSE,t.connect(this),Y.Flags.hasFollows(s.flags)){gt.add(this,s.data,s.metadata);return}var a={data:s.data,metadata:s.metadata};try{this.receiver=i(a,this)}catch(o){this.onError(o)}}return r.prototype.handle=function(e){var t,n;if(!this.receiver||this.hasFragments)if(e.type===Y.FrameTypes.PAYLOAD)if(Y.Flags.hasFollows(e.flags)){if(gt.add(this,e.data,e.metadata))return;n="Unexpected fragment size"}else{var i=gt.reassemble(this,e.data,e.metadata);try{this.receiver=this.handler(i,this)}catch(s){this.onError(s)}return}else n="Unexpected frame type [".concat(e.type,"] during reassembly");else if(e.type===Y.FrameTypes.EXT){this.receiver.onExtension(e.extendedType,e.extendedContent,Y.Flags.hasIgnore(e.flags));return}else n="Unexpected frame type [".concat(e.type,"]");this.done=!0,(t=this.receiver)===null||t===void 0||t.cancel(),e.type!==Y.FrameTypes.CANCEL&&e.type!==Y.FrameTypes.ERROR&&this.stream.send({type:Y.FrameTypes.ERROR,flags:Y.Flags.NONE,code:pr.ErrorCodes.CANCELED,message:n,streamId:this.streamId}),this.stream.disconnect(this),gt.cancel(this)},r.prototype.onError=function(e){if(this.done){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,this.stream.send({type:Y.FrameTypes.ERROR,flags:Y.Flags.NONE,code:e instanceof pr.RSocketError?e.code:pr.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onNext=function(e,t){var n,i;if(!this.done){if(this.done=!0,(0,Un.isFragmentable)(e,this.fragmentSize,Y.FrameTypes.PAYLOAD))try{for(var s=Uo((0,Un.fragment)(this.streamId,e,this.fragmentSize,Y.FrameTypes.PAYLOAD,!0)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:Y.FrameTypes.PAYLOAD,flags:Y.Flags.NEXT|Y.Flags.COMPLETE|(e.metadata?Y.Flags.METADATA:0),data:e.data,metadata:e.metadata,streamId:this.streamId});this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.done||(this.done=!0,this.stream.send({type:Y.FrameTypes.PAYLOAD,flags:Y.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.done||this.stream.send({type:Y.FrameTypes.EXT,streamId:this.streamId,flags:n?Y.Flags.IGNORE:Y.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}gt.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel()},r}();wr.RequestResponseResponderStream=Yf;var Sr={},Xf=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$f=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jf=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xf(e,r,t);return $f(e,r),e},No=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.RequestStreamResponderStream=Sr.RequestStreamRequesterStream=void 0;var mr=qt,Nn=et,z=Ye,yt=jf(tt),Jf=function(){function r(e,t,n,i,s){this.payload=e,this.receiver=t,this.fragmentSize=n,this.initialRequestN=i,this.leaseManager=s,this.streamType=z.FrameTypes.REQUEST_STREAM}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,this.stream=t,t.connect(this),(0,Nn.isFragmentable)(this.payload,this.fragmentSize,z.FrameTypes.REQUEST_STREAM))try{for(var s=No((0,Nn.fragmentWithRequestN)(e,this.payload,this.fragmentSize,z.FrameTypes.REQUEST_STREAM,this.initialRequestN)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:z.FrameTypes.REQUEST_STREAM,data:this.payload.data,metadata:this.payload.metadata,requestN:this.initialRequestN,flags:this.payload.metadata!==void 0?z.Flags.METADATA:0,streamId:e});return this.hasExtension&&this.stream.send({type:z.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case z.FrameTypes.PAYLOAD:{var i=z.Flags.hasComplete(e.flags),s=z.Flags.hasNext(e.flags);if(i||!z.Flags.hasFollows(e.flags)){if(i&&(this.done=!0,this.stream.disconnect(this),!s)){this.receiver.onComplete();return}var a=this.hasFragments?yt.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,i);return}if(!yt.add(this,e.data,e.metadata)){t="Unexpected fragment size";break}return}case z.FrameTypes.ERROR:{this.done=!0,this.stream.disconnect(this),yt.cancel(this),this.receiver.onError(new mr.RSocketError(e.code,e.message));return}case z.FrameTypes.EXT:{if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,z.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.close(new mr.RSocketError(mr.ErrorCodes.CANCELED,t)),this.stream.send({type:z.FrameTypes.CANCEL,streamId:this.streamId,flags:z.Flags.NONE}),this.stream.disconnect(this)},r.prototype.request=function(e){if(!this.done){if(!this.streamId){this.initialRequestN+=e;return}this.stream.send({type:z.FrameTypes.REQUEST_N,flags:z.Flags.NONE,requestN:e,streamId:this.streamId})}},r.prototype.cancel=function(){var e;if(!this.done){if(this.done=!0,!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:z.FrameTypes.CANCEL,flags:z.Flags.NONE,streamId:this.streamId}),this.stream.disconnect(this),yt.cancel(this)}},r.prototype.onExtension=function(e,t,n){if(!this.done){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?z.Flags.IGNORE:z.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:z.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?z.Flags.IGNORE:z.Flags.NONE})}},r.prototype.close=function(e){this.done||(this.done=!0,yt.cancel(this),e?this.receiver.onError(e):this.receiver.onComplete())},r}();Sr.RequestStreamRequesterStream=Jf;var Zf=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=z.FrameTypes.REQUEST_STREAM,t.connect(this),z.Flags.hasFollows(s.flags)){this.initialRequestN=s.requestN,yt.add(this,s.data,s.metadata);return}var a={data:s.data,metadata:s.metadata};try{this.receiver=i(a,s.requestN,this)}catch(o){this.onError(o)}}return r.prototype.handle=function(e){var t,n;if(!this.receiver||this.hasFragments)if(e.type===z.FrameTypes.PAYLOAD)if(z.Flags.hasFollows(e.flags)){if(yt.add(this,e.data,e.metadata))return;n="Unexpected frame size"}else{var i=yt.reassemble(this,e.data,e.metadata);try{this.receiver=this.handler(i,this.initialRequestN,this)}catch(s){this.onError(s)}return}else n="Unexpected frame type [".concat(e.type,"] during reassembly");else if(e.type===z.FrameTypes.REQUEST_N){this.receiver.request(e.requestN);return}else if(e.type===z.FrameTypes.EXT){this.receiver.onExtension(e.extendedType,e.extendedContent,z.Flags.hasIgnore(e.flags));return}else n="Unexpected frame type [".concat(e.type,"]");this.done=!0,yt.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel(),e.type!==z.FrameTypes.CANCEL&&e.type!==z.FrameTypes.ERROR&&this.stream.send({type:z.FrameTypes.ERROR,flags:z.Flags.NONE,code:mr.ErrorCodes.CANCELED,message:n,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onError=function(e){if(this.done){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,this.stream.send({type:z.FrameTypes.ERROR,flags:z.Flags.NONE,code:e instanceof mr.RSocketError?e.code:mr.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onNext=function(e,t){var n,i;if(!this.done){if(t&&(this.done=!0),(0,Nn.isFragmentable)(e,this.fragmentSize,z.FrameTypes.PAYLOAD))try{for(var s=No((0,Nn.fragment)(this.streamId,e,this.fragmentSize,z.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:z.FrameTypes.PAYLOAD,flags:z.Flags.NEXT|(t?z.Flags.COMPLETE:z.Flags.NONE)|(e.metadata?z.Flags.METADATA:z.Flags.NONE),data:e.data,metadata:e.metadata,streamId:this.streamId});t&&this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.done||(this.done=!0,this.stream.send({type:z.FrameTypes.PAYLOAD,flags:z.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.done||this.stream.send({type:z.FrameTypes.EXT,streamId:this.streamId,flags:n?z.Flags.IGNORE:z.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}yt.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel()},r}();Sr.RequestStreamResponderStream=Zf;Object.defineProperty(Ne,"__esModule",{value:!0});Ne.KeepAliveSender=Ne.KeepAliveHandler=Ne.DefaultConnectionFrameHandler=Ne.DefaultStreamRequestHandler=Ne.LeaseHandler=Ne.RSocketRequester=void 0;var nn=qt,Se=Ye,Do=br,Po=_r,ko=wr,Lo=Sr,Wf=function(){function r(e,t,n){this.connection=e,this.fragmentSize=t,this.leaseManager=n}return r.prototype.fireAndForget=function(e,t){var n=new Po.RequestFnFRequesterStream(e,t,this.fragmentSize,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(n):this.connection.multiplexerDemultiplexer.createRequestStream(n),n},r.prototype.requestResponse=function(e,t){var n=new ko.RequestResponseRequesterStream(e,t,this.fragmentSize,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(n):this.connection.multiplexerDemultiplexer.createRequestStream(n),n},r.prototype.requestStream=function(e,t,n){var i=new Lo.RequestStreamRequesterStream(e,n,this.fragmentSize,t,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(i):this.connection.multiplexerDemultiplexer.createRequestStream(i),i},r.prototype.requestChannel=function(e,t,n,i){var s=new Do.RequestChannelRequesterStream(e,n,i,this.fragmentSize,t,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(s):this.connection.multiplexerDemultiplexer.createRequestStream(s),s},r.prototype.metadataPush=function(e,t){throw new Error("Method not implemented.")},r.prototype.close=function(e){this.connection.close(e)},r.prototype.onClose=function(e){this.connection.onClose(e)},r}();Ne.RSocketRequester=Wf;var Kf=function(){function r(e,t){this.maxPendingRequests=e,this.multiplexer=t,this.pendingRequests=[],this.expirationTime=0,this.availableLease=0}return r.prototype.handle=function(e){for(this.expirationTime=e.ttl+Date.now(),this.availableLease=e.requestCount;this.availableLease>0&&this.pendingRequests.length>0;){var t=this.pendingRequests.shift();this.availableLease--,this.multiplexer.createRequestStream(t)}},r.prototype.requestLease=function(e){var t=this.availableLease;if(t>0&&Date.now()<this.expirationTime){this.availableLease=t-1,this.multiplexer.createRequestStream(e);return}if(this.pendingRequests.length>=this.maxPendingRequests){e.handleReject(new nn.RSocketError(nn.ErrorCodes.REJECTED,"No available lease given"));return}this.pendingRequests.push(e)},r.prototype.cancelRequest=function(e){var t=this.pendingRequests.indexOf(e);t>-1&&this.pendingRequests.splice(t,1)},r}();Ne.LeaseHandler=Kf;var eh=function(){function r(e,t){this.rsocket=e,this.fragmentSize=t}return r.prototype.handle=function(e,t){switch(e.type){case Se.FrameTypes.REQUEST_FNF:this.rsocket.fireAndForget&&new Po.RequestFnfResponderStream(e.streamId,t,this.rsocket.fireAndForget.bind(this.rsocket),e);return;case Se.FrameTypes.REQUEST_RESPONSE:if(this.rsocket.requestResponse){new ko.RequestResponseResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestResponse.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return;case Se.FrameTypes.REQUEST_STREAM:if(this.rsocket.requestStream){new Lo.RequestStreamResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestStream.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return;case Se.FrameTypes.REQUEST_CHANNEL:if(this.rsocket.requestChannel){new Do.RequestChannelResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestChannel.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return}},r.prototype.rejectRequest=function(e,t){t.send({type:Se.FrameTypes.ERROR,streamId:e,flags:Se.Flags.NONE,code:nn.ErrorCodes.REJECTED,message:"No available handler found"})},r.prototype.close=function(){},r}();Ne.DefaultStreamRequestHandler=eh;var th=function(){function r(e,t,n,i,s){this.connection=e,this.keepAliveHandler=t,this.keepAliveSender=n,this.leaseHandler=i,this.rsocket=s}return r.prototype.handle=function(e){switch(e.type){case Se.FrameTypes.KEEPALIVE:this.keepAliveHandler.handle(e);return;case Se.FrameTypes.LEASE:if(this.leaseHandler){this.leaseHandler.handle(e);return}return;case Se.FrameTypes.ERROR:this.connection.close(new nn.RSocketError(e.code,e.message));return;case Se.FrameTypes.METADATA_PUSH:this.rsocket.metadataPush;return;default:this.connection.multiplexerDemultiplexer.connectionOutbound.send({type:Se.FrameTypes.ERROR,streamId:0,flags:Se.Flags.NONE,message:"Received unknown frame type",code:nn.ErrorCodes.CONNECTION_ERROR})}},r.prototype.pause=function(){var e;this.keepAliveHandler.pause(),(e=this.keepAliveSender)===null||e===void 0||e.pause()},r.prototype.resume=function(){var e;this.keepAliveHandler.start(),(e=this.keepAliveSender)===null||e===void 0||e.start()},r.prototype.close=function(e){var t;this.keepAliveHandler.close(),(t=this.rsocket.close)===null||t===void 0||t.call(this.rsocket,e)},r}();Ne.DefaultConnectionFrameHandler=th;var Vt;(function(r){r[r.Paused=0]="Paused",r[r.Running=1]="Running",r[r.Closed=2]="Closed"})(Vt||(Vt={}));var rh=function(){function r(e,t){this.connection=e,this.keepAliveTimeoutDuration=t,this.state=Vt.Paused,this.outbound=e.multiplexerDemultiplexer.connectionOutbound}return r.prototype.handle=function(e){this.keepAliveLastReceivedMillis=Date.now(),Se.Flags.hasRespond(e.flags)&&this.outbound.send({type:Se.FrameTypes.KEEPALIVE,streamId:0,data:e.data,flags:e.flags^Se.Flags.RESPOND,lastReceivedPosition:0})},r.prototype.start=function(){this.state===Vt.Paused&&(this.keepAliveLastReceivedMillis=Date.now(),this.state=Vt.Running,this.activeTimeout=setTimeout(this.timeoutCheck.bind(this),this.keepAliveTimeoutDuration))},r.prototype.pause=function(){this.state===Vt.Running&&(this.state=Vt.Paused,clearTimeout(this.activeTimeout))},r.prototype.close=function(){this.state=Vt.Closed,clearTimeout(this.activeTimeout)},r.prototype.timeoutCheck=function(){var e=Date.now(),t=e-this.keepAliveLastReceivedMillis;t>=this.keepAliveTimeoutDuration?this.connection.close(new Error("No keep-alive acks for ".concat(this.keepAliveTimeoutDuration," millis"))):this.activeTimeout=setTimeout(this.timeoutCheck.bind(this),Math.max(100,this.keepAliveTimeoutDuration-t))},r}();Ne.KeepAliveHandler=rh;var Qt;(function(r){r[r.Paused=0]="Paused",r[r.Running=1]="Running",r[r.Closed=2]="Closed"})(Qt||(Qt={}));var nh=function(){function r(e,t){this.outbound=e,this.keepAlivePeriodDuration=t,this.state=Qt.Paused}return r.prototype.sendKeepAlive=function(){this.outbound.send({type:Se.FrameTypes.KEEPALIVE,streamId:0,data:void 0,flags:Se.Flags.RESPOND,lastReceivedPosition:0})},r.prototype.start=function(){this.state===Qt.Paused&&(this.state=Qt.Running,this.activeInterval=setInterval(this.sendKeepAlive.bind(this),this.keepAlivePeriodDuration))},r.prototype.pause=function(){this.state===Qt.Running&&(this.state=Qt.Paused,clearInterval(this.activeInterval))},r.prototype.close=function(){this.state=Qt.Closed,clearInterval(this.activeInterval)},r}();Ne.KeepAliveSender=nh;var Yr={},oa;function Mo(){if(oa)return Yr;oa=1;var r=T&&T.__values||function(i){var s=typeof Symbol=="function"&&Symbol.iterator,a=s&&i[s],o=0;if(a)return a.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.FrameStore=void 0;var e=hs(),t=fs,n=function(){function i(){this.storedFrames=[],this._lastReceivedFramePosition=0,this._firstAvailableFramePosition=0,this._lastSentFramePosition=0}return Object.defineProperty(i.prototype,"lastReceivedFramePosition",{get:function(){return this._lastReceivedFramePosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"firstAvailableFramePosition",{get:function(){return this._firstAvailableFramePosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lastSentFramePosition",{get:function(){return this._lastSentFramePosition},enumerable:!1,configurable:!0}),i.prototype.store=function(s){this._lastSentFramePosition+=(0,t.sizeOfFrame)(s),this.storedFrames.push(s)},i.prototype.record=function(s){this._lastReceivedFramePosition+=(0,t.sizeOfFrame)(s)},i.prototype.dropTo=function(s){for(var a=s-this._firstAvailableFramePosition;a>0&&this.storedFrames.length>0;){var o=this.storedFrames.shift();a-=(0,t.sizeOfFrame)(o)}if(a!==0)throw new e.RSocketError(e.ErrorCodes.CONNECTION_ERROR,"State inconsistency. Expected bytes to drop ".concat(s-this._firstAvailableFramePosition," but actual ").concat(a));this._firstAvailableFramePosition=s},i.prototype.drain=function(s){var a,o;try{for(var l=r(this.storedFrames),u=l.next();!u.done;u=l.next()){var c=u.value;s(c)}}catch(d){a={error:d}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}},i}();return Yr.FrameStore=n,Yr}var la;function ih(){if(la)return Vr;la=1;var r=T&&T.__awaiter||function(o,l,u,c){function d(f){return f instanceof u?f:new u(function(h){h(f)})}return new(u||(u=Promise))(function(f,h){function v(E){try{m(c.next(E))}catch(w){h(w)}}function g(E){try{m(c.throw(E))}catch(w){h(w)}}function m(E){E.done?f(E.value):d(E.value).then(v,g)}m((c=c.apply(o,l||[])).next())})},e=T&&T.__generator||function(o,l){var u={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},c,d,f,h;return h={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function v(m){return function(E){return g([m,E])}}function g(m){if(c)throw new TypeError("Generator is already executing.");for(;u;)try{if(c=1,d&&(f=m[0]&2?d.return:m[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,m[1])).done)return f;switch(d=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return u.label++,{value:m[1],done:!1};case 5:u.label++,d=m[1],m=[0];continue;case 7:m=u.ops.pop(),u.trys.pop();continue;default:if(f=u.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){u=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){u.label=m[1];break}if(m[0]===6&&u.label<f[1]){u.label=f[1],f=m;break}if(f&&u.label<f[2]){u.label=f[2],u.ops.push(m);break}f[2]&&u.ops.pop(),u.trys.pop();continue}m=l.call(o,u)}catch(E){m=[6,E],d=0}finally{c=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.RSocketConnector=void 0;var t=Co(),n=Ye,i=Ne,s=Mo(),a=function(){function o(l){this.config=l}return o.prototype.connect=function(){var l,u,c,d,f,h,v,g,m,E,w,A,S,B,M,W,Z,P,oe,ne;return r(this,void 0,void 0,function(){var N,ie,re,q,me,Ae,_e,ye,Pe,Oe=this;return e(this,function(Fe){switch(Fe.label){case 0:return N=this.config,ie={type:n.FrameTypes.SETUP,dataMimeType:(u=(l=N.setup)===null||l===void 0?void 0:l.dataMimeType)!==null&&u!==void 0?u:"application/octet-stream",metadataMimeType:(d=(c=N.setup)===null||c===void 0?void 0:c.metadataMimeType)!==null&&d!==void 0?d:"application/octet-stream",keepAlive:(h=(f=N.setup)===null||f===void 0?void 0:f.keepAlive)!==null&&h!==void 0?h:6e4,lifetime:(g=(v=N.setup)===null||v===void 0?void 0:v.lifetime)!==null&&g!==void 0?g:3e5,metadata:(E=(m=N.setup)===null||m===void 0?void 0:m.payload)===null||E===void 0?void 0:E.metadata,data:(A=(w=N.setup)===null||w===void 0?void 0:w.payload)===null||A===void 0?void 0:A.data,resumeToken:(B=(S=N.resume)===null||S===void 0?void 0:S.tokenGenerator())!==null&&B!==void 0?B:null,streamId:0,majorVersion:1,minorVersion:0,flags:(!((W=(M=N.setup)===null||M===void 0?void 0:M.payload)===null||W===void 0)&&W.metadata?n.Flags.METADATA:n.Flags.NONE)|(N.lease?n.Flags.LEASE:n.Flags.NONE)|(N.resume?n.Flags.RESUME_ENABLE:n.Flags.NONE)},[4,N.transport.connect(function(D){return N.resume?new t.ResumableClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(-1),D,D,new s.FrameStore,ie.resumeToken.toString(),function(It,Ct){return r(Oe,void 0,void 0,function(){var Ot,$e,je;return e(this,function(Je){switch(Je.label){case 0:return Ot=function(Ze){return Ze.send({type:n.FrameTypes.RESUME,streamId:0,flags:n.Flags.NONE,clientPosition:Ct.firstAvailableFramePosition,serverPosition:Ct.lastReceivedFramePosition,majorVersion:ie.minorVersion,minorVersion:ie.majorVersion,resumeToken:ie.resumeToken}),new t.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer(Ze,Ze,It)},$e=-1,je=function(){return $e++,N.resume.reconnectFunction($e).then(function(){return N.transport.connect(Ot).catch(je)})},[4,je()];case 1:return Je.sent(),[2]}})})}):new t.ClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(-1),D,D)})];case 1:return re=Fe.sent(),q=new i.KeepAliveSender(re.multiplexerDemultiplexer.connectionOutbound,ie.keepAlive),me=new i.KeepAliveHandler(re,ie.lifetime),Ae=N.lease?new i.LeaseHandler((Z=N.lease.maxPendingRequests)!==null&&Z!==void 0?Z:256,re.multiplexerDemultiplexer):void 0,_e=(P=N.responder)!==null&&P!==void 0?P:{},ye=new i.DefaultConnectionFrameHandler(re,me,q,Ae,_e),Pe=new i.DefaultStreamRequestHandler(_e,0),re.onClose(function(D){q.close(),me.close(),ye.close(D)}),re.multiplexerDemultiplexer.connectionInbound(ye),re.multiplexerDemultiplexer.handleRequestStream(Pe),re.multiplexerDemultiplexer.connectionOutbound.send(ie),me.start(),q.start(),[2,new i.RSocketRequester(re,(ne=(oe=N.fragmentation)===null||oe===void 0?void 0:oe.maxOutboundFragmentSize)!==null&&ne!==void 0?ne:0,Ae)]}})})},o}();return Vr.RSocketConnector=a,Vr}var Xr={},ua;function sh(){if(ua)return Xr;ua=1;var r=T&&T.__awaiter||function(l,u,c,d){function f(h){return h instanceof c?h:new c(function(v){v(h)})}return new(c||(c=Promise))(function(h,v){function g(w){try{E(d.next(w))}catch(A){v(A)}}function m(w){try{E(d.throw(w))}catch(A){v(A)}}function E(w){w.done?h(w.value):f(w.value).then(g,m)}E((d=d.apply(l,u||[])).next())})},e=T&&T.__generator||function(l,u){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},d,f,h,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(E){return function(w){return m([E,w])}}function m(E){if(d)throw new TypeError("Generator is already executing.");for(;c;)try{if(d=1,f&&(h=E[0]&2?f.return:E[0]?f.throw||((h=f.return)&&h.call(f),0):f.next)&&!(h=h.call(f,E[1])).done)return h;switch(f=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,f=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){c.label=E[1];break}if(E[0]===6&&c.label<h[1]){c.label=h[1],h=E;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(E);break}h[2]&&c.ops.pop(),c.trys.pop();continue}E=u.call(l,c)}catch(w){E=[6,w],f=0}finally{d=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.RSocketServer=void 0;var t=Co(),n=qt,i=Ye,s=Ne,a=Mo(),o=function(){function l(u){var c,d;this.acceptor=u.acceptor,this.transport=u.transport,this.lease=u.lease,this.serverSideKeepAlive=u.serverSideKeepAlive,this.sessionStore=u.resume?{}:void 0,this.sessionTimeout=(d=(c=u.resume)===null||c===void 0?void 0:c.sessionTimeout)!==null&&d!==void 0?d:void 0}return l.prototype.bind=function(){return r(this,void 0,void 0,function(){var u=this;return e(this,function(c){switch(c.label){case 0:return[4,this.transport.bind(function(d,f){return r(u,void 0,void 0,function(){var h,v,v,g,m,E,w,A,S,B,M,W,Z,P,oe;return e(this,function(ne){switch(ne.label){case 0:switch(h=d.type,h){case i.FrameTypes.SETUP:return[3,1];case i.FrameTypes.RESUME:return[3,5]}return[3,6];case 1:return ne.trys.push([1,3,,4]),this.lease&&!i.Flags.hasLease(d.flags)?(v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"Lease has to be enabled"),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v),[2]):i.Flags.hasLease(d.flags)&&!this.lease?(v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"Lease has to be disabled"),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v),[2]):(g=i.Flags.hasLease(d.flags)?new s.LeaseHandler((W=this.lease.maxPendingRequests)!==null&&W!==void 0?W:256,f.multiplexerDemultiplexer):void 0,m=new s.RSocketRequester(f,(P=(Z=this.fragmentation)===null||Z===void 0?void 0:Z.maxOutboundFragmentSize)!==null&&P!==void 0?P:0,g),[4,this.acceptor.accept({data:d.data,dataMimeType:d.dataMimeType,metadata:d.metadata,metadataMimeType:d.metadataMimeType,flags:d.flags,keepAliveMaxLifetime:d.lifetime,keepAliveInterval:d.keepAlive,resumeToken:d.resumeToken},m)]);case 2:return E=ne.sent(),w=new s.KeepAliveHandler(f,d.lifetime),A=this.serverSideKeepAlive?new s.KeepAliveSender(f.multiplexerDemultiplexer.connectionOutbound,d.keepAlive):void 0,S=new s.DefaultConnectionFrameHandler(f,w,A,g,E),B=new s.DefaultStreamRequestHandler(E,0),f.onClose(function(N){A==null||A.close(),w.close(),S.close(N)}),f.multiplexerDemultiplexer.connectionInbound(S),f.multiplexerDemultiplexer.handleRequestStream(B),w.start(),A==null||A.start(),[3,4];case 3:return M=ne.sent(),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_SETUP,message:(oe=M.message)!==null&&oe!==void 0?oe:"",flags:i.Flags.NONE}),f.close(M instanceof n.RSocketError?M:new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,M.message)),[3,4];case 4:return[2];case 5:return[2];case 6:f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.UNSUPPORTED_SETUP,message:"Unsupported setup",flags:i.Flags.NONE}),f.close(new n.RSocketError(n.ErrorCodes.UNSUPPORTED_SETUP)),ne.label=7;case 7:return[2]}})})},function(d,f){if(d.type===i.FrameTypes.RESUME){if(u.sessionStore){var h=u.sessionStore[d.resumeToken.toString()];if(!h){f.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_RESUME,message:"No session found for the given resume token",flags:i.Flags.NONE}),f.close();return}return h.resume(d,f,f),h}f.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_RESUME,message:"Resume is not enabled",flags:i.Flags.NONE}),f.close();return}else if(d.type===i.FrameTypes.SETUP&&i.Flags.hasResume(d.flags)){if(!u.sessionStore){var v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"No resume support");f.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v);return}var g=new t.ResumableClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(0),f,f,new a.FrameStore,d.resumeToken.toString(),u.sessionStore,u.sessionTimeout);return u.sessionStore[d.resumeToken.toString()]=g,g}return new t.ClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(0),f,f)})];case 1:return[2,c.sent()]}})})},l}();return Xr.RSocketServer=o,Xr}var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});var ca;function hs(){return ca||(ca=1,function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,a){a===void 0&&(a=s),Object.defineProperty(n,a,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,a){a===void 0&&(a=s),n[a]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(fs,r),t(xo,r),t(cn,r),t(qt,r),t(Ye,r),t(Io,r),t(ih(),r),t(sh(),r),t(Bo,r)}(Si)),Si}var Ue=hs();Qn("wasmrs:connection:wasm");const Gt=Qn("wasmrs:connection:worker");class ah extends Ue.Deferred{constructor(t,n,i){super();F(this,"worker");F(this,"deserializer");F(this,"multiplexerDemultiplexer");F(this,"handleError",t=>{Gt("error in worker: %o",t),this.close(new Error(t.message))});F(this,"handleMessageError",t=>{Gt("error handling message from worker: %o",t),this.close(t.data)});F(this,"handleMessage",t=>{try{const n=I.Buffer.from(t.data),i=this.deserializer.deserializeFrame(n);Gt("got frame from worker %o",i),this.multiplexerDemultiplexer.handle(i)}catch(n){Gt("error handling message from worker: %s from: %o",n,t),this.close(n)}});this.worker=t,this.deserializer=n,t.addEventListener("error",this.handleError),t.addEventListener("message",this.handleMessage),t.addEventListener("messageerror",this.handleMessageError),this.multiplexerDemultiplexer=i(this)}get availability(){return this.done?0:1}close(t){if(Gt("closing worker connection"),this.done){super.close(t);return}this.worker.removeEventListener("error",this.handleError),this.worker.removeEventListener("message",this.handleMessage),this.worker.removeEventListener("messageerror",this.handleMessageError),this.worker.terminate(),super.close(t)}send(t){switch(t.type){case Ue.FrameTypes.REQUEST_RESPONSE:case Ue.FrameTypes.REQUEST_CHANNEL:case Ue.FrameTypes.REQUEST_FNF:case Ue.FrameTypes.REQUEST_STREAM:case Ue.FrameTypes.REQUEST_N:case Ue.FrameTypes.CANCEL:case Ue.FrameTypes.ERROR:case Ue.FrameTypes.PAYLOAD:break;case Ue.FrameTypes.KEEPALIVE:(t.flags&Ue.Flags.RESPOND)==Ue.Flags.RESPOND&&(t.flags^=Ue.Flags.RESPOND,this.multiplexerDemultiplexer.handle(t));return;default:Gt("ignoring frame",JSON.stringify(t));return}if(this.done){Gt("notice: got frame after connection complete");return}const n=Ue.serializeFrame(t);Gt("sending frame",JSON.stringify(t)),this.worker.postMessage(n)}}var oh=Worker;const lh=ts(oh);class uh{constructor(e){F(this,"factory");F(this,"module");F(this,"wasiOptions");if(this.module=e.module,this.wasiOptions=e.wasi,!e.workerFactory&&e.workerUrl)this.factory=async()=>{const t=e.workerUrl;return new lh(t,{type:"module"})};else if(e.workerFactory&&!e.workerUrl)this.factory=e.workerFactory;else throw new Error("WorkerClientTransport requires either a workerFactory or a workerOptions")}connect(e){return this.factory().then(t=>{const n=new Promise((s,a)=>{const o=u=>{ve("received setup response %o",u.data),t.removeEventListener("message",o),t.removeEventListener("error",l),t.removeEventListener("messageerror",l),s(t)},l=u=>{ve("failed to initialize worker %o",u),t.removeEventListener("message",o),t.removeEventListener("error",l),t.removeEventListener("messageerror",l),t.terminate(),a(u)};t.addEventListener("message",o),t.addEventListener("error",l),t.addEventListener("messageerror",l)}),i={module:this.module,wasi:this.wasiOptions};return t.postMessage(i),n.then(s=>(ve("starting worker connection"),new ah(s,new Ue.Deserializer,e)))})}}var Gi;(function(r){r.SnapshotPreview1="preview1"})(Gi||(Gi={}));const ch=0,dh=1,Pt=0,te=8,fh=20,Dn=28,hh=31,da=44,ps=63,Pn=2,kn=64;class sn{static read_bytes(e,t){const n=new sn;return n.buf=e.getUint32(t,!0),n.buf_len=e.getUint32(t+4,!0),n}static read_bytes_array(e,t,n){const i=[];for(let s=0;s<n;s++)i.push(sn.read_bytes(e,t+8*s));return i}}class an{static read_bytes(e,t){const n=new an;return n.buf=e.getUint32(t,!0),n.buf_len=e.getUint32(t+4,!0),n}static read_bytes_array(e,t,n){const i=[];for(let s=0;s<n;s++)i.push(an.read_bytes(e,t+8*s));return i}}const qo=0,zo=1,Yn=2,Vi=3,on=4;class ph{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,t){e.setBigUint64(t,this.d_next,!0),e.setBigUint64(t+8,this.d_ino,!0),e.setUint32(t+16,this.dir_name.length,!0),e.setUint8(t+20,this.d_type)}write_name_bytes(e,t,n){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,n)),t)}constructor(e,t,n){this.d_ino=1n;const i=new TextEncoder().encode(t);this.d_next=e,this.d_namlen=i.byteLength,this.d_type=n,this.dir_name=i}}const Ho=1;class ms{write_bytes(e,t){e.setUint8(t,this.fs_filetype),e.setUint16(t+2,this.fs_flags,!0),e.setBigUint64(t+8,this.fs_rights_base,!0),e.setBigUint64(t+16,this.fs_rights_inherited,!0)}constructor(e,t,n=0n){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=t,this.fs_rights_base=n}}const Ti=1,$r=2,fa=4,ha=8;class Xn{write_bytes(e,t){e.setBigUint64(t,this.dev,!0),e.setBigUint64(t+8,this.ino,!0),e.setUint8(t+16,this.filetype),e.setBigUint64(t+24,this.nlink,!0),e.setBigUint64(t+32,this.size,!0),e.setBigUint64(t+38,this.atim,!0),e.setBigUint64(t+46,this.mtim,!0),e.setBigUint64(t+52,this.ctim,!0)}constructor(e,t){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=e,this.size=t}}const mh=0;class vh{write_bytes(e,t){e.setUint32(t,this.pr_name_len,!0)}constructor(e){this.pr_name_len=e}}class vs{static dir(e){const t=new vs;return t.tag=mh,t.inner=new vh(e),t}write_bytes(e,t){e.setUint32(t,this.tag,!0),this.inner.write_bytes(e,t+4)}}let gh=class{enable(e){this.log=yh(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function yh(r,e){return r?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const Ee=new gh(!1);let Eh=class{start(e){this.inst=e,Ee.log("calling _start"),e.exports._start()}initialize(e){this.inst=e,e.exports._initialize?(Ee.log("calling _initialize"),e.exports._initialize()):Ee.log("no _initialize found")}constructor(e=[],t=[],n=[],i={}){this.args=[],this.env=[],this.fds=[],Ee.enable(i.debug),Ee.log("initializing wasi",{args:e,env:t,fds:n}),this.args=e,this.env=t,this.fds=n;const s=this;this.wasiImport={args_sizes_get(a,o){const l=new DataView(s.inst.exports.memory.buffer);l.setUint32(a,s.args.length,!0);let u=0;for(const c of s.args)u+=c.length+1;return l.setUint32(o,u,!0),Ee.log(l.getUint32(a,!0),l.getUint32(o,!0)),0},args_get(a,o){const l=new DataView(s.inst.exports.memory.buffer),u=new Uint8Array(s.inst.exports.memory.buffer),c=o;for(let d=0;d<s.args.length;d++){l.setUint32(a,o,!0),a+=4;const f=new TextEncoder().encode(s.args[d]);u.set(f,o),l.setUint8(o+f.length,0),o+=f.length+1}return Ee.enabled&&Ee.log(new TextDecoder("utf-8").decode(u.slice(c,o))),0},environ_sizes_get(a,o){const l=new DataView(s.inst.exports.memory.buffer);l.setUint32(a,s.env.length,!0);let u=0;for(const c of s.env)u+=c.length+1;return l.setUint32(o,u,!0),Ee.log(l.getUint32(a,!0),l.getUint32(o,!0)),0},environ_get(a,o){const l=new DataView(s.inst.exports.memory.buffer),u=new Uint8Array(s.inst.exports.memory.buffer),c=o;for(let d=0;d<s.env.length;d++){l.setUint32(a,o,!0),a+=4;const f=new TextEncoder().encode(s.env[d]);u.set(f,o),l.setUint8(o+f.length,0),o+=f.length+1}return Ee.enabled&&Ee.log(new TextDecoder("utf-8").decode(u.slice(c,o))),0},clock_res_get(a,o){throw"unimplemented"},clock_time_get(a,o,l){const u=new DataView(s.inst.exports.memory.buffer);if(a===ch)u.setBigUint64(l,BigInt(new Date().getTime())*1000000n,!0);else if(a==dh){let c;try{c=BigInt(Math.round(performance.now()*1e6))}catch{c=0n}u.setBigUint64(l,c,!0)}else u.setBigUint64(l,0n,!0);return 0},fd_advise(a,o,l,u){return s.fds[a]!=null?s.fds[a].fd_advise(o,l,u):te},fd_allocate(a,o,l){return s.fds[a]!=null?s.fds[a].fd_allocate(o,l):te},fd_close(a){if(s.fds[a]!=null){const o=s.fds[a].fd_close();return s.fds[a]=void 0,o}else return te},fd_datasync(a){return s.fds[a]!=null?s.fds[a].fd_datasync():te},fd_fdstat_get(a,o){if(s.fds[a]!=null){const{ret:l,fdstat:u}=s.fds[a].fd_fdstat_get();return u!=null&&u.write_bytes(new DataView(s.inst.exports.memory.buffer),o),l}else return te},fd_fdstat_set_flags(a,o){return s.fds[a]!=null?s.fds[a].fd_fdstat_set_flags(o):te},fd_fdstat_set_rights(a,o,l){return s.fds[a]!=null?s.fds[a].fd_fdstat_set_rights(o,l):te},fd_filestat_get(a,o){if(s.fds[a]!=null){const{ret:l,filestat:u}=s.fds[a].fd_filestat_get();return u!=null&&u.write_bytes(new DataView(s.inst.exports.memory.buffer),o),l}else return te},fd_filestat_set_size(a,o){return s.fds[a]!=null?s.fds[a].fd_filestat_set_size(o):te},fd_filestat_set_times(a,o,l,u){return s.fds[a]!=null?s.fds[a].fd_filestat_set_times(o,l,u):te},fd_pread(a,o,l,u,c){const d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const h=sn.read_bytes_array(d,o,l),{ret:v,nread:g}=s.fds[a].fd_pread(f,h,u);return d.setUint32(c,g,!0),v}else return te},fd_prestat_get(a,o){const l=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const{ret:u,prestat:c}=s.fds[a].fd_prestat_get();return c!=null&&c.write_bytes(l,o),u}else return te},fd_prestat_dir_name(a,o,l){if(s.fds[a]!=null){const{ret:u,prestat_dir_name:c}=s.fds[a].fd_prestat_dir_name();return c!=null&&new Uint8Array(s.inst.exports.memory.buffer).set(c,o),u}else return te},fd_pwrite(a,o,l,u,c){const d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const h=an.read_bytes_array(d,o,l),{ret:v,nwritten:g}=s.fds[a].fd_pwrite(f,h,u);return d.setUint32(c,g,!0),v}else return te},fd_read(a,o,l,u){const c=new DataView(s.inst.exports.memory.buffer),d=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const f=sn.read_bytes_array(c,o,l),{ret:h,nread:v}=s.fds[a].fd_read(d,f);return c.setUint32(u,v,!0),h}else return te},fd_readdir(a,o,l,u,c){const d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){let h=0;for(;;){const{ret:v,dirent:g}=s.fds[a].fd_readdir_single(u);if(v!=0)return d.setUint32(c,h,!0),v;if(g==null)break;if(l-h<g.head_length()){h=l;break}const m=new ArrayBuffer(g.head_length());if(g.write_head_bytes(new DataView(m),0),f.set(new Uint8Array(m).slice(0,Math.min(m.byteLength,l-h)),o),o+=g.head_length(),h+=g.head_length(),l-h<g.name_length()){h=l;break}g.write_name_bytes(f,o,l-h),o+=g.name_length(),h+=g.name_length(),u=g.d_next}return d.setUint32(c,h,!0),0}else return te},fd_renumber(a,o){if(s.fds[a]!=null&&s.fds[o]!=null){const l=s.fds[o].fd_close();return l!=0?l:(s.fds[o]=s.fds[a],s.fds[a]=void 0,0)}else return te},fd_seek(a,o,l,u){const c=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const{ret:d,offset:f}=s.fds[a].fd_seek(o,l);return c.setBigInt64(u,f,!0),d}else return te},fd_sync(a){return s.fds[a]!=null?s.fds[a].fd_sync():te},fd_tell(a,o){const l=new DataView(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const{ret:u,offset:c}=s.fds[a].fd_tell();return l.setBigUint64(o,c,!0),u}else return te},fd_write(a,o,l,u){const c=new DataView(s.inst.exports.memory.buffer),d=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const f=an.read_bytes_array(c,o,l),{ret:h,nwritten:v}=s.fds[a].fd_write(d,f);return c.setUint32(u,v,!0),h}else return te},path_create_directory(a,o,l){const u=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const c=new TextDecoder("utf-8").decode(u.slice(o,o+l));return s.fds[a].path_create_directory(c)}else return te},path_filestat_get(a,o,l,u,c){const d=new DataView(s.inst.exports.memory.buffer),f=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const h=new TextDecoder("utf-8").decode(f.slice(l,l+u)),{ret:v,filestat:g}=s.fds[a].path_filestat_get(o,h);return g!=null&&g.write_bytes(d,c),v}else return te},path_filestat_set_times(a,o,l,u,c,d,f){const h=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const v=new TextDecoder("utf-8").decode(h.slice(l,l+u));return s.fds[a].path_filestat_set_times(o,v,c,d,f)}else return te},path_link(a,o,l,u,c,d,f){const h=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null&&s.fds[c]!=null){const v=new TextDecoder("utf-8").decode(h.slice(l,l+u)),g=new TextDecoder("utf-8").decode(h.slice(d,d+f));return s.fds[c].path_link(a,o,v,g)}else return te},path_open(a,o,l,u,c,d,f,h,v){const g=new DataView(s.inst.exports.memory.buffer),m=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const E=new TextDecoder("utf-8").decode(m.slice(l,l+u));Ee.log({path:E});const{ret:w,fd_obj:A}=s.fds[a].path_open(o,E,c,d,f,h);if(w!=0)return w;s.fds.push(A);const S=s.fds.length-1;return g.setUint32(v,S,!0),0}else return te},path_readlink(a,o,l,u,c,d){const f=new DataView(s.inst.exports.memory.buffer),h=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const v=new TextDecoder("utf-8").decode(h.slice(o,o+l));Ee.log({path:v});const{ret:g,data:m}=s.fds[a].path_readlink(v);if(m!=null){if(m.length>c)return f.setUint32(d,0,!0),te;h.set(m,u),f.setUint32(d,m.length,!0)}return g}else return te},path_remove_directory(a,o,l){const u=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const c=new TextDecoder("utf-8").decode(u.slice(o,o+l));return s.fds[a].path_remove_directory(c)}else return te},path_rename(a,o,l,u,c,d){throw"FIXME what is the best abstraction for this?"},path_symlink(a,o,l,u,c){const d=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[l]!=null){const f=new TextDecoder("utf-8").decode(d.slice(a,a+o)),h=new TextDecoder("utf-8").decode(d.slice(u,u+c));return s.fds[l].path_symlink(f,h)}else return te},path_unlink_file(a,o,l){const u=new Uint8Array(s.inst.exports.memory.buffer);if(s.fds[a]!=null){const c=new TextDecoder("utf-8").decode(u.slice(o,o+l));return s.fds[a].path_unlink_file(c)}else return te},poll_oneoff(a,o,l){throw"async io not supported"},proc_exit(a){throw"exit with exit code "+a},proc_raise(a){throw"raised signal "+a},sched_yield(){},random_get(a,o){const l=new Uint8Array(s.inst.exports.memory.buffer);for(let u=0;u<o;u++)l[a+u]=Math.random()*256|0},sock_recv(a,o,l){throw"sockets not supported"},sock_send(a,o,l){throw"sockets not supported"},sock_shutdown(a,o){throw"sockets not supported"},sock_accept(a,o){throw"sockets not supported"}}}};class dn{fd_advise(e,t,n){return-1}fd_allocate(e,t){return-1}fd_close(){return 0}fd_datasync(){return-1}fd_fdstat_get(){return{ret:-1,fdstat:null}}fd_fdstat_set_flags(e){return-1}fd_fdstat_set_rights(e,t){return-1}fd_filestat_get(){return{ret:-1,filestat:null}}fd_filestat_set_size(e){return-1}fd_filestat_set_times(e,t,n){return-1}fd_pread(e,t,n){return{ret:-1,nread:0}}fd_prestat_get(){return{ret:-1,prestat:null}}fd_prestat_dir_name(){return{ret:-1,prestat_dir_name:null}}fd_pwrite(e,t,n){return{ret:-1,nwritten:0}}fd_read(e,t){return{ret:-1,nread:0}}fd_readdir_single(e){return{ret:-1,dirent:null}}fd_seek(e,t){return{ret:-1,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:-1,offset:0n}}fd_write(e,t){return{ret:-1,nwritten:0}}path_create_directory(e){return-1}path_filestat_get(e,t){return{ret:-1,filestat:null}}path_filestat_set_times(e,t,n,i,s){return-1}path_link(e,t,n,i){return-1}path_open(e,t,n,i,s,a){return{ret:-1,fd_obj:null}}path_readlink(e){return{ret:-1,data:null}}path_remove_directory(e){return-1}path_rename(e,t,n){return-1}path_symlink(e,t){return-1}path_unlink_file(e){return-1}}class bh extends dn{fd_fdstat_get(){return{ret:0,fdstat:new ms(on,0,this.fs_rights_base)}}fd_read(e,t){if((Number(this.fs_rights_base)&Pn)!==Pn)return{ret:te,nread:0};let n=0;for(const i of t)if(this.file_pos<this.file.data.byteLength){const s=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(i.buf_len)));e.set(s,i.buf),this.file_pos+=BigInt(s.length),n+=s.length}else break;return{ret:0,nread:n}}fd_seek(e,t){let n;switch(t){case qo:n=e;break;case zo:n=this.file_pos+e;break;case Yn:n=BigInt(this.file.data.byteLength)+e;break;default:return{ret:Dn,offset:0n}}return n<0?{ret:Dn,offset:0n}:(this.file_pos=n,{ret:0,offset:this.file_pos})}fd_write(e,t){let n=0;if(this.file.readonly||!(Number(this.fs_rights_base)&kn))return{ret:te,nwritten:n};for(const i of t){const s=e.slice(i.buf,i.buf+i.buf_len);if(this.file_pos+BigInt(s.byteLength)>this.file.size){const a=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(s.byteLength))),this.file.data.set(a)}this.file.data.set(s.slice(0,Number(this.file.size-this.file_pos)),Number(this.file_pos)),this.file_pos+=BigInt(s.byteLength),n+=i.buf_len}return{ret:0,nwritten:n}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e,t=0n){super(),this.file_pos=0n,this.fs_rights_base=0n,this.file=e,this.fs_rights_base=t}}class _h extends dn{fd_fdstat_get(){return{ret:0,fdstat:new ms(on,0)}}fd_filestat_get(){return{ret:0,filestat:new Xn(on,BigInt(this.file.handle.getSize()))}}fd_read(e,t){if((Number(this.fs_rights_base)&Pn)!==Pn)return{ret:te,nread:0};let n=0;for(const i of t)if(this.position<this.file.handle.getSize()){const s=new Uint8Array(e.buffer,i.buf,i.buf_len),a=this.file.handle.read(s,{at:Number(this.position)});this.position+=BigInt(a),n+=a}else break;return{ret:0,nread:n}}fd_seek(e,t){let n;switch(t){case qo:n=BigInt(e);break;case zo:n=this.position+BigInt(e);break;case Yn:n=BigInt(this.file.handle.getSize())+BigInt(e);break;default:return{ret:Dn,offset:0n}}return n<0?{ret:Dn,offset:0n}:(this.position=n,{ret:Pt,offset:this.position})}fd_write(e,t){let n=0;if(this.file.readonly||!(Number(this.fs_rights_base)&kn))return{ret:te,nwritten:n};for(const i of t){const s=new Uint8Array(e.buffer,i.buf,i.buf_len),a=this.file.handle.write(s,{at:Number(this.position)});this.position+=BigInt(a),n+=a}return{ret:Pt,nwritten:n}}fd_datasync(){return this.file.handle.flush(),Pt}fd_sync(){return this.fd_datasync()}fd_close(){return Pt}constructor(e,t=0n){super(),this.position=0n,this.fs_rights_base=0n,this.file=e,this.fs_rights_base=t}}class Go extends dn{fd_fdstat_get(){return{ret:0,fdstat:new ms(Vi,0)}}fd_readdir_single(e){if(Ee.enabled&&(Ee.log("readdir_single",e),Ee.log(e,Object.keys(this.dir.contents))),Ee.log(e,Object.keys(this.dir.contents).slice(Number(e))),e>=BigInt(Object.keys(this.dir.contents).length))return{ret:0,dirent:null};const t=Object.keys(this.dir.contents)[Number(e)],n=this.dir.contents[t];return{ret:0,dirent:new ph(e+1n,t,n.stat().filetype)}}path_filestat_get(e,t){const n=this.dir.get_entry_for_path(t);return n==null?{ret:da,filestat:null}:{ret:0,filestat:n.stat()}}path_open(e,t,n,i,s,a){let o=this.dir.get_entry_for_path(t);if(o==null)if((n&Ti)==Ti)o=this.dir.create_entry_for_path(t,(n&$r)==$r);else return{ret:da,fd_obj:null};else if((n&fa)==fa)return{ret:fh,fd_obj:null};if((n&$r)==$r&&o.stat().filetype!=Vi)return{ret:hh,fd_obj:null};if(o.readonly&&(i&BigInt(kn))==BigInt(kn))return{ret:ps,fd_obj:null};if(!(o instanceof vr)&&(n&ha)==ha){const l=o.truncate();if(l!=Pt)return{ret:l,fd_obj:null}}return{ret:Pt,fd_obj:o.open(a,i)}}path_create_directory(e){return this.path_open(0,e,Ti|$r,0n,0n,0).ret}path_unlink_file(e){return delete this.dir.contents[e],Pt}constructor(e){super(),this.dir=e}}class wh extends Go{fd_prestat_get(){return{ret:0,prestat:vs.dir(this.prestat_name.length)}}fd_prestat_dir_name(){return{ret:0,prestat_dir_name:this.prestat_name}}constructor(e,t){super(new vr(t)),this.prestat_name=new TextEncoder().encode(e)}}class Sh{open(e,t){const n=new bh(this,t);return e&Ho&&n.fd_seek(0n,Yn),n}get size(){return BigInt(this.data.byteLength)}stat(){return new Xn(on,this.size)}truncate(){return this.readonly?ps:(this.data=new Uint8Array([]),Pt)}constructor(e,t){this.data=new Uint8Array(e),this.readonly=!!(t!=null&&t.readonly)}}class Rh{open(e,t){const n=new _h(this,t);return e&Ho&&n.fd_seek(0n,Yn),n}get size(){return BigInt(this.handle.getSize())}stat(){return new Xn(on,this.size)}truncate(){return this.readonly?ps:(this.handle.truncate(0),Pt)}constructor(e,t){this.handle=e,this.readonly=!!(t!=null&&t.readonly)}}class vr{open(e){return new Go(this)}stat(){return new Xn(Vi,0n)}get_entry_for_path(e){let t=this;for(const n of e.split("/")){if(n=="")break;if(n!="."){if(!(t instanceof vr))return null;if(t.contents[n]!=null)t=t.contents[n];else return Ee.log(`component ${n} undefined`),null}}return t}create_entry_for_path(e,t){let n=this;const i=e.split("/").filter(s=>s!="/");for(let s=0;s<i.length;s++){const a=i[s];if(!(n instanceof vr))break;n.contents[a]!=null||(Ee.log("create",a),s==i.length-1&&!t?n.contents[a]=new Sh(new ArrayBuffer(0)):n.contents[a]=new vr({})),n=n.contents[a]}return n}constructor(e){this.readonly=!1,this.contents=e}}class pa extends dn{constructor(t){super();F(this,"fn");this.fn=t}fd_write(t,n){let i=0;for(const s of n){const a=t.slice(s.buf,s.buf+s.buf_len);this.fn(new TextDecoder().decode(a)),i+=s.buf_len}return{ret:0,nwritten:i}}}class _n extends dn{constructor(){super()}}async function Qi(r,e){const t={};for await(const[n,i]of r.entries())if(i.kind==="file"){const s=i;t[n]=new Rh(await s.createSyncAccessHandle())}else if(i.kind==="directory")t[n]=await Qi(i,e+"/"+n);else throw new Error("Unknown item kind: "+i.kind);return new wh(e,t)}class $n{constructor(e){F(this,"wasi");this.wasi=e}static async create(e){const t=await navigator.storage.getDirectory(),n=[];if(e.stdin===0)n.push(new _n);else if(e.stdin===void 0)n.push(new _n);else throw new Error("Unsupported stdin mode");if(e.stdout===1)n.push(new pa(console.log.bind(console,"stdout: ")));else if(e.stdin===void 0)n.push(new _n);else throw new Error("Unsupported stdout mode");if(e.stderr===2)n.push(new pa(console.error.bind(console,"stderr: ")));else if(e.stdin===void 0)n.push(new _n);else throw new Error("Unsupported stderr mode");for(const[s,a]of Object.entries(e.preopens||{}))if(a.startsWith("opfs:")){const o=a.slice(5);if(o==="/")n.push(await Qi(t,s));else{const l=await t.getDirectoryHandle(o,{create:!0});n.push(await Qi(l,s))}}const i=Object.entries(e.env||{}).map(([s,a])=>`${s}=${a}`);return new $n(new Eh(e.args||[],i,n,{debug:!0}))}start(e){this.wasi.start(e)}initialize(e){this.wasi.initialize(e)}getImports(){return this.wasi.wasiImport}}Qn("wasmrs:worker");ds.setWasi($n);ds.setWasi($n);var Yi=function(r,e){return Yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},Yi(r,e)};function Jt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Yi(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Th(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})}function Vo(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Rr(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tr(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function rr(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}function gr(r){return this instanceof gr?(this.v=r,this):new gr(r)}function Ah(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){n[f]&&(i[f]=function(h){return new Promise(function(v,g){s.push([f,h,v,g])>1||o(f,h)})})}function o(f,h){try{l(n[f](h))}catch(v){d(s[0][3],v)}}function l(f){f.value instanceof gr?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}function u(f){o("next",f)}function c(f){o("throw",f)}function d(f,h){f(h),s.shift(),s.length&&o(s[0][0],s[0][1])}}function Fh(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Rr=="function"?Rr(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(o,l){a=r[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}function ge(r){return typeof r=="function"}function Qo(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ai=Qo(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Ln(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var ir=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,i,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=Rr(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var c=this.initialTeardown;if(ge(c))try{c()}catch(g){s=g instanceof Ai?g.errors:[g]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=Rr(d),h=f.next();!h.done;h=f.next()){var v=h.value;try{ma(v)}catch(g){s=s??[],g instanceof Ai?s=rr(rr([],tr(s)),tr(g.errors)):s.push(g)}}}catch(g){n={error:g}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}if(s)throw new Ai(s)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)ma(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ln(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&Ln(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),Yo=ir.EMPTY;function Xo(r){return r instanceof ir||r&&"closed"in r&&ge(r.remove)&&ge(r.add)&&ge(r.unsubscribe)}function ma(r){ge(r)?r():r.unsubscribe()}var $o={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Xi={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i=Xi.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,rr([r,e],tr(t))):setTimeout.apply(void 0,rr([r,e],tr(t)))},clearTimeout:function(r){var e=Xi.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(r)},delegate:void 0};function jo(r){Xi.setTimeout(function(){throw r})}function va(){}function Tn(r){r()}var gs=function(r){Jt(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Xo(t)&&t.add(n)):n.destination=Oh,n}return e.create=function(t,n,i){return new ln(t,n,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ir),xh=Function.prototype.bind;function Fi(r,e){return xh.call(r,e)}var Ih=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){wn(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){wn(n)}else wn(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){wn(t)}},r}(),ln=function(r){Jt(e,r);function e(t,n,i){var s=r.call(this)||this,a;if(ge(t)||!t)a={next:t??void 0,error:n??void 0,complete:i??void 0};else{var o;s&&$o.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=function(){return s.unsubscribe()},a={next:t.next&&Fi(t.next,o),error:t.error&&Fi(t.error,o),complete:t.complete&&Fi(t.complete,o)}):a=t}return s.destination=new Ih(a),s}return e}(gs);function wn(r){jo(r)}function Ch(r){throw r}var Oh={closed:!0,next:va,error:Ch,complete:va},ys=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Uh(r){return r}function Nh(r){return r.length===0?Uh:r.length===1?r[0]:function(t){return r.reduce(function(n,i){return i(n)},t)}}var ze=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this,s=Ph(e)?e:new ln(e,t,n);return Tn(function(){var a=i,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=ga(t),new t(function(i,s){var a=new ln({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:i});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[ys]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Nh(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=ga(e),new e(function(n,i){var s;t.subscribe(function(a){return s=a},function(a){return i(a)},function(){return n(s)})})},r.create=function(e){return new r(e)},r}();function ga(r){var e;return(e=r??$o.Promise)!==null&&e!==void 0?e:Promise}function Dh(r){return r&&ge(r.next)&&ge(r.error)&&ge(r.complete)}function Ph(r){return r&&r instanceof gs||Dh(r)&&Xo(r)}function kh(r){return ge(r==null?void 0:r.lift)}function sr(r){return function(e){if(kh(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Tr(r,e,t,n,i){return new Lh(r,e,t,n,i)}var Lh=function(r){Jt(e,r);function e(t,n,i,s,a,o){var l=r.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=n?function(u){try{n(u)}catch(c){t.error(c)}}:r.prototype._next,l._error=s?function(u){try{s(u)}catch(c){t.error(c)}finally{this.unsubscribe()}}:r.prototype._error,l._complete=i?function(){try{i()}catch(u){t.error(u)}finally{this.unsubscribe()}}:r.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(gs),Mh=Qo(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Es=function(r){Jt(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new ya(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new Mh},e.prototype.next=function(t){var n=this;Tn(function(){var i,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=Rr(n.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(u){i={error:u}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var n=this;Tn(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var i=n.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;Tn(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,i=this,s=i.hasError,a=i.isStopped,o=i.observers;return s||a?Yo:(this.currentObservers=null,o.push(t),new ir(function(){n.currentObservers=null,Ln(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,s=n.thrownError,a=n.isStopped;i?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new ze;return t.source=this,t},e.create=function(t,n){return new ya(t,n)},e}(ze),ya=function(r){Jt(e,r);function e(t,n){var i=r.call(this)||this;return i.destination=t,i.source=n,i}return e.prototype.next=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,t)},e.prototype.error=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&i!==void 0?i:Yo},e}(Es),Jo={now:function(){return(Jo.delegate||Date).now()},delegate:void 0},Bh=function(r){Jt(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return this},e}(ir),Mn={setInterval:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i=Mn.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,rr([r,e],tr(t))):setInterval.apply(void 0,rr([r,e],tr(t)))},clearInterval:function(r){var e=Mn.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(r)},delegate:void 0},qh=function(r){Jt(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return e.prototype.schedule=function(t,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,n),this},e.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),Mn.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&Mn.clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var i=!1,s;try{this.work(t)}catch(a){i=!0,s=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,i=t.scheduler,s=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ln(s,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},e}(Bh),Ea=function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=Jo.now,r}(),zh=function(r){Jt(e,r);function e(t,n){n===void 0&&(n=Ea.now);var i=r.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}},e}(Ea),Nr=new zh(qh),Hh=new ze(function(r){return r.complete()});function Gh(r){return r&&ge(r.schedule)}function Vh(r){return r[r.length-1]}function Qh(r){return Gh(Vh(r))?r.pop():void 0}var Zo=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function Wo(r){return ge(r==null?void 0:r.then)}function Ko(r){return ge(r[ys])}function el(r){return Symbol.asyncIterator&&ge(r==null?void 0:r[Symbol.asyncIterator])}function tl(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Yh(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rl=Yh();function nl(r){return ge(r==null?void 0:r[rl])}function il(r){return Ah(this,arguments,function(){var t,n,i,s;return Vo(this,function(a){switch(a.label){case 0:t=r.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,gr(t.read())];case 3:return n=a.sent(),i=n.value,s=n.done,s?[4,gr(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,gr(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function sl(r){return ge(r==null?void 0:r.getReader)}function kt(r){if(r instanceof ze)return r;if(r!=null){if(Ko(r))return Xh(r);if(Zo(r))return $h(r);if(Wo(r))return jh(r);if(el(r))return al(r);if(nl(r))return Jh(r);if(sl(r))return Zh(r)}throw tl(r)}function Xh(r){return new ze(function(e){var t=r[ys]();if(ge(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function $h(r){return new ze(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function jh(r){return new ze(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,jo)})}function Jh(r){return new ze(function(e){var t,n;try{for(var i=Rr(r),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.complete()})}function al(r){return new ze(function(e){Wh(r,e).catch(function(t){return e.error(t)})})}function Zh(r){return al(il(r))}function Wh(r,e){var t,n,i,s;return Th(this,void 0,void 0,function(){var a,o;return Vo(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Fh(r),l.label=1;case 1:return[4,t.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(a=n.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),i={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function $t(r,e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function ol(r,e){return e===void 0&&(e=0),sr(function(t,n){t.subscribe(Tr(n,function(i){return $t(n,r,function(){return n.next(i)},e)},function(){return $t(n,r,function(){return n.complete()},e)},function(i){return $t(n,r,function(){return n.error(i)},e)}))})}function ll(r,e){return e===void 0&&(e=0),sr(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function Kh(r,e){return kt(r).pipe(ll(e),ol(e))}function ep(r,e){return kt(r).pipe(ll(e),ol(e))}function tp(r,e){return new ze(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function rp(r,e){return new ze(function(t){var n;return $t(t,e,function(){n=r[rl](),$t(t,e,function(){var i,s,a;try{i=n.next(),s=i.value,a=i.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return ge(n==null?void 0:n.return)&&n.return()}})}function ul(r,e){if(!r)throw new Error("Iterable cannot be null");return new ze(function(t){$t(t,e,function(){var n=r[Symbol.asyncIterator]();$t(t,e,function(){n.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function np(r,e){return ul(il(r),e)}function ip(r,e){if(r!=null){if(Ko(r))return Kh(r,e);if(Zo(r))return tp(r,e);if(Wo(r))return ep(r,e);if(el(r))return ul(r,e);if(nl(r))return rp(r,e);if(sl(r))return np(r,e)}throw tl(r)}function sp(r,e){return e?ip(r,e):kt(r)}function ba(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Qh(r);return sp(r,t)}function $i(r,e){return sr(function(t,n){var i=0;t.subscribe(Tr(n,function(s){n.next(r.call(e,s,i++))}))})}function ap(r,e,t,n,i,s,a,o){var l=[],u=0,c=0,d=!1,f=function(){d&&!l.length&&!u&&e.complete()},h=function(g){return u<n?v(g):l.push(g)},v=function(g){s&&e.next(g),u++;var m=!1;kt(t(g,c++)).subscribe(Tr(e,function(E){i==null||i(E),s?h(E):e.next(E)},function(){m=!0},void 0,function(){if(m)try{u--;for(var E=function(){var w=l.shift();a?$t(e,a,function(){return v(w)}):v(w)};l.length&&u<n;)E();f()}catch(w){e.error(w)}}))};return r.subscribe(Tr(e,h,function(){d=!0,f()})),function(){o==null||o()}}function ji(r,e,t){return t===void 0&&(t=1/0),ge(e)?ji(function(n,i){return $i(function(s,a){return e(n,s,i,a)})(kt(r(n,i)))},t):(typeof e=="number"&&(t=e),sr(function(n,i){return ap(n,i,r,t)}))}function op(r,e){return function(t,n){return!r.call(e,t,n)}}function _a(r,e){return sr(function(t,n){var i=0;t.subscribe(Tr(n,function(s){return r.call(e,s,i++)&&n.next(s)}))})}function lp(r,e,t){return[_a(e,t)(kt(r)),_a(op(e,t))(kt(r))]}function cl(r,e){return ge(e)?ji(r,e,1):ji(r,1)}function up(r){return r<=0?function(){return Hh}:sr(function(e,t){var n=0;e.subscribe(Tr(t,function(i){++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function cp(r){r===void 0&&(r={});var e=r.connector,t=e===void 0?function(){return new Es}:e,n=r.resetOnError,i=n===void 0?!0:n,s=r.resetOnComplete,a=s===void 0?!0:s,o=r.resetOnRefCountZero,l=o===void 0?!0:o;return function(u){var c,d,f,h=0,v=!1,g=!1,m=function(){d==null||d.unsubscribe(),d=void 0},E=function(){m(),c=f=void 0,v=g=!1},w=function(){var A=c;E(),A==null||A.unsubscribe()};return sr(function(A,S){h++,!g&&!v&&m();var B=f=f??t();S.add(function(){h--,h===0&&!g&&!v&&(d=xi(w,l))}),B.subscribe(S),!c&&h>0&&(c=new ln({next:function(M){return B.next(M)},error:function(M){g=!0,m(),d=xi(E,i,M),B.error(M)},complete:function(){v=!0,m(),d=xi(E,a),B.complete()}}),kt(A).subscribe(c))})(u)}}function xi(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(e===!0){r();return}if(e!==!1){var i=new ln({next:function(){i.unsubscribe(),r()}});return kt(e.apply(void 0,rr([],tr(t)))).subscribe(i)}}var Ii={},bs={},Xe={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Frame=r.Lengths=r.Flags=r.FrameTypes=void 0;var e;(function(t){t[t.RESERVED=0]="RESERVED",t[t.SETUP=1]="SETUP",t[t.LEASE=2]="LEASE",t[t.KEEPALIVE=3]="KEEPALIVE",t[t.REQUEST_RESPONSE=4]="REQUEST_RESPONSE",t[t.REQUEST_FNF=5]="REQUEST_FNF",t[t.REQUEST_STREAM=6]="REQUEST_STREAM",t[t.REQUEST_CHANNEL=7]="REQUEST_CHANNEL",t[t.REQUEST_N=8]="REQUEST_N",t[t.CANCEL=9]="CANCEL",t[t.PAYLOAD=10]="PAYLOAD",t[t.ERROR=11]="ERROR",t[t.METADATA_PUSH=12]="METADATA_PUSH",t[t.RESUME=13]="RESUME",t[t.RESUME_OK=14]="RESUME_OK",t[t.EXT=63]="EXT"})(e=r.FrameTypes||(r.FrameTypes={})),function(t){t[t.NONE=0]="NONE",t[t.COMPLETE=64]="COMPLETE",t[t.FOLLOWS=128]="FOLLOWS",t[t.IGNORE=512]="IGNORE",t[t.LEASE=64]="LEASE",t[t.METADATA=256]="METADATA",t[t.NEXT=32]="NEXT",t[t.RESPOND=128]="RESPOND",t[t.RESUME_ENABLE=128]="RESUME_ENABLE"}(r.Flags||(r.Flags={})),function(t){function n(d){return(d&t.METADATA)===t.METADATA}t.hasMetadata=n;function i(d){return(d&t.COMPLETE)===t.COMPLETE}t.hasComplete=i;function s(d){return(d&t.NEXT)===t.NEXT}t.hasNext=s;function a(d){return(d&t.FOLLOWS)===t.FOLLOWS}t.hasFollows=a;function o(d){return(d&t.IGNORE)===t.IGNORE}t.hasIgnore=o;function l(d){return(d&t.RESPOND)===t.RESPOND}t.hasRespond=l;function u(d){return(d&t.LEASE)===t.LEASE}t.hasLease=u;function c(d){return(d&t.RESUME_ENABLE)===t.RESUME_ENABLE}t.hasResume=c}(r.Flags||(r.Flags={})),function(t){t[t.FRAME=3]="FRAME",t[t.HEADER=6]="HEADER",t[t.METADATA=3]="METADATA",t[t.REQUEST=3]="REQUEST"}(r.Lengths||(r.Lengths={})),function(t){function n(s){return s.streamId===0}t.isConnection=n;function i(s){return e.REQUEST_RESPONSE<=s.type&&s.type<=e.REQUEST_CHANNEL}t.isRequest=i}(r.Frame||(r.Frame={}))})(Xe);(function(r){var e=T&&T.__generator||function(p,_){var y={label:0,sent:function(){if(R[0]&1)throw R[1];return R[1]},trys:[],ops:[]},b,C,R,x;return x={next:he(0),throw:he(1),return:he(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function he(k){return function(Ve){return Ge([k,Ve])}}function Ge(k){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,C&&(R=k[0]&2?C.return:k[0]?C.throw||((R=C.return)&&R.call(C),0):C.next)&&!(R=R.call(C,k[1])).done)return R;switch(C=0,R&&(k=[k[0]&2,R.value]),k[0]){case 0:case 1:R=k;break;case 4:return y.label++,{value:k[1],done:!1};case 5:y.label++,C=k[1],k=[0];continue;case 7:k=y.ops.pop(),y.trys.pop();continue;default:if(R=y.trys,!(R=R.length>0&&R[R.length-1])&&(k[0]===6||k[0]===2)){y=0;continue}if(k[0]===3&&(!R||k[1]>R[0]&&k[1]<R[3])){y.label=k[1];break}if(k[0]===6&&y.label<R[1]){y.label=R[1],R=k;break}if(R&&y.label<R[2]){y.label=R[2],y.ops.push(k);break}R[2]&&y.ops.pop(),y.trys.pop();continue}k=_.call(p,y)}catch(Ve){k=[6,Ve],C=0}finally{b=R=0}if(k[0]&5)throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Deserializer=r.sizeOfFrame=r.serializeFrame=r.deserializeFrame=r.serializeFrameWithLength=r.deserializeFrames=r.deserializeFrameWithLength=r.writeUInt64BE=r.readUInt64BE=r.writeUInt24BE=r.readUInt24BE=r.MAX_VERSION=r.MAX_TTL=r.MAX_STREAM_ID=r.MAX_RESUME_LENGTH=r.MAX_REQUEST_N=r.MAX_REQUEST_COUNT=r.MAX_MIME_LENGTH=r.MAX_METADATA_LENGTH=r.MAX_LIFETIME=r.MAX_KEEPALIVE=r.MAX_CODE=r.FRAME_TYPE_OFFFSET=r.FLAGS_MASK=void 0;var t=Xe;r.FLAGS_MASK=1023,r.FRAME_TYPE_OFFFSET=10,r.MAX_CODE=2147483647,r.MAX_KEEPALIVE=2147483647,r.MAX_LIFETIME=2147483647,r.MAX_METADATA_LENGTH=16777215,r.MAX_MIME_LENGTH=255,r.MAX_REQUEST_COUNT=2147483647,r.MAX_REQUEST_N=2147483647,r.MAX_RESUME_LENGTH=65535,r.MAX_STREAM_ID=2147483647,r.MAX_TTL=2147483647,r.MAX_VERSION=65535;var n=4294967296;function i(p,_){var y=p.readUInt8(_)<<16,b=p.readUInt8(_+1)<<8,C=p.readUInt8(_+2);return y|b|C}r.readUInt24BE=i;function s(p,_,y){return y=p.writeUInt8(_>>>16,y),y=p.writeUInt8(_>>>8&255,y),p.writeUInt8(_&255,y)}r.writeUInt24BE=s;function a(p,_){var y=p.readUInt32BE(_),b=p.readUInt32BE(_+4);return y*n+b}r.readUInt64BE=a;function o(p,_,y){var b=_/n|0,C=_%n;return y=p.writeUInt32BE(b,y),p.writeUInt32BE(C,y)}r.writeUInt64BE=o;var l=6,u=3;function c(p){var _=i(p,0);return h(p.slice(u,u+_))}r.deserializeFrameWithLength=c;function d(p){var _,y,b,C,R,x;return e(this,function(he){switch(he.label){case 0:_=0,he.label=1;case 1:return _+u<p.length?(y=i(p,_),b=_+u,C=b+y,C>p.length?[3,3]:(R=p.slice(b,C),x=h(R),_=C,[4,[x,_]])):[3,3];case 2:return he.sent(),[3,1];case 3:return[2]}})}r.deserializeFrames=d;function f(p){var _=v(p),y=I.Buffer.allocUnsafe(_.length+u);return s(y,_.length,0),_.copy(y,u),y}r.serializeFrameWithLength=f;function h(p){var _=0,y=p.readInt32BE(_);_+=4;var b=p.readUInt16BE(_);_+=2;var C=b>>>r.FRAME_TYPE_OFFFSET,R=b&r.FLAGS_MASK;switch(C){case t.FrameTypes.SETUP:return S(p,y,R);case t.FrameTypes.PAYLOAD:return ni(p,y,R);case t.FrameTypes.ERROR:return Z(p,y,R);case t.FrameTypes.KEEPALIVE:return N(p,y,R);case t.FrameTypes.REQUEST_FNF:return Oe(p,y,R);case t.FrameTypes.REQUEST_RESPONSE:return Fe(p,y,R);case t.FrameTypes.REQUEST_STREAM:return $e(p,y,R);case t.FrameTypes.REQUEST_CHANNEL:return je(p,y,R);case t.FrameTypes.METADATA_PUSH:return D(p,y,R);case t.FrameTypes.REQUEST_N:return Zn(p,y,R);case t.FrameTypes.RESUME:return ai(p,y,R);case t.FrameTypes.RESUME_OK:return ui(p,y,R);case t.FrameTypes.CANCEL:return ei(p,y,R);case t.FrameTypes.LEASE:return me(p,y,R)}}r.deserializeFrame=h;function v(p){switch(p.type){case t.FrameTypes.SETUP:return w(p);case t.FrameTypes.PAYLOAD:return ti(p);case t.FrameTypes.ERROR:return M(p);case t.FrameTypes.KEEPALIVE:return oe(p);case t.FrameTypes.REQUEST_FNF:case t.FrameTypes.REQUEST_RESPONSE:return Ae(p);case t.FrameTypes.REQUEST_STREAM:case t.FrameTypes.REQUEST_CHANNEL:return Ct(p);case t.FrameTypes.METADATA_PUSH:return ye(p);case t.FrameTypes.REQUEST_N:return Ze(p);case t.FrameTypes.RESUME:return ii(p);case t.FrameTypes.RESUME_OK:return oi(p);case t.FrameTypes.CANCEL:return Wn(p);case t.FrameTypes.LEASE:return re(p)}}r.serializeFrame=v;function g(p){switch(p.type){case t.FrameTypes.SETUP:return A(p);case t.FrameTypes.PAYLOAD:return ri(p);case t.FrameTypes.ERROR:return W(p);case t.FrameTypes.KEEPALIVE:return ne(p);case t.FrameTypes.REQUEST_FNF:case t.FrameTypes.REQUEST_RESPONSE:return _e(p);case t.FrameTypes.REQUEST_STREAM:case t.FrameTypes.REQUEST_CHANNEL:return Ot(p);case t.FrameTypes.METADATA_PUSH:return Pe(p);case t.FrameTypes.REQUEST_N:return Jn();case t.FrameTypes.RESUME:return si(p);case t.FrameTypes.RESUME_OK:return li();case t.FrameTypes.CANCEL:return Kn();case t.FrameTypes.LEASE:return q(p)}}r.sizeOfFrame=g;var m=14,E=2;function w(p){var _=p.resumeToken!=null?p.resumeToken.byteLength:0,y=p.metadataMimeType!=null?I.Buffer.byteLength(p.metadataMimeType,"ascii"):0,b=p.dataMimeType!=null?I.Buffer.byteLength(p.dataMimeType,"ascii"):0,C=we(p),R=I.Buffer.allocUnsafe(l+m+(_?E+_:0)+y+b+C),x=le(p,R);return x=R.writeUInt16BE(p.majorVersion,x),x=R.writeUInt16BE(p.minorVersion,x),x=R.writeUInt32BE(p.keepAlive,x),x=R.writeUInt32BE(p.lifetime,x),p.flags&t.Flags.RESUME_ENABLE&&(x=R.writeUInt16BE(_,x),p.resumeToken!=null&&(x+=p.resumeToken.copy(R,x))),x=R.writeUInt8(y,x),p.metadataMimeType!=null&&(x+=R.write(p.metadataMimeType,x,x+y,"ascii")),x=R.writeUInt8(b,x),p.dataMimeType!=null&&(x+=R.write(p.dataMimeType,x,x+b,"ascii")),Ut(p,R,x),R}function A(p){var _=p.resumeToken!=null?p.resumeToken.byteLength:0,y=p.metadataMimeType!=null?I.Buffer.byteLength(p.metadataMimeType,"ascii"):0,b=p.dataMimeType!=null?I.Buffer.byteLength(p.dataMimeType,"ascii"):0,C=we(p);return l+m+(_?E+_:0)+y+b+C}function S(p,_,y){p.length;var b=l,C=p.readUInt16BE(b);b+=2;var R=p.readUInt16BE(b);b+=2;var x=p.readInt32BE(b);b+=4;var he=p.readInt32BE(b);b+=4;var Ge=null;if(y&t.Flags.RESUME_ENABLE){var k=p.readInt16BE(b);b+=2,Ge=p.slice(b,b+k),b+=k}var Ve=p.readUInt8(b);b+=1;var di=p.toString("ascii",b,b+Ve);b+=Ve;var kr=p.readUInt8(b);b+=1;var fi=p.toString("ascii",b,b+kr);b+=kr;var Lr={data:null,dataMimeType:fi,flags:y,keepAlive:x,lifetime:he,majorVersion:C,metadata:null,metadataMimeType:di,minorVersion:R,resumeToken:Ge,streamId:0,type:t.FrameTypes.SETUP};return He(p,Lr,b),Lr}var B=4;function M(p){var _=p.message!=null?I.Buffer.byteLength(p.message,"utf8"):0,y=I.Buffer.allocUnsafe(l+B+_),b=le(p,y);return b=y.writeUInt32BE(p.code,b),p.message!=null&&y.write(p.message,b,b+_,"utf8"),y}function W(p){var _=p.message!=null?I.Buffer.byteLength(p.message,"utf8"):0;return l+B+_}function Z(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R=p.length-b,x="";return R>0&&(x=p.toString("utf8",b,b+R),b+=R),{code:C,flags:y,message:x,streamId:_,type:t.FrameTypes.ERROR}}var P=8;function oe(p){var _=p.data!=null?p.data.byteLength:0,y=I.Buffer.allocUnsafe(l+P+_),b=le(p,y);return b=o(y,p.lastReceivedPosition,b),p.data!=null&&p.data.copy(y,b),y}function ne(p){var _=p.data!=null?p.data.byteLength:0;return l+P+_}function N(p,_,y){p.length;var b=l,C=a(p,b);b+=8;var R=null;return b<p.length&&(R=p.slice(b,p.length)),{data:R,flags:y,lastReceivedPosition:C,streamId:0,type:t.FrameTypes.KEEPALIVE}}var ie=8;function re(p){var _=p.metadata!=null?p.metadata.byteLength:0,y=I.Buffer.allocUnsafe(l+ie+_),b=le(p,y);return b=y.writeUInt32BE(p.ttl,b),b=y.writeUInt32BE(p.requestCount,b),p.metadata!=null&&p.metadata.copy(y,b),y}function q(p){var _=p.metadata!=null?p.metadata.byteLength:0;return l+ie+_}function me(p,_,y){var b=l,C=p.readUInt32BE(b);b+=4;var R=p.readUInt32BE(b);b+=4;var x=null;return b<p.length&&(x=p.slice(b,p.length)),{flags:y,metadata:x,requestCount:R,streamId:0,ttl:C,type:t.FrameTypes.LEASE}}function Ae(p){var _=we(p),y=I.Buffer.allocUnsafe(l+_),b=le(p,y);return Ut(p,y,b),y}function _e(p){var _=we(p);return l+_}function ye(p){var _=p.metadata;if(_!=null){var y=I.Buffer.allocUnsafe(l+_.byteLength),b=le(p,y);return _.copy(y,b),y}else{var y=I.Buffer.allocUnsafe(l);return le(p,y),y}}function Pe(p){return l+(p.metadata!=null?p.metadata.byteLength:0)}function Oe(p,_,y){p.length;var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.REQUEST_FNF};return He(p,b,l),b}function Fe(p,_,y){var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.REQUEST_RESPONSE};return He(p,b,l),b}function D(p,_,y){return{flags:y,metadata:length===l?null:p.slice(l,length),streamId:0,type:t.FrameTypes.METADATA_PUSH}}var It=4;function Ct(p){var _=we(p),y=I.Buffer.allocUnsafe(l+It+_),b=le(p,y);return b=y.writeUInt32BE(p.requestN,b),Ut(p,y,b),y}function Ot(p){var _=we(p);return l+It+_}function $e(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R={data:null,flags:y,metadata:null,requestN:C,streamId:_,type:t.FrameTypes.REQUEST_STREAM};return He(p,R,b),R}function je(p,_,y){p.length;var b=l,C=p.readInt32BE(b);b+=4;var R={data:null,flags:y,metadata:null,requestN:C,streamId:_,type:t.FrameTypes.REQUEST_CHANNEL};return He(p,R,b),R}var Je=4;function Ze(p){var _=I.Buffer.allocUnsafe(l+Je),y=le(p,_);return _.writeUInt32BE(p.requestN,y),_}function Jn(p){return l+Je}function Zn(p,_,y){p.length;var b=p.readInt32BE(l);return{flags:y,requestN:b,streamId:_,type:t.FrameTypes.REQUEST_N}}function Wn(p){var _=I.Buffer.allocUnsafe(l);return le(p,_),_}function Kn(p){return l}function ei(p,_,y){return p.length,{flags:y,streamId:_,type:t.FrameTypes.CANCEL}}function ti(p){var _=we(p),y=I.Buffer.allocUnsafe(l+_),b=le(p,y);return Ut(p,y,b),y}function ri(p){var _=we(p);return l+_}function ni(p,_,y){p.length;var b={data:null,flags:y,metadata:null,streamId:_,type:t.FrameTypes.PAYLOAD};return He(p,b,l),b}var Dr=22;function ii(p){var _=p.resumeToken.byteLength,y=I.Buffer.allocUnsafe(l+Dr+_),b=le(p,y);return b=y.writeUInt16BE(p.majorVersion,b),b=y.writeUInt16BE(p.minorVersion,b),b=y.writeUInt16BE(_,b),b+=p.resumeToken.copy(y,b),b=o(y,p.serverPosition,b),o(y,p.clientPosition,b),y}function si(p){var _=p.resumeToken.byteLength;return l+Dr+_}function ai(p,_,y){p.length;var b=l,C=p.readUInt16BE(b);b+=2;var R=p.readUInt16BE(b);b+=2;var x=p.readInt16BE(b);b+=2;var he=p.slice(b,b+x);b+=x;var Ge=a(p,b);b+=8;var k=a(p,b);return b+=8,{clientPosition:k,flags:y,majorVersion:C,minorVersion:R,resumeToken:he,serverPosition:Ge,streamId:0,type:t.FrameTypes.RESUME}}var Pr=8;function oi(p){var _=I.Buffer.allocUnsafe(l+Pr),y=le(p,_);return o(_,p.clientPosition,y),_}function li(p){return l+Pr}function ui(p,_,y){p.length;var b=a(p,l);return{clientPosition:b,flags:y,streamId:0,type:t.FrameTypes.RESUME_OK}}function le(p,_){var y=_.writeInt32BE(p.streamId,0);return _.writeUInt16BE(p.type<<r.FRAME_TYPE_OFFFSET|p.flags&r.FLAGS_MASK,y)}function we(p){var _=0;return p.data!=null&&(_+=p.data.byteLength),t.Flags.hasMetadata(p.flags)&&(_+=u,p.metadata!=null&&(_+=p.metadata.byteLength)),_}function Ut(p,_,y){if(t.Flags.hasMetadata(p.flags))if(p.metadata!=null){var b=p.metadata.byteLength;y=s(_,b,y),y+=p.metadata.copy(_,y)}else y=s(_,0,y);p.data!=null&&p.data.copy(_,y)}function He(p,_,y){if(t.Flags.hasMetadata(_.flags)){var b=i(p,y);y+=u,b>0&&(_.metadata=p.slice(y,y+b),y+=b)}y<p.length&&(_.data=p.slice(y,p.length))}var ci=function(){function p(){}return p.prototype.deserializeFrame=function(_){return h(_)},p.prototype.deserializeFrameWithLength=function(_){return c(_)},p.prototype.deserializeFrames=function(_){return d(_)},p}();r.Deserializer=ci})(bs);var dl={};Object.defineProperty(dl,"__esModule",{value:!0});var fn={},wa=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(fn,"__esModule",{value:!0});fn.Deferred=void 0;var dp=function(){function r(){this._done=!1,this.onCloseCallbacks=[]}return Object.defineProperty(r.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0}),r.prototype.close=function(e){var t,n,i,s;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}if(this._done=!0,this._error=e,e){try{for(var a=wa(this.onCloseCallbacks),o=a.next();!o.done;o=a.next()){var l=o.value;l(e)}}catch(d){t={error:d}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return}try{for(var u=wa(this.onCloseCallbacks),c=u.next();!c.done;c=u.next()){var l=c.value;l()}}catch(d){i={error:d}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}},r.prototype.onClose=function(e){if(this._done){e(this._error);return}this.onCloseCallbacks.push(e)},r}();fn.Deferred=dp;var zt={};(function(r){var e=T&&T.__extends||function(){var n=function(i,s){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])},n(i,s)};return function(i,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");n(i,s);function a(){this.constructor=i}i.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}();Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorCodes=r.RSocketError=void 0;var t=function(n){e(i,n);function i(s,a){var o=n.call(this,a)||this;return o.code=s,o}return i}(Error);r.RSocketError=t,function(n){n[n.RESERVED=0]="RESERVED",n[n.INVALID_SETUP=1]="INVALID_SETUP",n[n.UNSUPPORTED_SETUP=2]="UNSUPPORTED_SETUP",n[n.REJECTED_SETUP=3]="REJECTED_SETUP",n[n.REJECTED_RESUME=4]="REJECTED_RESUME",n[n.CONNECTION_CLOSE=258]="CONNECTION_CLOSE",n[n.CONNECTION_ERROR=257]="CONNECTION_ERROR",n[n.APPLICATION_ERROR=513]="APPLICATION_ERROR",n[n.REJECTED=514]="REJECTED",n[n.CANCELED=515]="CANCELED",n[n.INVALID=516]="INVALID",n[n.RESERVED_EXTENSION=4294967295]="RESERVED_EXTENSION"}(r.ErrorCodes||(r.ErrorCodes={}))})(zt);var fl={};Object.defineProperty(fl,"__esModule",{value:!0});var jr={},Ci={},Sa;function hl(){return Sa||(Sa=1,function(r){var e=T&&T.__extends||function(){var d=function(f,h){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(v[m]=g[m])},d(f,h)};return function(f,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");d(f,h);function v(){this.constructor=f}f.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),t=T&&T.__awaiter||function(d,f,h,v){function g(m){return m instanceof h?m:new h(function(E){E(m)})}return new(h||(h=Promise))(function(m,E){function w(B){try{S(v.next(B))}catch(M){E(M)}}function A(B){try{S(v.throw(B))}catch(M){E(M)}}function S(B){B.done?m(B.value):g(B.value).then(w,A)}S((v=v.apply(d,f||[])).next())})},n=T&&T.__generator||function(d,f){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},v,g,m,E;return E={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function w(S){return function(B){return A([S,B])}}function A(S){if(v)throw new TypeError("Generator is already executing.");for(;h;)try{if(v=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return h.label++,{value:S[1],done:!1};case 5:h.label++,g=S[1],S=[0];continue;case 7:S=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){h=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){h.label=S[1];break}if(S[0]===6&&h.label<m[1]){h.label=m[1],m=S;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(S);break}m[2]&&h.ops.pop(),h.trys.pop();continue}S=f.call(d,h)}catch(B){S=[6,B],g=0}finally{v=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer=r.ResumableClientServerInputMultiplexerDemultiplexer=r.ClientServerInputMultiplexerDemultiplexer=r.StreamIdGenerator=void 0;var i=jn(),s=fn,a=zt,o=Xe;(function(d){function f(v){return new h(v)}d.create=f;var h=function(){function v(g){this.currentId=g}return v.prototype.next=function(g){var m=this.currentId+2;g(m)&&(this.currentId=m)},v}()})(r.StreamIdGenerator||(r.StreamIdGenerator={}));var l=function(d){e(f,d);function f(h,v,g){var m=d.call(this)||this;return m.streamIdSupplier=h,m.outbound=v,m.closeable=g,m.registry={},g.onClose(m.close.bind(m)),m}return f.prototype.handle=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.RESERVED)return;this.connectionFramesHandler.handle(h)}else if(o.Frame.isRequest(h)){if(this.registry[h.streamId])return;this.requestFramesHandler.handle(h,this)}else{var v=this.registry[h.streamId];if(!v)return;v.handle(h)}},f.prototype.connectionInbound=function(h){if(this.connectionFramesHandler)throw new Error("Connection frame handler has already been installed");this.connectionFramesHandler=h},f.prototype.handleRequestStream=function(h){if(this.requestFramesHandler)throw new Error("Stream handler has already been installed");this.requestFramesHandler=h},f.prototype.send=function(h){this.outbound.send(h)},Object.defineProperty(f.prototype,"connectionOutbound",{get:function(){return this},enumerable:!1,configurable:!0}),f.prototype.createRequestStream=function(h){var v=this;if(this.done){h.handleReject(new Error("Already closed"));return}var g=this.registry;this.streamIdSupplier.next(function(m){return h.handleReady(m,v)},Object.keys(g))},f.prototype.connect=function(h){this.registry[h.streamId]=h},f.prototype.disconnect=function(h){delete this.registry[h.streamId]},f.prototype.close=function(h){if(this.done){d.prototype.close.call(this,h);return}for(var v in this.registry){var g=this.registry[v];g.close(new Error("Closed. ".concat(h?"Original cause [".concat(h,"]."):"")))}d.prototype.close.call(this,h)},f}(s.Deferred);r.ClientServerInputMultiplexerDemultiplexer=l;var u=function(d){e(f,d);function f(h,v,g,m,E,w,A){var S=d.call(this,h,v,new s.Deferred)||this;return S.frameStore=m,S.token=E,S.sessionTimeout=A,w instanceof Function?S.reconnector=w:S.sessionStore=w,g.onClose(S.handleConnectionClose.bind(S)),S}return f.prototype.send=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.KEEPALIVE)h.lastReceivedPosition=this.frameStore.lastReceivedFramePosition;else if(h.type===i.FrameTypes.ERROR){this.outbound.send(h),this.sessionStore&&delete this.sessionStore[this.token],d.prototype.close.call(this,new a.RSocketError(h.code,h.message));return}}else this.frameStore.store(h);this.outbound.send(h)},f.prototype.handle=function(h){if(o.Frame.isConnection(h)){if(h.type===i.FrameTypes.KEEPALIVE)try{this.frameStore.dropTo(h.lastReceivedPosition)}catch(v){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),this.close(v)}else if(h.type===i.FrameTypes.ERROR){d.prototype.handle.call(this,h),this.sessionStore&&delete this.sessionStore[this.token],d.prototype.close.call(this,new a.RSocketError(h.code,h.message));return}}else this.frameStore.record(h);d.prototype.handle.call(this,h)},f.prototype.resume=function(h,v,g){switch(this.outbound=v,h.type){case i.FrameTypes.RESUME:{if(clearTimeout(this.timeoutId),this.frameStore.lastReceivedFramePosition<h.clientPosition){var m=new a.RSocketError(i.ErrorCodes.REJECTED_RESUME,"Impossible to resume since first available client frame position is greater than last received server frame position");this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:m.code,message:m.message}),this.close(m);return}try{this.frameStore.dropTo(h.serverPosition)}catch(E){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:E.code,message:E.message}),this.close(E);return}this.outbound.send({type:i.FrameTypes.RESUME_OK,streamId:0,flags:i.Flags.NONE,clientPosition:this.frameStore.lastReceivedFramePosition});break}case i.FrameTypes.RESUME_OK:{try{this.frameStore.dropTo(h.clientPosition)}catch(E){this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:E.code,message:E.message}),this.close(E)}break}}this.frameStore.drain(this.outbound.send.bind(this.outbound)),g.onClose(this.handleConnectionClose.bind(this)),this.connectionFramesHandler.resume()},f.prototype.handleConnectionClose=function(h){return t(this,void 0,void 0,function(){var v;return n(this,function(g){switch(g.label){case 0:if(this.connectionFramesHandler.pause(),!this.reconnector)return[3,5];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this.reconnector(this,this.frameStore)];case 2:return g.sent(),[3,4];case 3:return v=g.sent(),this.close(v),[3,4];case 4:return[3,6];case 5:this.timeoutId=setTimeout(this.close.bind(this),this.sessionTimeout),g.label=6;case 6:return[2]}})})},f}(l);r.ResumableClientServerInputMultiplexerDemultiplexer=u;var c=function(){function d(f,h,v){this.outbound=f,this.closeable=h,this.delegate=v,this.resumed=!1}return d.prototype.close=function(){this.delegate.close()},d.prototype.onClose=function(f){this.delegate.onClose(f)},Object.defineProperty(d.prototype,"connectionOutbound",{get:function(){return this.delegate.connectionOutbound},enumerable:!1,configurable:!0}),d.prototype.createRequestStream=function(f){this.delegate.createRequestStream(f)},d.prototype.connectionInbound=function(f){this.delegate.connectionInbound(f)},d.prototype.handleRequestStream=function(f){this.delegate.handleRequestStream(f)},d.prototype.handle=function(f){var h=this;if(!this.resumed){if(f.type===i.FrameTypes.RESUME_OK){this.resumed=!0,this.delegate.resume(f,this.outbound,this.closeable);return}else this.outbound.send({type:i.FrameTypes.ERROR,streamId:0,code:i.ErrorCodes.CONNECTION_ERROR,message:"Incomplete RESUME handshake. Unexpected frame ".concat(f.type," received"),flags:i.Flags.NONE}),this.closeable.close(),this.closeable.onClose(function(){return h.delegate.close(new a.RSocketError(i.ErrorCodes.CONNECTION_ERROR,"Incomplete RESUME handshake. Unexpected frame ".concat(f.type," received")))});return}this.delegate.handle(f)},d}();r.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer=c}(Ci)),Ci}var De={},Ar={},rt={},pl=T&&T.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(rt,"__esModule",{value:!0});rt.fragmentWithRequestN=rt.fragment=rt.isFragmentable=void 0;var V=Xe;function fp(r,e,t){return e===0?!1:r.data.byteLength+(r.metadata?r.metadata.byteLength+V.Lengths.METADATA:0)+(t==V.FrameTypes.REQUEST_STREAM||t==V.FrameTypes.REQUEST_CHANNEL?V.Lengths.REQUEST:0)>e}rt.isFragmentable=fp;function hp(r,e,t,n,i){var s,a,o,l,u,c,d,d,f,h,v,v,g,m;return i===void 0&&(i=!1),pl(this,function(E){switch(E.label){case 0:return s=(m=(g=e.data)===null||g===void 0?void 0:g.byteLength)!==null&&m!==void 0?m:0,a=n!==V.FrameTypes.PAYLOAD,o=t,e.metadata?(u=e.metadata.byteLength,u!==0?[3,1]:(o-=V.Lengths.METADATA,l=I.Buffer.allocUnsafe(0),[3,6])):[3,6];case 1:return c=0,a?(o-=V.Lengths.METADATA,d=Math.min(u,c+o),l=e.metadata.slice(c,d),o-=l.byteLength,c=d,o!==0?[3,3]:(a=!1,[4,{type:n,flags:V.Flags.FOLLOWS|V.Flags.METADATA,data:void 0,metadata:l,streamId:r}])):[3,3];case 2:E.sent(),l=void 0,o=t,E.label=3;case 3:return c<u?(o-=V.Lengths.METADATA,d=Math.min(u,c+o),l=e.metadata.slice(c,d),o-=l.byteLength,c=d,o===0||s===0?[4,{type:V.FrameTypes.PAYLOAD,flags:V.Flags.NEXT|V.Flags.METADATA|(c===u&&i&&s===0?V.Flags.COMPLETE:V.Flags.FOLLOWS),data:void 0,metadata:l,streamId:r}]:[3,5]):[3,6];case 4:E.sent(),l=void 0,o=t,E.label=5;case 5:return[3,3];case 6:return f=0,a?(v=Math.min(s,f+o),h=e.data.slice(f,v),o-=h.byteLength,f=v,[4,{type:n,flags:V.Flags.FOLLOWS|(l?V.Flags.METADATA:V.Flags.NONE),data:h,metadata:l,streamId:r}]):[3,8];case 7:E.sent(),l=void 0,h=void 0,o=t,E.label=8;case 8:return f<s?(v=Math.min(s,f+o),h=e.data.slice(f,v),o-=h.byteLength,f=v,[4,{type:V.FrameTypes.PAYLOAD,flags:f===s?(i?V.Flags.COMPLETE:V.Flags.NONE)|V.Flags.NEXT|(l?V.Flags.METADATA:0):V.Flags.FOLLOWS|V.Flags.NEXT|(l?V.Flags.METADATA:0),data:h,metadata:l,streamId:r}]):[3,10];case 9:return E.sent(),l=void 0,h=void 0,o=t,[3,8];case 10:return[2]}})}rt.fragment=hp;function pp(r,e,t,n,i,s){var a,o,l,u,c,d,f,f,h,v,g,g,m,E;return s===void 0&&(s=!1),pl(this,function(w){switch(w.label){case 0:return a=(E=(m=e.data)===null||m===void 0?void 0:m.byteLength)!==null&&E!==void 0?E:0,o=!0,l=t,e.metadata?(c=e.metadata.byteLength,c!==0?[3,1]:(l-=V.Lengths.METADATA,u=I.Buffer.allocUnsafe(0),[3,6])):[3,6];case 1:return d=0,o?(l-=V.Lengths.METADATA+V.Lengths.REQUEST,f=Math.min(c,d+l),u=e.metadata.slice(d,f),l-=u.byteLength,d=f,l!==0?[3,3]:(o=!1,[4,{type:n,flags:V.Flags.FOLLOWS|V.Flags.METADATA,data:void 0,requestN:i,metadata:u,streamId:r}])):[3,3];case 2:w.sent(),u=void 0,l=t,w.label=3;case 3:return d<c?(l-=V.Lengths.METADATA,f=Math.min(c,d+l),u=e.metadata.slice(d,f),l-=u.byteLength,d=f,l===0||a===0?[4,{type:V.FrameTypes.PAYLOAD,flags:V.Flags.NEXT|V.Flags.METADATA|(d===c&&s&&a===0?V.Flags.COMPLETE:V.Flags.FOLLOWS),data:void 0,metadata:u,streamId:r}]:[3,5]):[3,6];case 4:w.sent(),u=void 0,l=t,w.label=5;case 5:return[3,3];case 6:return h=0,o?(l-=V.Lengths.REQUEST,g=Math.min(a,h+l),v=e.data.slice(h,g),l-=v.byteLength,h=g,[4,{type:n,flags:V.Flags.FOLLOWS|(u?V.Flags.METADATA:V.Flags.NONE),data:v,requestN:i,metadata:u,streamId:r}]):[3,8];case 7:w.sent(),u=void 0,v=void 0,l=t,w.label=8;case 8:return h<a?(g=Math.min(a,h+l),v=e.data.slice(h,g),l-=v.byteLength,h=g,[4,{type:V.FrameTypes.PAYLOAD,flags:h===a?(s?V.Flags.COMPLETE:V.Flags.NONE)|V.Flags.NEXT|(u?V.Flags.METADATA:0):V.Flags.FOLLOWS|V.Flags.NEXT|(u?V.Flags.METADATA:0),data:v,metadata:u,streamId:r}]):[3,10];case 9:return w.sent(),u=void 0,v=void 0,l=t,[3,8];case 10:return[2]}})}rt.fragmentWithRequestN=pp;var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.cancel=nt.reassemble=nt.add=void 0;function mp(r,e,t){return r.hasFragments?(r.data=r.data?I.Buffer.concat([r.data,e]):e,r.metadata&&t&&(r.metadata=I.Buffer.concat([r.metadata,t])),!0):(r.hasFragments=!0,r.data=e,t&&(r.metadata=t),!0)}nt.add=mp;function vp(r,e,t){r.hasFragments=!1;var n=r.data?I.Buffer.concat([r.data,e]):e;if(r.data=void 0,r.metadata){var i=t?I.Buffer.concat([r.metadata,t]):r.metadata;return r.metadata=void 0,{data:n,metadata:i}}return{data:n}}nt.reassemble=vp;function gp(r){r.hasFragments=!1,r.data=void 0,r.metadata=void 0}nt.cancel=gp;var yp=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ep=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bp=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&yp(e,r,t);return Ep(e,r),e},Ji=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ar,"__esModule",{value:!0});Ar.RequestChannelResponderStream=Ar.RequestChannelRequesterStream=void 0;var Me=zt,ur=rt,U=Xe,Et=bp(nt),_p=function(){function r(e,t,n,i,s,a){this.payload=e,this.isComplete=t,this.receiver=n,this.fragmentSize=i,this.initialRequestN=s,this.leaseManager=a,this.streamType=U.FrameTypes.REQUEST_CHANNEL}return r.prototype.handleReady=function(e,t){var n,i;if(this.outboundDone)return!1;this.streamId=e,this.stream=t,t.connect(this);var s=this.isComplete;if(s&&(this.outboundDone=s),(0,ur.isFragmentable)(this.payload,this.fragmentSize,U.FrameTypes.REQUEST_CHANNEL))try{for(var a=Ji((0,ur.fragmentWithRequestN)(e,this.payload,this.fragmentSize,U.FrameTypes.REQUEST_CHANNEL,this.initialRequestN,s)),o=a.next();!o.done;o=a.next()){var l=o.value;this.stream.send(l)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}else this.stream.send({type:U.FrameTypes.REQUEST_CHANNEL,data:this.payload.data,metadata:this.payload.metadata,requestN:this.initialRequestN,flags:(this.payload.metadata!==void 0?U.Flags.METADATA:U.Flags.NONE)|(s?U.Flags.COMPLETE:U.Flags.NONE),streamId:e});return this.hasExtension&&this.stream.send({type:U.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.inboundDone||(this.inboundDone=!0,this.outboundDone=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case U.FrameTypes.PAYLOAD:{var i=U.Flags.hasComplete(e.flags),s=U.Flags.hasNext(e.flags);if(i||!U.Flags.hasFollows(e.flags)){if(i&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this),!s)){this.receiver.onComplete();return}var a=this.hasFragments?Et.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,i);return}if(Et.add(this,e.data,e.metadata))return;t="Unexpected frame size";break}case U.FrameTypes.CANCEL:{if(this.outboundDone)return;this.outboundDone=!0,this.inboundDone&&this.stream.disconnect(this),this.receiver.cancel();return}case U.FrameTypes.REQUEST_N:{if(this.outboundDone)return;if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.request(e.requestN);return}case U.FrameTypes.ERROR:{var o=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,this.stream.disconnect(this),Et.cancel(this),o||this.receiver.cancel(),this.receiver.onError(new Me.RSocketError(e.code,e.message));return}case U.FrameTypes.EXT:this.receiver.onExtension(e.extendedType,e.extendedContent,U.Flags.hasIgnore(e.flags));return;default:t="Unexpected frame type [".concat(n,"]")}this.close(new Me.RSocketError(Me.ErrorCodes.CANCELED,t)),this.stream.send({type:U.FrameTypes.CANCEL,streamId:this.streamId,flags:U.Flags.NONE}),this.stream.disconnect(this)},r.prototype.request=function(e){if(!this.inboundDone){if(!this.streamId){this.initialRequestN+=e;return}this.stream.send({type:U.FrameTypes.REQUEST_N,flags:U.Flags.NONE,requestN:e,streamId:this.streamId})}},r.prototype.cancel=function(){var e,t=this.inboundDone,n=this.outboundDone;if(!(t&&n)){if(this.inboundDone=!0,this.outboundDone=!0,n||this.receiver.cancel(),!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:t?U.FrameTypes.ERROR:U.FrameTypes.CANCEL,flags:U.Flags.NONE,streamId:this.streamId,code:Me.ErrorCodes.CANCELED,message:"Cancelled"}),this.stream.disconnect(this),Et.cancel(this)}},r.prototype.onNext=function(e,t){var n,i;if(!this.outboundDone)if(t&&(this.outboundDone=!0,this.inboundDone&&this.stream.disconnect(this)),(0,ur.isFragmentable)(e,this.fragmentSize,U.FrameTypes.PAYLOAD))try{for(var s=Ji((0,ur.fragment)(this.streamId,e,this.fragmentSize,U.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:U.FrameTypes.PAYLOAD,streamId:this.streamId,flags:U.Flags.NEXT|(e.metadata?U.Flags.METADATA:U.Flags.NONE)|(t?U.Flags.COMPLETE:U.Flags.NONE),data:e.data,metadata:e.metadata})},r.prototype.onComplete=function(){if(!this.streamId){this.isComplete=!0;return}this.outboundDone||(this.outboundDone=!0,this.stream.send({type:U.FrameTypes.PAYLOAD,streamId:this.streamId,flags:U.Flags.COMPLETE,data:null,metadata:null}),this.inboundDone&&this.stream.disconnect(this))},r.prototype.onError=function(e){if(!this.outboundDone){var t=this.inboundDone;this.outboundDone=!0,this.inboundDone=!0,this.stream.send({type:U.FrameTypes.ERROR,streamId:this.streamId,flags:U.Flags.NONE,code:e instanceof Me.RSocketError?e.code:Me.ErrorCodes.APPLICATION_ERROR,message:e.message}),this.stream.disconnect(this),t||this.receiver.onError(e)}},r.prototype.onExtension=function(e,t,n){if(!this.outboundDone){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?U.Flags.IGNORE:U.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:U.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?U.Flags.IGNORE:U.Flags.NONE})}},r.prototype.close=function(e){if(!(this.inboundDone&&this.outboundDone)){var t=this.inboundDone,n=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,Et.cancel(this),n||this.receiver.cancel(),t||(e?this.receiver.onError(e):this.receiver.onComplete())}},r}();Ar.RequestChannelRequesterStream=_p;var wp=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=U.FrameTypes.REQUEST_CHANNEL,t.connect(this),U.Flags.hasFollows(s.flags)){Et.add(this,s.data,s.metadata),this.initialRequestN=s.requestN,this.isComplete=U.Flags.hasComplete(s.flags);return}var a={data:s.data,metadata:s.metadata},o=U.Flags.hasComplete(s.flags);this.inboundDone=o;try{this.receiver=i(a,s.requestN,o,this),this.outboundDone&&this.defferedError&&this.receiver.onError(this.defferedError)}catch(l){this.outboundDone&&!this.inboundDone?this.cancel():this.inboundDone=!0,this.onError(l)}}return r.prototype.handle=function(e){var t,n=e.type;switch(n){case U.FrameTypes.PAYLOAD:{if(U.Flags.hasFollows(e.flags)){if(Et.add(this,e.data,e.metadata))return;t="Unexpected frame size";break}var i=this.hasFragments?Et.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata},s=U.Flags.hasComplete(e.flags);if(this.receiver){if(s&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this),!U.Flags.hasNext(e.flags))){this.receiver.onComplete();return}this.receiver.onNext(i,s)}else{var a=this.isComplete||s;a&&(this.inboundDone=!0,this.outboundDone&&this.stream.disconnect(this));try{this.receiver=this.handler(i,this.initialRequestN,a,this),this.outboundDone&&this.defferedError}catch(u){this.outboundDone&&!this.inboundDone?this.cancel():this.inboundDone=!0,this.onError(u)}}return}case U.FrameTypes.REQUEST_N:{if(!this.receiver||this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.request(e.requestN);return}case U.FrameTypes.ERROR:case U.FrameTypes.CANCEL:{var a=this.inboundDone,o=this.outboundDone;if(this.inboundDone=!0,this.outboundDone=!0,this.stream.disconnect(this),Et.cancel(this),!this.receiver)return;if(o||this.receiver.cancel(),!a){var l=n===U.FrameTypes.CANCEL?new Me.RSocketError(Me.ErrorCodes.CANCELED,"Cancelled"):new Me.RSocketError(e.code,e.message);this.receiver.onError(l)}return}case U.FrameTypes.EXT:{if(!this.receiver||this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,U.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.stream.send({type:U.FrameTypes.ERROR,flags:U.Flags.NONE,code:Me.ErrorCodes.CANCELED,message:t,streamId:this.streamId}),this.stream.disconnect(this),this.close(new Me.RSocketError(Me.ErrorCodes.CANCELED,t))},r.prototype.onError=function(e){if(this.outboundDone){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}var t=this.inboundDone;this.outboundDone=!0,this.inboundDone=!0,this.stream.send({type:U.FrameTypes.ERROR,flags:U.Flags.NONE,code:e instanceof Me.RSocketError?e.code:Me.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this),t||(this.receiver?this.receiver.onError(e):this.defferedError=e)},r.prototype.onNext=function(e,t){var n,i;if(!this.outboundDone){if(t&&(this.outboundDone=!0),(0,ur.isFragmentable)(e,this.fragmentSize,U.FrameTypes.PAYLOAD))try{for(var s=Ji((0,ur.fragment)(this.streamId,e,this.fragmentSize,U.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:U.FrameTypes.PAYLOAD,flags:U.Flags.NEXT|(t?U.Flags.COMPLETE:U.Flags.NONE)|(e.metadata?U.Flags.METADATA:U.Flags.NONE),data:e.data,metadata:e.metadata,streamId:this.streamId});t&&this.inboundDone&&this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.outboundDone||(this.outboundDone=!0,this.stream.send({type:U.FrameTypes.PAYLOAD,flags:U.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.inboundDone&&this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.outboundDone&&this.inboundDone||this.stream.send({type:U.FrameTypes.EXT,streamId:this.streamId,flags:n?U.Flags.IGNORE:U.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.request=function(e){this.inboundDone||this.stream.send({type:U.FrameTypes.REQUEST_N,flags:U.Flags.NONE,streamId:this.streamId,requestN:e})},r.prototype.cancel=function(){this.inboundDone||(this.inboundDone=!0,this.stream.send({type:U.FrameTypes.CANCEL,flags:U.Flags.NONE,streamId:this.streamId}),this.outboundDone&&this.stream.disconnect(this))},r.prototype.close=function(e){if(this.inboundDone&&this.outboundDone){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}var t=this.inboundDone,n=this.outboundDone;this.inboundDone=!0,this.outboundDone=!0,Et.cancel(this);var i=this.receiver;i&&(n||i.cancel(),t||(e?i.onError(e):i.onComplete()))},r}();Ar.RequestChannelResponderStream=wp;var Fr={},Sp=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rp=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Tp=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Sp(e,r,t);return Rp(e,r),e},Ap=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.RequestFnfResponderStream=Fr.RequestFnFRequesterStream=void 0;var An=zt,Ra=rt,Be=Xe,Jr=Tp(nt),Fp=function(){function r(e,t,n,i){this.payload=e,this.receiver=t,this.fragmentSize=n,this.leaseManager=i,this.streamType=Be.FrameTypes.REQUEST_FNF}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,(0,Ra.isFragmentable)(this.payload,this.fragmentSize,Be.FrameTypes.REQUEST_FNF))try{for(var s=Ap((0,Ra.fragment)(e,this.payload,this.fragmentSize,Be.FrameTypes.REQUEST_FNF)),a=s.next();!a.done;a=s.next()){var o=a.value;t.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else t.send({type:Be.FrameTypes.REQUEST_FNF,data:this.payload.data,metadata:this.payload.metadata,flags:this.payload.metadata?Be.Flags.METADATA:0,streamId:e});return this.done=!0,this.receiver.onComplete(),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.cancel=function(){var e;this.done||(this.done=!0,(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this))},r.prototype.handle=function(e){if(e.type==Be.FrameTypes.ERROR){this.close(new An.RSocketError(e.code,e.message));return}this.close(new An.RSocketError(An.ErrorCodes.CANCELED,"Received invalid frame"))},r.prototype.close=function(e){if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}e?this.receiver.onError(e):this.receiver.onComplete()},r}();Fr.RequestFnFRequesterStream=Fp;var xp=function(){function r(e,t,n,i){if(this.streamId=e,this.stream=t,this.handler=n,this.streamType=Be.FrameTypes.REQUEST_FNF,Be.Flags.hasFollows(i.flags)){Jr.add(this,i.data,i.metadata),t.connect(this);return}var s={data:i.data,metadata:i.metadata};try{this.cancellable=n(s,this)}catch{}}return r.prototype.handle=function(e){var t;if(e.type==Be.FrameTypes.PAYLOAD)if(Be.Flags.hasFollows(e.flags)){if(Jr.add(this,e.data,e.metadata))return;t="Unexpected fragment size"}else{this.stream.disconnect(this);var n=Jr.reassemble(this,e.data,e.metadata);try{this.cancellable=this.handler(n,this)}catch{}return}else t="Unexpected frame type [".concat(e.type,"]");this.done=!0,e.type!=Be.FrameTypes.CANCEL&&e.type!=Be.FrameTypes.ERROR&&this.stream.send({type:Be.FrameTypes.ERROR,streamId:this.streamId,flags:Be.Flags.NONE,code:An.ErrorCodes.CANCELED,message:t}),this.stream.disconnect(this),Jr.cancel(this)},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,Jr.cancel(this),(t=this.cancellable)===null||t===void 0||t.cancel()},r.prototype.onError=function(e){},r.prototype.onComplete=function(){},r}();Fr.RequestFnfResponderStream=xp;var xr={},Ip=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cp=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Op=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ip(e,r,t);return Cp(e,r),e},ml=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(xr,"__esModule",{value:!0});xr.RequestResponseResponderStream=xr.RequestResponseRequesterStream=void 0;var yr=zt,Bn=rt,X=Xe,bt=Op(nt),Up=function(){function r(e,t,n,i){this.payload=e,this.receiver=t,this.fragmentSize=n,this.leaseManager=i,this.streamType=X.FrameTypes.REQUEST_RESPONSE}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,this.stream=t,t.connect(this),(0,Bn.isFragmentable)(this.payload,this.fragmentSize,X.FrameTypes.REQUEST_RESPONSE))try{for(var s=ml((0,Bn.fragment)(e,this.payload,this.fragmentSize,X.FrameTypes.REQUEST_RESPONSE)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:X.FrameTypes.REQUEST_RESPONSE,data:this.payload.data,metadata:this.payload.metadata,flags:this.payload.metadata?X.Flags.METADATA:0,streamId:e});return this.hasExtension&&this.stream.send({type:X.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case X.FrameTypes.PAYLOAD:{var i=X.Flags.hasComplete(e.flags),s=X.Flags.hasNext(e.flags);if(i||!X.Flags.hasFollows(e.flags)){if(this.done=!0,this.stream.disconnect(this),!s){this.receiver.onComplete();return}var a=this.hasFragments?bt.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,!0);return}if(!bt.add(this,e.data,e.metadata)){t="Unexpected fragment size";break}return}case X.FrameTypes.ERROR:{this.done=!0,this.stream.disconnect(this),bt.cancel(this),this.receiver.onError(new yr.RSocketError(e.code,e.message));return}case X.FrameTypes.EXT:{if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,X.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.close(new yr.RSocketError(yr.ErrorCodes.CANCELED,t)),this.stream.send({type:X.FrameTypes.CANCEL,streamId:this.streamId,flags:X.Flags.NONE}),this.stream.disconnect(this)},r.prototype.cancel=function(){var e;if(!this.done){if(this.done=!0,!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:X.FrameTypes.CANCEL,flags:X.Flags.NONE,streamId:this.streamId}),this.stream.disconnect(this),bt.cancel(this)}},r.prototype.onExtension=function(e,t,n){if(!this.done){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?X.Flags.IGNORE:X.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:X.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?X.Flags.IGNORE:X.Flags.NONE})}},r.prototype.close=function(e){this.done||(this.done=!0,bt.cancel(this),e?this.receiver.onError(e):this.receiver.onComplete())},r}();xr.RequestResponseRequesterStream=Up;var Np=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=X.FrameTypes.REQUEST_RESPONSE,t.connect(this),X.Flags.hasFollows(s.flags)){bt.add(this,s.data,s.metadata);return}var a={data:s.data,metadata:s.metadata};try{this.receiver=i(a,this)}catch(o){this.onError(o)}}return r.prototype.handle=function(e){var t,n;if(!this.receiver||this.hasFragments)if(e.type===X.FrameTypes.PAYLOAD)if(X.Flags.hasFollows(e.flags)){if(bt.add(this,e.data,e.metadata))return;n="Unexpected fragment size"}else{var i=bt.reassemble(this,e.data,e.metadata);try{this.receiver=this.handler(i,this)}catch(s){this.onError(s)}return}else n="Unexpected frame type [".concat(e.type,"] during reassembly");else if(e.type===X.FrameTypes.EXT){this.receiver.onExtension(e.extendedType,e.extendedContent,X.Flags.hasIgnore(e.flags));return}else n="Unexpected frame type [".concat(e.type,"]");this.done=!0,(t=this.receiver)===null||t===void 0||t.cancel(),e.type!==X.FrameTypes.CANCEL&&e.type!==X.FrameTypes.ERROR&&this.stream.send({type:X.FrameTypes.ERROR,flags:X.Flags.NONE,code:yr.ErrorCodes.CANCELED,message:n,streamId:this.streamId}),this.stream.disconnect(this),bt.cancel(this)},r.prototype.onError=function(e){if(this.done){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,this.stream.send({type:X.FrameTypes.ERROR,flags:X.Flags.NONE,code:e instanceof yr.RSocketError?e.code:yr.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onNext=function(e,t){var n,i;if(!this.done){if(this.done=!0,(0,Bn.isFragmentable)(e,this.fragmentSize,X.FrameTypes.PAYLOAD))try{for(var s=ml((0,Bn.fragment)(this.streamId,e,this.fragmentSize,X.FrameTypes.PAYLOAD,!0)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:X.FrameTypes.PAYLOAD,flags:X.Flags.NEXT|X.Flags.COMPLETE|(e.metadata?X.Flags.METADATA:0),data:e.data,metadata:e.metadata,streamId:this.streamId});this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.done||(this.done=!0,this.stream.send({type:X.FrameTypes.PAYLOAD,flags:X.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.done||this.stream.send({type:X.FrameTypes.EXT,streamId:this.streamId,flags:n?X.Flags.IGNORE:X.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}bt.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel()},r}();xr.RequestResponseResponderStream=Np;var Ir={},Dp=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Pp=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kp=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Dp(e,r,t);return Pp(e,r),e},vl=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.RequestStreamResponderStream=Ir.RequestStreamRequesterStream=void 0;var Er=zt,qn=rt,H=Xe,_t=kp(nt),Lp=function(){function r(e,t,n,i,s){this.payload=e,this.receiver=t,this.fragmentSize=n,this.initialRequestN=i,this.leaseManager=s,this.streamType=H.FrameTypes.REQUEST_STREAM}return r.prototype.handleReady=function(e,t){var n,i;if(this.done)return!1;if(this.streamId=e,this.stream=t,t.connect(this),(0,qn.isFragmentable)(this.payload,this.fragmentSize,H.FrameTypes.REQUEST_STREAM))try{for(var s=vl((0,qn.fragmentWithRequestN)(e,this.payload,this.fragmentSize,H.FrameTypes.REQUEST_STREAM,this.initialRequestN)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:H.FrameTypes.REQUEST_STREAM,data:this.payload.data,metadata:this.payload.metadata,requestN:this.initialRequestN,flags:this.payload.metadata!==void 0?H.Flags.METADATA:0,streamId:e});return this.hasExtension&&this.stream.send({type:H.FrameTypes.EXT,streamId:e,extendedContent:this.extendedContent,extendedType:this.extendedType,flags:this.flags}),!0},r.prototype.handleReject=function(e){this.done||(this.done=!0,this.receiver.onError(e))},r.prototype.handle=function(e){var t,n=e.type;switch(n){case H.FrameTypes.PAYLOAD:{var i=H.Flags.hasComplete(e.flags),s=H.Flags.hasNext(e.flags);if(i||!H.Flags.hasFollows(e.flags)){if(i&&(this.done=!0,this.stream.disconnect(this),!s)){this.receiver.onComplete();return}var a=this.hasFragments?_t.reassemble(this,e.data,e.metadata):{data:e.data,metadata:e.metadata};this.receiver.onNext(a,i);return}if(!_t.add(this,e.data,e.metadata)){t="Unexpected fragment size";break}return}case H.FrameTypes.ERROR:{this.done=!0,this.stream.disconnect(this),_t.cancel(this),this.receiver.onError(new Er.RSocketError(e.code,e.message));return}case H.FrameTypes.EXT:{if(this.hasFragments){t="Unexpected frame type [".concat(n,"] during reassembly");break}this.receiver.onExtension(e.extendedType,e.extendedContent,H.Flags.hasIgnore(e.flags));return}default:t="Unexpected frame type [".concat(n,"]")}this.close(new Er.RSocketError(Er.ErrorCodes.CANCELED,t)),this.stream.send({type:H.FrameTypes.CANCEL,streamId:this.streamId,flags:H.Flags.NONE}),this.stream.disconnect(this)},r.prototype.request=function(e){if(!this.done){if(!this.streamId){this.initialRequestN+=e;return}this.stream.send({type:H.FrameTypes.REQUEST_N,flags:H.Flags.NONE,requestN:e,streamId:this.streamId})}},r.prototype.cancel=function(){var e;if(!this.done){if(this.done=!0,!this.streamId){(e=this.leaseManager)===null||e===void 0||e.cancelRequest(this);return}this.stream.send({type:H.FrameTypes.CANCEL,flags:H.Flags.NONE,streamId:this.streamId}),this.stream.disconnect(this),_t.cancel(this)}},r.prototype.onExtension=function(e,t,n){if(!this.done){if(!this.streamId){this.hasExtension=!0,this.extendedType=e,this.extendedContent=t,this.flags=n?H.Flags.IGNORE:H.Flags.NONE;return}this.stream.send({streamId:this.streamId,type:H.FrameTypes.EXT,extendedType:e,extendedContent:t,flags:n?H.Flags.IGNORE:H.Flags.NONE})}},r.prototype.close=function(e){this.done||(this.done=!0,_t.cancel(this),e?this.receiver.onError(e):this.receiver.onComplete())},r}();Ir.RequestStreamRequesterStream=Lp;var Mp=function(){function r(e,t,n,i,s){if(this.streamId=e,this.stream=t,this.fragmentSize=n,this.handler=i,this.streamType=H.FrameTypes.REQUEST_STREAM,t.connect(this),H.Flags.hasFollows(s.flags)){this.initialRequestN=s.requestN,_t.add(this,s.data,s.metadata);return}var a={data:s.data,metadata:s.metadata};try{this.receiver=i(a,s.requestN,this)}catch(o){this.onError(o)}}return r.prototype.handle=function(e){var t,n;if(!this.receiver||this.hasFragments)if(e.type===H.FrameTypes.PAYLOAD)if(H.Flags.hasFollows(e.flags)){if(_t.add(this,e.data,e.metadata))return;n="Unexpected frame size"}else{var i=_t.reassemble(this,e.data,e.metadata);try{this.receiver=this.handler(i,this.initialRequestN,this)}catch(s){this.onError(s)}return}else n="Unexpected frame type [".concat(e.type,"] during reassembly");else if(e.type===H.FrameTypes.REQUEST_N){this.receiver.request(e.requestN);return}else if(e.type===H.FrameTypes.EXT){this.receiver.onExtension(e.extendedType,e.extendedContent,H.Flags.hasIgnore(e.flags));return}else n="Unexpected frame type [".concat(e.type,"]");this.done=!0,_t.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel(),e.type!==H.FrameTypes.CANCEL&&e.type!==H.FrameTypes.ERROR&&this.stream.send({type:H.FrameTypes.ERROR,flags:H.Flags.NONE,code:Er.ErrorCodes.CANCELED,message:n,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onError=function(e){if(this.done){console.warn("Trying to error for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}this.done=!0,this.stream.send({type:H.FrameTypes.ERROR,flags:H.Flags.NONE,code:e instanceof Er.RSocketError?e.code:Er.ErrorCodes.APPLICATION_ERROR,message:e.message,streamId:this.streamId}),this.stream.disconnect(this)},r.prototype.onNext=function(e,t){var n,i;if(!this.done){if(t&&(this.done=!0),(0,qn.isFragmentable)(e,this.fragmentSize,H.FrameTypes.PAYLOAD))try{for(var s=vl((0,qn.fragment)(this.streamId,e,this.fragmentSize,H.FrameTypes.PAYLOAD,t)),a=s.next();!a.done;a=s.next()){var o=a.value;this.stream.send(o)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else this.stream.send({type:H.FrameTypes.PAYLOAD,flags:H.Flags.NEXT|(t?H.Flags.COMPLETE:H.Flags.NONE)|(e.metadata?H.Flags.METADATA:H.Flags.NONE),data:e.data,metadata:e.metadata,streamId:this.streamId});t&&this.stream.disconnect(this)}},r.prototype.onComplete=function(){this.done||(this.done=!0,this.stream.send({type:H.FrameTypes.PAYLOAD,flags:H.Flags.COMPLETE,streamId:this.streamId,data:null,metadata:null}),this.stream.disconnect(this))},r.prototype.onExtension=function(e,t,n){this.done||this.stream.send({type:H.FrameTypes.EXT,streamId:this.streamId,flags:n?H.Flags.IGNORE:H.Flags.NONE,extendedType:e,extendedContent:t})},r.prototype.close=function(e){var t;if(this.done){console.warn("Trying to close for the second time. ".concat(e?"Dropping error [".concat(e,"]."):""));return}_t.cancel(this),(t=this.receiver)===null||t===void 0||t.cancel()},r}();Ir.RequestStreamResponderStream=Mp;Object.defineProperty(De,"__esModule",{value:!0});De.KeepAliveSender=De.KeepAliveHandler=De.DefaultConnectionFrameHandler=De.DefaultStreamRequestHandler=De.LeaseHandler=De.RSocketRequester=void 0;var un=zt,Re=Xe,gl=Ar,yl=Fr,El=xr,bl=Ir,Bp=function(){function r(e,t,n){this.connection=e,this.fragmentSize=t,this.leaseManager=n}return r.prototype.fireAndForget=function(e,t){var n=new yl.RequestFnFRequesterStream(e,t,this.fragmentSize,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(n):this.connection.multiplexerDemultiplexer.createRequestStream(n),n},r.prototype.requestResponse=function(e,t){var n=new El.RequestResponseRequesterStream(e,t,this.fragmentSize,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(n):this.connection.multiplexerDemultiplexer.createRequestStream(n),n},r.prototype.requestStream=function(e,t,n){var i=new bl.RequestStreamRequesterStream(e,n,this.fragmentSize,t,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(i):this.connection.multiplexerDemultiplexer.createRequestStream(i),i},r.prototype.requestChannel=function(e,t,n,i){var s=new gl.RequestChannelRequesterStream(e,n,i,this.fragmentSize,t,this.leaseManager);return this.leaseManager?this.leaseManager.requestLease(s):this.connection.multiplexerDemultiplexer.createRequestStream(s),s},r.prototype.metadataPush=function(e,t){throw new Error("Method not implemented.")},r.prototype.close=function(e){this.connection.close(e)},r.prototype.onClose=function(e){this.connection.onClose(e)},r}();De.RSocketRequester=Bp;var qp=function(){function r(e,t){this.maxPendingRequests=e,this.multiplexer=t,this.pendingRequests=[],this.expirationTime=0,this.availableLease=0}return r.prototype.handle=function(e){for(this.expirationTime=e.ttl+Date.now(),this.availableLease=e.requestCount;this.availableLease>0&&this.pendingRequests.length>0;){var t=this.pendingRequests.shift();this.availableLease--,this.multiplexer.createRequestStream(t)}},r.prototype.requestLease=function(e){var t=this.availableLease;if(t>0&&Date.now()<this.expirationTime){this.availableLease=t-1,this.multiplexer.createRequestStream(e);return}if(this.pendingRequests.length>=this.maxPendingRequests){e.handleReject(new un.RSocketError(un.ErrorCodes.REJECTED,"No available lease given"));return}this.pendingRequests.push(e)},r.prototype.cancelRequest=function(e){var t=this.pendingRequests.indexOf(e);t>-1&&this.pendingRequests.splice(t,1)},r}();De.LeaseHandler=qp;var zp=function(){function r(e,t){this.rsocket=e,this.fragmentSize=t}return r.prototype.handle=function(e,t){switch(e.type){case Re.FrameTypes.REQUEST_FNF:this.rsocket.fireAndForget&&new yl.RequestFnfResponderStream(e.streamId,t,this.rsocket.fireAndForget.bind(this.rsocket),e);return;case Re.FrameTypes.REQUEST_RESPONSE:if(this.rsocket.requestResponse){new El.RequestResponseResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestResponse.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return;case Re.FrameTypes.REQUEST_STREAM:if(this.rsocket.requestStream){new bl.RequestStreamResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestStream.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return;case Re.FrameTypes.REQUEST_CHANNEL:if(this.rsocket.requestChannel){new gl.RequestChannelResponderStream(e.streamId,t,this.fragmentSize,this.rsocket.requestChannel.bind(this.rsocket),e);return}this.rejectRequest(e.streamId,t);return}},r.prototype.rejectRequest=function(e,t){t.send({type:Re.FrameTypes.ERROR,streamId:e,flags:Re.Flags.NONE,code:un.ErrorCodes.REJECTED,message:"No available handler found"})},r.prototype.close=function(){},r}();De.DefaultStreamRequestHandler=zp;var Hp=function(){function r(e,t,n,i,s){this.connection=e,this.keepAliveHandler=t,this.keepAliveSender=n,this.leaseHandler=i,this.rsocket=s}return r.prototype.handle=function(e){switch(e.type){case Re.FrameTypes.KEEPALIVE:this.keepAliveHandler.handle(e);return;case Re.FrameTypes.LEASE:if(this.leaseHandler){this.leaseHandler.handle(e);return}return;case Re.FrameTypes.ERROR:this.connection.close(new un.RSocketError(e.code,e.message));return;case Re.FrameTypes.METADATA_PUSH:this.rsocket.metadataPush;return;default:this.connection.multiplexerDemultiplexer.connectionOutbound.send({type:Re.FrameTypes.ERROR,streamId:0,flags:Re.Flags.NONE,message:"Received unknown frame type",code:un.ErrorCodes.CONNECTION_ERROR})}},r.prototype.pause=function(){var e;this.keepAliveHandler.pause(),(e=this.keepAliveSender)===null||e===void 0||e.pause()},r.prototype.resume=function(){var e;this.keepAliveHandler.start(),(e=this.keepAliveSender)===null||e===void 0||e.start()},r.prototype.close=function(e){var t;this.keepAliveHandler.close(),(t=this.rsocket.close)===null||t===void 0||t.call(this.rsocket,e)},r}();De.DefaultConnectionFrameHandler=Hp;var Yt;(function(r){r[r.Paused=0]="Paused",r[r.Running=1]="Running",r[r.Closed=2]="Closed"})(Yt||(Yt={}));var Gp=function(){function r(e,t){this.connection=e,this.keepAliveTimeoutDuration=t,this.state=Yt.Paused,this.outbound=e.multiplexerDemultiplexer.connectionOutbound}return r.prototype.handle=function(e){this.keepAliveLastReceivedMillis=Date.now(),Re.Flags.hasRespond(e.flags)&&this.outbound.send({type:Re.FrameTypes.KEEPALIVE,streamId:0,data:e.data,flags:e.flags^Re.Flags.RESPOND,lastReceivedPosition:0})},r.prototype.start=function(){this.state===Yt.Paused&&(this.keepAliveLastReceivedMillis=Date.now(),this.state=Yt.Running,this.activeTimeout=setTimeout(this.timeoutCheck.bind(this),this.keepAliveTimeoutDuration))},r.prototype.pause=function(){this.state===Yt.Running&&(this.state=Yt.Paused,clearTimeout(this.activeTimeout))},r.prototype.close=function(){this.state=Yt.Closed,clearTimeout(this.activeTimeout)},r.prototype.timeoutCheck=function(){var e=Date.now(),t=e-this.keepAliveLastReceivedMillis;t>=this.keepAliveTimeoutDuration?this.connection.close(new Error("No keep-alive acks for ".concat(this.keepAliveTimeoutDuration," millis"))):this.activeTimeout=setTimeout(this.timeoutCheck.bind(this),Math.max(100,this.keepAliveTimeoutDuration-t))},r}();De.KeepAliveHandler=Gp;var Xt;(function(r){r[r.Paused=0]="Paused",r[r.Running=1]="Running",r[r.Closed=2]="Closed"})(Xt||(Xt={}));var Vp=function(){function r(e,t){this.outbound=e,this.keepAlivePeriodDuration=t,this.state=Xt.Paused}return r.prototype.sendKeepAlive=function(){this.outbound.send({type:Re.FrameTypes.KEEPALIVE,streamId:0,data:void 0,flags:Re.Flags.RESPOND,lastReceivedPosition:0})},r.prototype.start=function(){this.state===Xt.Paused&&(this.state=Xt.Running,this.activeInterval=setInterval(this.sendKeepAlive.bind(this),this.keepAlivePeriodDuration))},r.prototype.pause=function(){this.state===Xt.Running&&(this.state=Xt.Paused,clearInterval(this.activeInterval))},r.prototype.close=function(){this.state=Xt.Closed,clearInterval(this.activeInterval)},r}();De.KeepAliveSender=Vp;var Zr={},Ta;function _l(){if(Ta)return Zr;Ta=1;var r=T&&T.__values||function(i){var s=typeof Symbol=="function"&&Symbol.iterator,a=s&&i[s],o=0;if(a)return a.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.FrameStore=void 0;var e=jn(),t=bs,n=function(){function i(){this.storedFrames=[],this._lastReceivedFramePosition=0,this._firstAvailableFramePosition=0,this._lastSentFramePosition=0}return Object.defineProperty(i.prototype,"lastReceivedFramePosition",{get:function(){return this._lastReceivedFramePosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"firstAvailableFramePosition",{get:function(){return this._firstAvailableFramePosition},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lastSentFramePosition",{get:function(){return this._lastSentFramePosition},enumerable:!1,configurable:!0}),i.prototype.store=function(s){this._lastSentFramePosition+=(0,t.sizeOfFrame)(s),this.storedFrames.push(s)},i.prototype.record=function(s){this._lastReceivedFramePosition+=(0,t.sizeOfFrame)(s)},i.prototype.dropTo=function(s){for(var a=s-this._firstAvailableFramePosition;a>0&&this.storedFrames.length>0;){var o=this.storedFrames.shift();a-=(0,t.sizeOfFrame)(o)}if(a!==0)throw new e.RSocketError(e.ErrorCodes.CONNECTION_ERROR,"State inconsistency. Expected bytes to drop ".concat(s-this._firstAvailableFramePosition," but actual ").concat(a));this._firstAvailableFramePosition=s},i.prototype.drain=function(s){var a,o;try{for(var l=r(this.storedFrames),u=l.next();!u.done;u=l.next()){var c=u.value;s(c)}}catch(d){a={error:d}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}},i}();return Zr.FrameStore=n,Zr}var Aa;function Qp(){if(Aa)return jr;Aa=1;var r=T&&T.__awaiter||function(o,l,u,c){function d(f){return f instanceof u?f:new u(function(h){h(f)})}return new(u||(u=Promise))(function(f,h){function v(E){try{m(c.next(E))}catch(w){h(w)}}function g(E){try{m(c.throw(E))}catch(w){h(w)}}function m(E){E.done?f(E.value):d(E.value).then(v,g)}m((c=c.apply(o,l||[])).next())})},e=T&&T.__generator||function(o,l){var u={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},c,d,f,h;return h={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function v(m){return function(E){return g([m,E])}}function g(m){if(c)throw new TypeError("Generator is already executing.");for(;u;)try{if(c=1,d&&(f=m[0]&2?d.return:m[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,m[1])).done)return f;switch(d=0,f&&(m=[m[0]&2,f.value]),m[0]){case 0:case 1:f=m;break;case 4:return u.label++,{value:m[1],done:!1};case 5:u.label++,d=m[1],m=[0];continue;case 7:m=u.ops.pop(),u.trys.pop();continue;default:if(f=u.trys,!(f=f.length>0&&f[f.length-1])&&(m[0]===6||m[0]===2)){u=0;continue}if(m[0]===3&&(!f||m[1]>f[0]&&m[1]<f[3])){u.label=m[1];break}if(m[0]===6&&u.label<f[1]){u.label=f[1],f=m;break}if(f&&u.label<f[2]){u.label=f[2],u.ops.push(m);break}f[2]&&u.ops.pop(),u.trys.pop();continue}m=l.call(o,u)}catch(E){m=[6,E],d=0}finally{c=f=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(jr,"__esModule",{value:!0}),jr.RSocketConnector=void 0;var t=hl(),n=Xe,i=De,s=_l(),a=function(){function o(l){this.config=l}return o.prototype.connect=function(){var l,u,c,d,f,h,v,g,m,E,w,A,S,B,M,W,Z,P,oe,ne;return r(this,void 0,void 0,function(){var N,ie,re,q,me,Ae,_e,ye,Pe,Oe=this;return e(this,function(Fe){switch(Fe.label){case 0:return N=this.config,ie={type:n.FrameTypes.SETUP,dataMimeType:(u=(l=N.setup)===null||l===void 0?void 0:l.dataMimeType)!==null&&u!==void 0?u:"application/octet-stream",metadataMimeType:(d=(c=N.setup)===null||c===void 0?void 0:c.metadataMimeType)!==null&&d!==void 0?d:"application/octet-stream",keepAlive:(h=(f=N.setup)===null||f===void 0?void 0:f.keepAlive)!==null&&h!==void 0?h:6e4,lifetime:(g=(v=N.setup)===null||v===void 0?void 0:v.lifetime)!==null&&g!==void 0?g:3e5,metadata:(E=(m=N.setup)===null||m===void 0?void 0:m.payload)===null||E===void 0?void 0:E.metadata,data:(A=(w=N.setup)===null||w===void 0?void 0:w.payload)===null||A===void 0?void 0:A.data,resumeToken:(B=(S=N.resume)===null||S===void 0?void 0:S.tokenGenerator())!==null&&B!==void 0?B:null,streamId:0,majorVersion:1,minorVersion:0,flags:(!((W=(M=N.setup)===null||M===void 0?void 0:M.payload)===null||W===void 0)&&W.metadata?n.Flags.METADATA:n.Flags.NONE)|(N.lease?n.Flags.LEASE:n.Flags.NONE)|(N.resume?n.Flags.RESUME_ENABLE:n.Flags.NONE)},[4,N.transport.connect(function(D){return N.resume?new t.ResumableClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(-1),D,D,new s.FrameStore,ie.resumeToken.toString(),function(It,Ct){return r(Oe,void 0,void 0,function(){var Ot,$e,je;return e(this,function(Je){switch(Je.label){case 0:return Ot=function(Ze){return Ze.send({type:n.FrameTypes.RESUME,streamId:0,flags:n.Flags.NONE,clientPosition:Ct.firstAvailableFramePosition,serverPosition:Ct.lastReceivedFramePosition,majorVersion:ie.minorVersion,minorVersion:ie.majorVersion,resumeToken:ie.resumeToken}),new t.ResumeOkAwaitingResumableClientServerInputMultiplexerDemultiplexer(Ze,Ze,It)},$e=-1,je=function(){return $e++,N.resume.reconnectFunction($e).then(function(){return N.transport.connect(Ot).catch(je)})},[4,je()];case 1:return Je.sent(),[2]}})})}):new t.ClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(-1),D,D)})];case 1:return re=Fe.sent(),q=new i.KeepAliveSender(re.multiplexerDemultiplexer.connectionOutbound,ie.keepAlive),me=new i.KeepAliveHandler(re,ie.lifetime),Ae=N.lease?new i.LeaseHandler((Z=N.lease.maxPendingRequests)!==null&&Z!==void 0?Z:256,re.multiplexerDemultiplexer):void 0,_e=(P=N.responder)!==null&&P!==void 0?P:{},ye=new i.DefaultConnectionFrameHandler(re,me,q,Ae,_e),Pe=new i.DefaultStreamRequestHandler(_e,0),re.onClose(function(D){q.close(),me.close(),ye.close(D)}),re.multiplexerDemultiplexer.connectionInbound(ye),re.multiplexerDemultiplexer.handleRequestStream(Pe),re.multiplexerDemultiplexer.connectionOutbound.send(ie),me.start(),q.start(),[2,new i.RSocketRequester(re,(ne=(oe=N.fragmentation)===null||oe===void 0?void 0:oe.maxOutboundFragmentSize)!==null&&ne!==void 0?ne:0,Ae)]}})})},o}();return jr.RSocketConnector=a,jr}var Wr={},Fa;function Yp(){if(Fa)return Wr;Fa=1;var r=T&&T.__awaiter||function(l,u,c,d){function f(h){return h instanceof c?h:new c(function(v){v(h)})}return new(c||(c=Promise))(function(h,v){function g(w){try{E(d.next(w))}catch(A){v(A)}}function m(w){try{E(d.throw(w))}catch(A){v(A)}}function E(w){w.done?h(w.value):f(w.value).then(g,m)}E((d=d.apply(l,u||[])).next())})},e=T&&T.__generator||function(l,u){var c={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},d,f,h,v;return v={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function g(E){return function(w){return m([E,w])}}function m(E){if(d)throw new TypeError("Generator is already executing.");for(;c;)try{if(d=1,f&&(h=E[0]&2?f.return:E[0]?f.throw||((h=f.return)&&h.call(f),0):f.next)&&!(h=h.call(f,E[1])).done)return h;switch(f=0,h&&(E=[E[0]&2,h.value]),E[0]){case 0:case 1:h=E;break;case 4:return c.label++,{value:E[1],done:!1};case 5:c.label++,f=E[1],E=[0];continue;case 7:E=c.ops.pop(),c.trys.pop();continue;default:if(h=c.trys,!(h=h.length>0&&h[h.length-1])&&(E[0]===6||E[0]===2)){c=0;continue}if(E[0]===3&&(!h||E[1]>h[0]&&E[1]<h[3])){c.label=E[1];break}if(E[0]===6&&c.label<h[1]){c.label=h[1],h=E;break}if(h&&c.label<h[2]){c.label=h[2],c.ops.push(E);break}h[2]&&c.ops.pop(),c.trys.pop();continue}E=u.call(l,c)}catch(w){E=[6,w],f=0}finally{d=h=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.RSocketServer=void 0;var t=hl(),n=zt,i=Xe,s=De,a=_l(),o=function(){function l(u){var c,d;this.acceptor=u.acceptor,this.transport=u.transport,this.lease=u.lease,this.serverSideKeepAlive=u.serverSideKeepAlive,this.sessionStore=u.resume?{}:void 0,this.sessionTimeout=(d=(c=u.resume)===null||c===void 0?void 0:c.sessionTimeout)!==null&&d!==void 0?d:void 0}return l.prototype.bind=function(){return r(this,void 0,void 0,function(){var u=this;return e(this,function(c){switch(c.label){case 0:return[4,this.transport.bind(function(d,f){return r(u,void 0,void 0,function(){var h,v,v,g,m,E,w,A,S,B,M,W,Z,P,oe;return e(this,function(ne){switch(ne.label){case 0:switch(h=d.type,h){case i.FrameTypes.SETUP:return[3,1];case i.FrameTypes.RESUME:return[3,5]}return[3,6];case 1:return ne.trys.push([1,3,,4]),this.lease&&!i.Flags.hasLease(d.flags)?(v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"Lease has to be enabled"),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v),[2]):i.Flags.hasLease(d.flags)&&!this.lease?(v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"Lease has to be disabled"),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v),[2]):(g=i.Flags.hasLease(d.flags)?new s.LeaseHandler((W=this.lease.maxPendingRequests)!==null&&W!==void 0?W:256,f.multiplexerDemultiplexer):void 0,m=new s.RSocketRequester(f,(P=(Z=this.fragmentation)===null||Z===void 0?void 0:Z.maxOutboundFragmentSize)!==null&&P!==void 0?P:0,g),[4,this.acceptor.accept({data:d.data,dataMimeType:d.dataMimeType,metadata:d.metadata,metadataMimeType:d.metadataMimeType,flags:d.flags,keepAliveMaxLifetime:d.lifetime,keepAliveInterval:d.keepAlive,resumeToken:d.resumeToken},m)]);case 2:return E=ne.sent(),w=new s.KeepAliveHandler(f,d.lifetime),A=this.serverSideKeepAlive?new s.KeepAliveSender(f.multiplexerDemultiplexer.connectionOutbound,d.keepAlive):void 0,S=new s.DefaultConnectionFrameHandler(f,w,A,g,E),B=new s.DefaultStreamRequestHandler(E,0),f.onClose(function(N){A==null||A.close(),w.close(),S.close(N)}),f.multiplexerDemultiplexer.connectionInbound(S),f.multiplexerDemultiplexer.handleRequestStream(B),w.start(),A==null||A.start(),[3,4];case 3:return M=ne.sent(),f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_SETUP,message:(oe=M.message)!==null&&oe!==void 0?oe:"",flags:i.Flags.NONE}),f.close(M instanceof n.RSocketError?M:new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,M.message)),[3,4];case 4:return[2];case 5:return[2];case 6:f.multiplexerDemultiplexer.connectionOutbound.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.UNSUPPORTED_SETUP,message:"Unsupported setup",flags:i.Flags.NONE}),f.close(new n.RSocketError(n.ErrorCodes.UNSUPPORTED_SETUP)),ne.label=7;case 7:return[2]}})})},function(d,f){if(d.type===i.FrameTypes.RESUME){if(u.sessionStore){var h=u.sessionStore[d.resumeToken.toString()];if(!h){f.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_RESUME,message:"No session found for the given resume token",flags:i.Flags.NONE}),f.close();return}return h.resume(d,f,f),h}f.send({type:i.FrameTypes.ERROR,streamId:0,code:n.ErrorCodes.REJECTED_RESUME,message:"Resume is not enabled",flags:i.Flags.NONE}),f.close();return}else if(d.type===i.FrameTypes.SETUP&&i.Flags.hasResume(d.flags)){if(!u.sessionStore){var v=new n.RSocketError(n.ErrorCodes.REJECTED_SETUP,"No resume support");f.send({type:i.FrameTypes.ERROR,streamId:0,flags:i.Flags.NONE,code:v.code,message:v.message}),f.close(v);return}var g=new t.ResumableClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(0),f,f,new a.FrameStore,d.resumeToken.toString(),u.sessionStore,u.sessionTimeout);return u.sessionStore[d.resumeToken.toString()]=g,g}return new t.ClientServerInputMultiplexerDemultiplexer(t.StreamIdGenerator.create(0),f,f)})];case 1:return[2,c.sent()]}})})},l}();return Wr.RSocketServer=o,Wr}var wl={};Object.defineProperty(wl,"__esModule",{value:!0});var xa;function jn(){return xa||(xa=1,function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,a){a===void 0&&(a=s),Object.defineProperty(n,a,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,a){a===void 0&&(a=s),n[a]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(bs,r),t(dl,r),t(fn,r),t(zt,r),t(Xe,r),t(fl,r),t(Qp(),r),t(Yp(),r),t(wl,r)}(Ii)),Ii}var Ia=jn(),Sl={},ue={},_s={};(function(r){var e=T&&T.__values||function(n){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&n[i],a=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&a>=n.length&&(n=void 0),{value:n&&n[a++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.WellKnownMimeType=void 0;var t=function(){function n(i,s){this.string=i,this.identifier=s}return n.fromIdentifier=function(i){return i<0||i>127?n.UNPARSEABLE_MIME_TYPE:n.TYPES_BY_MIME_ID[i]},n.fromString=function(i){if(!i)throw new Error("type must be non-null");return i===n.UNKNOWN_RESERVED_MIME_TYPE.string?n.UNPARSEABLE_MIME_TYPE:n.TYPES_BY_MIME_STRING.get(i)||n.UNPARSEABLE_MIME_TYPE},n.prototype.toString=function(){return this.string},n}();r.WellKnownMimeType=t,function(n){var i,s;n.UNPARSEABLE_MIME_TYPE=new n("UNPARSEABLE_MIME_TYPE_DO_NOT_USE",-2),n.UNKNOWN_RESERVED_MIME_TYPE=new n("UNKNOWN_YET_RESERVED_DO_NOT_USE",-1),n.APPLICATION_AVRO=new n("application/avro",0),n.APPLICATION_CBOR=new n("application/cbor",1),n.APPLICATION_GRAPHQL=new n("application/graphql",2),n.APPLICATION_GZIP=new n("application/gzip",3),n.APPLICATION_JAVASCRIPT=new n("application/javascript",4),n.APPLICATION_JSON=new n("application/json",5),n.APPLICATION_OCTET_STREAM=new n("application/octet-stream",6),n.APPLICATION_PDF=new n("application/pdf",7),n.APPLICATION_THRIFT=new n("application/vnd.apache.thrift.binary",8),n.APPLICATION_PROTOBUF=new n("application/vnd.google.protobuf",9),n.APPLICATION_XML=new n("application/xml",10),n.APPLICATION_ZIP=new n("application/zip",11),n.AUDIO_AAC=new n("audio/aac",12),n.AUDIO_MP3=new n("audio/mp3",13),n.AUDIO_MP4=new n("audio/mp4",14),n.AUDIO_MPEG3=new n("audio/mpeg3",15),n.AUDIO_MPEG=new n("audio/mpeg",16),n.AUDIO_OGG=new n("audio/ogg",17),n.AUDIO_OPUS=new n("audio/opus",18),n.AUDIO_VORBIS=new n("audio/vorbis",19),n.IMAGE_BMP=new n("image/bmp",20),n.IMAGE_GIG=new n("image/gif",21),n.IMAGE_HEIC_SEQUENCE=new n("image/heic-sequence",22),n.IMAGE_HEIC=new n("image/heic",23),n.IMAGE_HEIF_SEQUENCE=new n("image/heif-sequence",24),n.IMAGE_HEIF=new n("image/heif",25),n.IMAGE_JPEG=new n("image/jpeg",26),n.IMAGE_PNG=new n("image/png",27),n.IMAGE_TIFF=new n("image/tiff",28),n.MULTIPART_MIXED=new n("multipart/mixed",29),n.TEXT_CSS=new n("text/css",30),n.TEXT_CSV=new n("text/csv",31),n.TEXT_HTML=new n("text/html",32),n.TEXT_PLAIN=new n("text/plain",33),n.TEXT_XML=new n("text/xml",34),n.VIDEO_H264=new n("video/H264",35),n.VIDEO_H265=new n("video/H265",36),n.VIDEO_VP8=new n("video/VP8",37),n.APPLICATION_HESSIAN=new n("application/x-hessian",38),n.APPLICATION_JAVA_OBJECT=new n("application/x-java-object",39),n.APPLICATION_CLOUDEVENTS_JSON=new n("application/cloudevents+json",40),n.MESSAGE_RSOCKET_MIMETYPE=new n("message/x.rsocket.mime-type.v0",122),n.MESSAGE_RSOCKET_ACCEPT_MIMETYPES=new n("message/x.rsocket.accept-mime-types.v0",123),n.MESSAGE_RSOCKET_AUTHENTICATION=new n("message/x.rsocket.authentication.v0",124),n.MESSAGE_RSOCKET_TRACING_ZIPKIN=new n("message/x.rsocket.tracing-zipkin.v0",125),n.MESSAGE_RSOCKET_ROUTING=new n("message/x.rsocket.routing.v0",126),n.MESSAGE_RSOCKET_COMPOSITE_METADATA=new n("message/x.rsocket.composite-metadata.v0",127),n.TYPES_BY_MIME_ID=new Array(128),n.TYPES_BY_MIME_STRING=new Map;var a=[n.UNPARSEABLE_MIME_TYPE,n.UNKNOWN_RESERVED_MIME_TYPE,n.APPLICATION_AVRO,n.APPLICATION_CBOR,n.APPLICATION_GRAPHQL,n.APPLICATION_GZIP,n.APPLICATION_JAVASCRIPT,n.APPLICATION_JSON,n.APPLICATION_OCTET_STREAM,n.APPLICATION_PDF,n.APPLICATION_THRIFT,n.APPLICATION_PROTOBUF,n.APPLICATION_XML,n.APPLICATION_ZIP,n.AUDIO_AAC,n.AUDIO_MP3,n.AUDIO_MP4,n.AUDIO_MPEG3,n.AUDIO_MPEG,n.AUDIO_OGG,n.AUDIO_OPUS,n.AUDIO_VORBIS,n.IMAGE_BMP,n.IMAGE_GIG,n.IMAGE_HEIC_SEQUENCE,n.IMAGE_HEIC,n.IMAGE_HEIF_SEQUENCE,n.IMAGE_HEIF,n.IMAGE_JPEG,n.IMAGE_PNG,n.IMAGE_TIFF,n.MULTIPART_MIXED,n.TEXT_CSS,n.TEXT_CSV,n.TEXT_HTML,n.TEXT_PLAIN,n.TEXT_XML,n.VIDEO_H264,n.VIDEO_H265,n.VIDEO_VP8,n.APPLICATION_HESSIAN,n.APPLICATION_JAVA_OBJECT,n.APPLICATION_CLOUDEVENTS_JSON,n.MESSAGE_RSOCKET_MIMETYPE,n.MESSAGE_RSOCKET_ACCEPT_MIMETYPES,n.MESSAGE_RSOCKET_AUTHENTICATION,n.MESSAGE_RSOCKET_TRACING_ZIPKIN,n.MESSAGE_RSOCKET_ROUTING,n.MESSAGE_RSOCKET_COMPOSITE_METADATA];n.TYPES_BY_MIME_ID.fill(n.UNKNOWN_RESERVED_MIME_TYPE);try{for(var o=e(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.identifier>=0&&(n.TYPES_BY_MIME_ID[u.identifier]=u,n.TYPES_BY_MIME_STRING.set(u.string,u))}}catch(c){i={error:c}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}Object.seal&&Object.seal(n.TYPES_BY_MIME_ID)}(t=r.WellKnownMimeType||(r.WellKnownMimeType={})),r.WellKnownMimeType=t})(_s);var Xp=T&&T.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},$p=T&&T.__values||function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},jp=T&&T.__read||function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s};Object.defineProperty(ue,"__esModule",{value:!0});ue.WellKnownMimeTypeEntry=ue.ReservedMimeTypeEntry=ue.ExplicitMimeTimeEntry=ue.decodeCompositeMetadata=ue.encodeWellKnownMetadataHeader=ue.encodeCustomMetadataHeader=ue.decodeMimeTypeFromMimeBuffer=ue.decodeMimeAndContentBuffersSlices=ue.encodeAndAddWellKnownMetadata=ue.encodeAndAddCustomMetadata=ue.encodeCompositeMetadata=ue.CompositeMetadata=void 0;var ws=jn(),zn=_s,Jp=function(){function r(e){this._buffer=e}return r.prototype.iterator=function(){return Zi(this._buffer)},r.prototype[Symbol.iterator]=function(){return Zi(this._buffer)},r}();ue.CompositeMetadata=Jp;function Zp(r){var e,t,n=I.Buffer.allocUnsafe(0);try{for(var i=$p(r),s=i.next();!s.done;s=i.next()){var a=jp(s.value,2),o=a[0],l=a[1],u=typeof l=="function"?l():l;o instanceof zn.WellKnownMimeType||typeof o=="number"||o.constructor.name==="WellKnownMimeType"?n=Tl(n,o,u):n=Rl(n,o,u)}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n}ue.encodeCompositeMetadata=Zp;function Rl(r,e,t){return I.Buffer.concat([r,xl(e,t.byteLength),t])}ue.encodeAndAddCustomMetadata=Rl;function Tl(r,e,t){var n;return Number.isInteger(e)?n=e:n=e.identifier,I.Buffer.concat([r,Il(n,t.byteLength),t])}ue.encodeAndAddWellKnownMetadata=Tl;function Al(r,e){var t=r.readInt8(e),n,i=e;if((t&Wi)===Wi)n=r.slice(i,i+1),i+=1;else{var s=(t&255)+1;if(r.byteLength>i+s)n=r.slice(i,i+s+1),i+=s+1;else throw new Error("Metadata is malformed. Inappropriately formed Mime Length")}if(r.byteLength>=i+3){var a=(0,ws.readUInt24BE)(r,i);if(i+=3,r.byteLength>=a+i){var o=r.slice(i,i+a);return[n,o]}else throw new Error("Metadata is malformed. Inappropriately formed Metadata Length or malformed content")}else throw new Error("Metadata is malformed. Metadata Length is absent or malformed")}ue.decodeMimeAndContentBuffersSlices=Al;function Fl(r){if(r.length<2)throw new Error("Unable to decode explicit MIME type");return r.toString("ascii",1)}ue.decodeMimeTypeFromMimeBuffer=Fl;function xl(r,e){var t=I.Buffer.allocUnsafe(4+r.length);t.fill(0);var n=t.write(r,1);if(!tm(t,1))throw new Error("Custom mime type must be US_ASCII characters only");if(n<1||n>128)throw new Error("Custom mime type must have a strictly positive length that fits on 7 unsigned bits, ie 1-128");return t.writeUInt8(n-1),(0,ws.writeUInt24BE)(t,e,n+1),t}ue.encodeCustomMetadataHeader=xl;function Il(r,e){var t=I.Buffer.allocUnsafe(4);return t.writeUInt8(r|Wi),(0,ws.writeUInt24BE)(t,e,1),t}ue.encodeWellKnownMetadataHeader=Il;function Zi(r){var e,t,n,i,s,a,o,l;return Xp(this,function(u){switch(u.label){case 0:e=r.byteLength,t=0,u.label=1;case 1:if(!(t<e))return[3,7];if(n=Al(r,t),i=n[0],s=n[1],t=Kp(t,i,s),Nl(i))return[3,3];if(a=Fl(i),!a)throw new Error("MIME type cannot be null");return[4,new Cl(s,a)];case 2:return u.sent(),[3,1];case 3:return o=Wp(i),l=zn.WellKnownMimeType.fromIdentifier(o),zn.WellKnownMimeType.UNKNOWN_RESERVED_MIME_TYPE!==l?[3,5]:[4,new Ol(s,o)];case 4:return u.sent(),[3,1];case 5:return[4,new Ul(s,l)];case 6:return u.sent(),[3,1];case 7:return[2]}})}ue.decodeCompositeMetadata=Zi;var Cl=function(){function r(e,t){this.content=e,this.type=t}return r}();ue.ExplicitMimeTimeEntry=Cl;var Ol=function(){function r(e,t){this.content=e,this.type=t}return Object.defineProperty(r.prototype,"mimeType",{get:function(){},enumerable:!1,configurable:!0}),r}();ue.ReservedMimeTypeEntry=Ol;var Ul=function(){function r(e,t){this.content=e,this.type=t}return Object.defineProperty(r.prototype,"mimeType",{get:function(){return this.type.string},enumerable:!1,configurable:!0}),r}();ue.WellKnownMimeTypeEntry=Ul;function Wp(r){return Nl(r)?r.readInt8()&em:zn.WellKnownMimeType.UNPARSEABLE_MIME_TYPE.identifier}function Kp(r,e,t){return r+e.byteLength+3+t.byteLength}function Nl(r){return r.byteLength===1}var Wi=128,em=127;function tm(r,e){for(var t=!0,n=e,i=r.length;n<i;n++)if(r[n]>127){t=!1;break}return t}var qe={},Ss={};(function(r){var e=T&&T.__values||function(n){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&n[i],a=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&a>=n.length&&(n=void 0),{value:n&&n[a++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(r,"__esModule",{value:!0}),r.WellKnownAuthType=void 0;var t=function(){function n(i,s){this.string=i,this.identifier=s}return n.fromIdentifier=function(i){return i<0||i>127?n.UNPARSEABLE_AUTH_TYPE:n.TYPES_BY_AUTH_ID[i]},n.fromString=function(i){if(!i)throw new Error("type must be non-null");return i===n.UNKNOWN_RESERVED_AUTH_TYPE.string?n.UNPARSEABLE_AUTH_TYPE:n.TYPES_BY_AUTH_STRING.get(i)||n.UNPARSEABLE_AUTH_TYPE},n.prototype.toString=function(){return this.string},n}();r.WellKnownAuthType=t,function(n){var i,s;n.UNPARSEABLE_AUTH_TYPE=new n("UNPARSEABLE_AUTH_TYPE_DO_NOT_USE",-2),n.UNKNOWN_RESERVED_AUTH_TYPE=new n("UNKNOWN_YET_RESERVED_DO_NOT_USE",-1),n.SIMPLE=new n("simple",0),n.BEARER=new n("bearer",1),n.TYPES_BY_AUTH_ID=new Array(128),n.TYPES_BY_AUTH_STRING=new Map;var a=[n.UNPARSEABLE_AUTH_TYPE,n.UNKNOWN_RESERVED_AUTH_TYPE,n.SIMPLE,n.BEARER];n.TYPES_BY_AUTH_ID.fill(n.UNKNOWN_RESERVED_AUTH_TYPE);try{for(var o=e(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.identifier>=0&&(n.TYPES_BY_AUTH_ID[u.identifier]=u,n.TYPES_BY_AUTH_STRING.set(u.string,u))}}catch(c){i={error:c}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}Object.seal&&Object.seal(n.TYPES_BY_AUTH_ID)}(t=r.WellKnownAuthType||(r.WellKnownAuthType={})),r.WellKnownAuthType=t})(Ss);Object.defineProperty(qe,"__esModule",{value:!0});qe.decodeSimpleAuthPayload=qe.decodeAuthMetadata=qe.encodeBearerAuthMetadata=qe.encodeSimpleAuthMetadata=qe.encodeCustomAuthMetadata=qe.encodeWellKnownAuthMetadata=void 0;var Cr=Ss,Rs=1,cr=1,ar=2,Ts=128,rm=127;function nm(r,e){if(r===Cr.WellKnownAuthType.UNPARSEABLE_AUTH_TYPE||r===Cr.WellKnownAuthType.UNKNOWN_RESERVED_AUTH_TYPE)throw new Error("Illegal WellKnownAuthType[".concat(r.toString(),"]. Only allowed AuthType should be used"));var t=I.Buffer.allocUnsafe(Rs);return t.writeUInt8(r.identifier|Ts),I.Buffer.concat([t,e])}qe.encodeWellKnownAuthMetadata=nm;function im(r,e){var t=I.Buffer.from(r);if(t.byteLength!==r.length)throw new Error("Custom auth type must be US_ASCII characters only");if(t.byteLength<1||t.byteLength>128)throw new Error("Custom auth type must have a strictly positive length that fits on 7 unsigned bits, ie 1-128");var n=I.Buffer.allocUnsafe(cr+t.byteLength);return n.writeUInt8(t.byteLength-1),n.write(r,cr),I.Buffer.concat([n,e])}qe.encodeCustomAuthMetadata=im;function sm(r,e){var t=I.Buffer.from(r),n=I.Buffer.from(e),i=t.byteLength;if(i>65535)throw new Error("Username should be shorter than or equal to 65535 bytes length in UTF-8 encoding but the given was ".concat(i));var s=Rs+ar,a=I.Buffer.allocUnsafe(s);return a.writeUInt8(Cr.WellKnownAuthType.SIMPLE.identifier|Ts),a.writeUInt16BE(i,1),I.Buffer.concat([a,t,n])}qe.encodeSimpleAuthMetadata=sm;function am(r){var e=I.Buffer.from(r),t=I.Buffer.allocUnsafe(Rs);return t.writeUInt8(Cr.WellKnownAuthType.BEARER.identifier|Ts),I.Buffer.concat([t,e])}qe.encodeBearerAuthMetadata=am;function om(r){if(r.byteLength<1)throw new Error("Unable to decode Auth metadata. Not enough readable bytes");var e=r.readUInt8(),t=e&rm;if(t!==e){var n=Cr.WellKnownAuthType.fromIdentifier(t);return{payload:r.slice(1),type:{identifier:n.identifier,string:n.string}}}else{var i=e+1;if(r.byteLength<i+cr)throw new Error("Unable to decode custom Auth type. Malformed length or auth type string");var s=r.toString("utf8",cr,cr+i),a=r.slice(i+cr);return{payload:a,type:{identifier:Cr.WellKnownAuthType.UNPARSEABLE_AUTH_TYPE.identifier,string:s}}}}qe.decodeAuthMetadata=om;function lm(r){if(r.byteLength<ar)throw new Error("Unable to decode Simple Auth Payload. Not enough readable bytes");var e=r.readUInt16BE();if(r.byteLength<e+ar)throw new Error("Unable to decode Simple Auth Payload. Not enough readable bytes");var t=r.slice(ar,ar+e),n=r.slice(ar+e);return{password:n,username:t}}qe.decodeSimpleAuthPayload=lm;var St={},um=T&&T.__generator||function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(St,"__esModule",{value:!0});St.decodeRoutes=St.encodeRoute=St.encodeRoutes=St.RoutingMetadata=void 0;var cm=function(){function r(e){this._buffer=e}return r.prototype.iterator=function(){return Ki(this._buffer)},r.prototype[Symbol.iterator]=function(){return Ki(this._buffer)},r}();St.RoutingMetadata=cm;function dm(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(r.length<1)throw new Error("routes should be non empty array");return I.Buffer.concat(r.map(function(t){return Dl(t)}))}St.encodeRoutes=dm;function Dl(r){var e=I.Buffer.from(r,"utf8");if(e.length>255)throw new Error("route length should fit into unsigned byte length but the given one is ".concat(e.length));var t=I.Buffer.allocUnsafe(1);return t.writeUInt8(e.length),I.Buffer.concat([t,e])}St.encodeRoute=Dl;function Ki(r){var e,t,n,i;return um(this,function(s){switch(s.label){case 0:e=r.byteLength,t=0,s.label=1;case 1:if(!(t<e))return[3,3];if(n=r.readUInt8(t++),t+n>e)throw new Error("Malformed RouteMetadata. Offset(".concat(t,") + RouteLength(").concat(n,") is greater than TotalLength"));return i=r.toString("utf8",t,t+n),t+=n,[4,i];case 2:return s.sent(),[3,1];case 3:return[2]}})}St.decodeRoutes=Ki;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,a){a===void 0&&(a=s),Object.defineProperty(n,a,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,a){a===void 0&&(a=s),n[a]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(ue,r),t(_s,r),t(qe,r),t(St,r),t(Ss,r)})(Sl);function hn(r,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})})}class As extends ir{constructor(t,n,i){super();F(this,"requested");F(this,"subscriber");F(this,"inputCodec");F(this,"wip");F(this,"e");F(this,"done");this.init(t,n,i)}init(t,n,i){this.requested=t,this.subscriber=n,this.inputCodec=i,this.wip=0}request(t){const n=this.requested;this.requested=n+t,!(this.wip==0&&n>0)&&this.drain()}cancel(){this.closed||this.done||(this.unsubscribe(),this.drain())}onExtension(t,n,i){}next(t){this.push(t),this.drain()}error(t){this.closed||this.done||(this.e=t,this.done=!0,this.drain())}complete(){this.done||this.closed||(this.done=!0,this.drain())}drain(){let t=this.wip;if(this.wip=t+1,!t)for(t=1;;){let n=this.requested,i=0;for(;i<n;){const s=this.shift();if(s==null){if(this.done){this.e?this.subscriber.onError(this.e):this.subscriber.onComplete();return}if(this.closed)return;break}const a=this.length==0&&this.done;if(this.subscriber.onNext({data:this.inputCodec.encode(s)},a),a)return;i++}if(this.requested-=i,t===this.wip){this.wip=0;return}t=this.wip}}}hn(As,[Array]);class Pl extends ze{constructor(t,n,i,s=Nr){super();F(this,"exchangeFunction");F(this,"prefetch");F(this,"responseCodec");F(this,"scheduler");F(this,"limit");F(this,"observer");F(this,"subscriber");F(this,"received",0);this.exchangeFunction=t,this.prefetch=n,this.responseCodec=i,this.scheduler=s,this.limit=n-(n>>2)}onNext(t,n){if(this.received++,this.observer.next(this.responseCodec.decode(t.data)),n){this.observer.complete();return}if(this.received%this.limit===0){this.scheduler.schedule(()=>this.subscriber.request(this.limit));return}}onError(t){this.observer.error(t)}onComplete(){this.observer.complete()}onExtension(t,n,i){}unsubscribe(){this.subscriber&&this.subscriber.cancel()}_subscribe(t){if(this.observer)throw new Error("Subscribing twice is disallowed");return this.observer=t,this.subscriber=this.exchangeFunction(this,this.prefetch),this}}class fm extends Pl{constructor(t,n,i,s,a,o=Nr){super(t,n,a,o);F(this,"restObservable");this.restObservable=i,this.init(0,void 0,s)}_subscribe(t){return super._subscribe(t),this.restObservable.subscribe(this),this}unsubscribe(){this.subscriber.cancel(),super.unsubscribe()}}hn(fm,[As]);class kl extends ir{constructor(t,n){super();F(this,"requested");F(this,"subscriber");F(this,"wip");F(this,"e");F(this,"done");this.init(t,n)}init(t,n){this.requested=t,this.subscriber=n,this.wip=0}request(t){const n=this.requested;this.requested=n+t,!(this.wip==0&&n>0)&&this.drain()}cancel(){this.closed||this.done||(this.unsubscribe(),this.drain())}onExtension(t,n,i){}next(t){this.push(t),this.drain()}error(t){this.closed||this.done||(this.e=t,this.done=!0,this.drain())}complete(){this.done||this.closed||(this.done=!0,this.drain())}drain(){let t=this.wip;if(this.wip=t+1,!t)for(t=1;;){let n=this.requested,i=0;for(;i<n;){const s=this.shift();if(s==null){if(this.done){this.e?this.subscriber.onError(this.e):this.subscriber.onComplete();return}if(this.closed)return;break}const a=this.length==0&&this.done;if(this.subscriber.onNext(s,a),a)return;i++}if(this.requested-=i,t===this.wip){this.wip=0;return}t=this.wip}}}hn(kl,[Array]);class hm extends ze{constructor(t,n,i=Nr){super();F(this,"exchangeFunction");F(this,"prefetch");F(this,"scheduler");F(this,"limit");F(this,"observer");F(this,"subscriber");F(this,"received",0);this.exchangeFunction=t,this.prefetch=n,this.scheduler=i,this.limit=n-(n>>2)}onNext(t,n){if(this.received++,this.observer.next(t),n){this.observer.complete();return}if(this.received%this.limit===0){this.scheduler.schedule(()=>this.subscriber.request(this.limit));return}}onError(t){this.observer.error(t)}onComplete(){this.observer.complete()}onExtension(t,n,i){}unsubscribe(){this.subscriber&&this.subscriber.cancel()}_subscribe(t){if(this.observer)throw new Error("Subscribing twice is disallowed");return this.observer=t,this.subscriber=this.exchangeFunction(this,this.prefetch),this}}class Ll extends hm{constructor(t,n,i,s=Nr){super(t,n,s);F(this,"restObservable");this.restObservable=i,this.init(0,void 0)}_subscribe(t){return super._subscribe(t),this.restObservable.subscribe(this),this}unsubscribe(){this.subscriber&&this.subscriber.cancel(),super.unsubscribe()}}hn(Ll,[kl]);function pm(r,e=256,t=Nr){let n=!1;const[i,s]=lp(r.pipe(cp({connector:()=>new Es,resetOnRefCountZero:!0})),a=>{const o=n;return o||(n=!0),!o});return(a,o)=>(o&&Sl.encodeCompositeMetadata(o),i.pipe(up(1),cl(l=>new Ll(u=>a.requestChannel(l,e,!1,u),e,s,t))))}class mm extends Pl{constructor(t,n,i,s,a,o,l,u=Nr){super(()=>i,a,o,u);F(this,"firstPayload");F(this,"isCompleted");this.firstPayload=t,this.isCompleted=n,this.init(s,i,l)}_subscribe(t){return super._subscribe(t),this.onNext(this.firstPayload,this.isCompleted),this.isCompleted||this.scheduler.schedule(()=>this.subscriber.request(this.prefetch-1)),this}}hn(mm,[As]);class vm{constructor(){F(this,"mimeType","application/x-msgpack")}decode(e){return tf(e)}encode(e){return I.Buffer.from(Ao(e))}}const gm=new vm;function ym(r){const e=new TextDecoder("utf-8").decode(r),[t,n]=e.split(".");if(n)return JSON.parse(atob(n));throw new Error("invalid module, no claims found")}function Ca(r,e,t){return new uh({workerUrl:e,module:r,wasi:t})}function Oa(r){const e=r.customSection("wick/claims@v1");try{return ym(e[0]).wascap.interface}catch(t){return console.warn("failed to decode claims, this will be an error in the future",t),{name:"unknown",format:-1,metadata:{version:"unknown"},operations:[]}}}class Hn{constructor(e,t,n){F(this,"instance");F(this,"connection");F(this,"signature");this.instance=e,this.connection=n,this.signature=t}get operations(){return this.instance.operations}rsocket(){return this.connection}async instantiate(e={}){const t=new Em(this,e);return await t.initialized(),t}static async FromBytes(e,t){const n=await Dt.compile(e),i=Oa(n);let s;t.wasi&&(s={version:t.wasi.version,stdin:t.wasi.stdin,stdout:t.wasi.stdout,stderr:t.wasi.stderr});const a=await n.instantiate({wasi:s}),o=new Ia.RSocketConnector({setup:{keepAlive:1e4,lifetime:20*1e3},transport:Ca(n,t.workerUrl,t.wasi)});return new Hn(a,i,await o.connect())}static async FromResponse(e,t){const n=await Dt.compileStreaming(e),i=Oa(n);let s;t.wasi&&(s={version:t.wasi.version,stdin:t.wasi.stdin,stdout:t.wasi.stdout,stderr:t.wasi.stderr});const a=await n.instantiate({wasi:s}),o=new Ia.RSocketConnector({setup:{keepAlive:1e4,lifetime:20*1e3},transport:Ca(n,t.workerUrl,t.wasi)});return new Hn(a,i,await o.connect())}terminate(){this.connection.close()}}class Em{constructor(e,t){F(this,"component");F(this,"setupPromise");this.component=e,this.setupPromise=this.setup(t)}async initialized(){await this.setupPromise,Nt("WasmRS component initialized")}async setup(e={}){e.imported||(e.imported={}),e.provided||(e.provided={});const t={data:gm.encode(e),metadata:I.Buffer.from([0,0,0,0,0,0,0,0])};return Nt("WasmRS component sending setup request"),new Promise((n,i)=>{this.component.rsocket().requestResponse(t,{onError:s=>{Nt("WasmRS component setup error",{error:s}),i(s)},onNext:(s,a)=>{Nt("WasmRS component setup complete",{payload:s,isComplete:a}),n(s)},onComplete:()=>{},onExtension:()=>{}})})}invoke(e,t,n={}){const i=this.component.operations.getExport("wick",e);Nt("invoking wasmRS component");const s={config:n,inherent:{seed:0,timestamp:0}},a=t.pipe(cl((l,u)=>u===0?ba(l).pipe($i(c=>new uf(i,c,s).intoPayload())):ba(l.intoPayload())));return pm(a)(this.component.rsocket()).pipe($i(l=>{let u,c="";if(l.metadata)u=Vn.decode(l.metadata),c=u.port;else throw Nt("payload came in with no metadata"),new Error("payload came in with no metadata");return new Kt(c,l.data,0)}))}}class Ml{}F(Ml,"WasmRs",Hn);class Bl{}F(Bl,"Component",Ml);const bm=""+new URL("../workers/component-worker-290b246e.js",import.meta.url).href,_m={version:Gi.SnapshotPreview1,args:[],env:{},preopens:{},stdin:0,stdout:1,stderr:2};async function wm(r){try{let e;return ru||(e=new URL(bm,import.meta.url)),await Bl.Component.WasmRs.FromBytes(r,{wasi:_m,workerUrl:e})}catch(e){throw console.error("Error instantiating component",e),e}}function Ua(r){let e,t;return{c(){e=se("h2"),t=Ft(r[0]),this.h()},l(n){e=ae(n,"H2",{class:!0});var i=fe(e);t=xt(i,r[0]),i.forEach(L),this.h()},h(){pe(e,"class","text-center text-lg font-bold")},m(n,i){J(n,e,i),de(e,t)},p(n,i){i&1&&Or(t,n[0])},d(n){n&&L(e)}}}function Sm(r){let e,t,n,i=r[0]&&Ua(r);const s=r[2].default,a=ct(s,r,r[1],null);return{c(){e=se("div"),i&&i.c(),t=xe(),a&&a.c(),this.h()},l(o){e=ae(o,"DIV",{class:!0});var l=fe(e);i&&i.l(l),t=Ie(l),a&&a.l(l),l.forEach(L),this.h()},h(){pe(e,"class","w-full mt-4")},m(o,l){J(o,e,l),i&&i.m(e,null),de(e,t),a&&a.m(e,null),n=!0},p(o,[l]){o[0]?i?i.p(o,l):(i=Ua(o),i.c(),i.m(e,t)):i&&(i.d(1),i=null),a&&a.p&&(!n||l&2)&&dt(a,s,o,o[1],n?ht(s,o[1],l,null):ft(o[1]),null)},i(o){n||(Q(a,o),n=!0)},o(o){$(a,o),n=!1},d(o){o&&L(e),i&&i.d(),a&&a.d(o)}}}function Rm(r,e,t){let{$$slots:n={},$$scope:i}=e,{header:s=void 0}=e;return r.$$set=a=>{"header"in a&&t(0,s=a.header),"$$scope"in a&&t(1,i=a.$$scope)},[s,i,n]}class Tm extends Lt{constructor(e){super(),Mt(this,e,Rm,Sm,ut,{header:0})}}function Na(r,e,t){const n=r.slice();return n[1]=e[t],n}function Da(r,e,t){const n=r.slice();return n[4]=e[t],n}function Pa(r){let e=r[4]+"",t,n;return{c(){t=Ft(e),n=se("br")},l(i){t=xt(i,e),n=ae(i,"BR",{})},m(i,s){J(i,t,s),J(i,n,s)},p(i,s){s&1&&e!==(e=i[4]+"")&&Or(t,e)},d(i){i&&(L(t),L(n))}}}function ka(r){let e,t,n=wt(r[1].split(`
`)),i=[];for(let s=0;s<n.length;s+=1)i[s]=Pa(Da(r,n,s));return{c(){e=se("p");for(let s=0;s<i.length;s+=1)i[s].c();t=xe(),this.h()},l(s){e=ae(s,"P",{class:!0});var a=fe(e);for(let o=0;o<i.length;o+=1)i[o].l(a);t=Ie(a),a.forEach(L),this.h()},h(){pe(e,"class","output svelte-1z0qb7w")},m(s,a){J(s,e,a);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);de(e,t)},p(s,a){if(a&1){n=wt(s[1].split(`
`));let o;for(o=0;o<n.length;o+=1){const l=Da(s,n,o);i[o]?i[o].p(l,a):(i[o]=Pa(l),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=n.length}},d(s){s&&L(e),tn(i,s)}}}function Am(r){let e,t,n='<svg xmlns="http://www.w3.org/2000/svg" width="54" height="14" viewBox="0 0 54 14"><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><circle cx="6" cy="6" r="6" fill="#FF5F56" stroke="#E0443E" stroke-width=".5"></circle><circle cx="26" cy="6" r="6" fill="#FFBD2E" stroke="#DEA123" stroke-width=".5"></circle><circle cx="46" cy="6" r="6" fill="#27C93F" stroke="#1AAB29" stroke-width=".5"></circle></g></svg>',i,s=wt(r[0]),a=[];for(let o=0;o<s.length;o+=1)a[o]=ka(Na(r,s,o));return{c(){e=se("section"),t=se("div"),t.innerHTML=n,i=xe();for(let o=0;o<a.length;o+=1)a[o].c();this.h()},l(o){e=ae(o,"SECTION",{class:!0});var l=fe(e);t=ae(l,"DIV",{class:!0,"data-svelte-h":!0}),Ya(t)!=="svelte-fbn2ty"&&(t.innerHTML=n),i=Ie(l);for(let u=0;u<a.length;u+=1)a[u].l(l);l.forEach(L),this.h()},h(){pe(t,"class","bar svelte-1z0qb7w"),pe(e,"class","terminal svelte-1z0qb7w")},m(o,l){J(o,e,l),de(e,t),de(e,i);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null)},p(o,[l]){if(l&1){s=wt(o[0]);let u;for(u=0;u<s.length;u+=1){const c=Na(o,s,u);a[u]?a[u].p(c,l):(a[u]=ka(c),a[u].c(),a[u].m(e,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=s.length}},i:er,o:er,d(o){o&&L(e),tn(a,o)}}}function Fm(r,e,t){let{lines:n=[]}=e;return r.$$set=i=>{"lines"in i&&t(0,n=i.lines)},[n]}class xm extends Lt{constructor(e){super(),Mt(this,e,Fm,Am,ut,{lines:0})}}function La(r,e,t){const n=r.slice();return n[13]=e[t],n}function Ma(r,e,t){const n=r.slice();return n[13]=e[t],n}function Im(r){let e,t,n,i,s,a,o,l,u,c;n=new is({props:{for:"operation",$$slots:{default:[Om]},$$scope:{ctx:r}}});function d(g){r[7](g)}let f={id:"operation",class:"",items:r[1].signature.operations.map(Qa)};r[0]!==void 0&&(f.value=r[0]),s=new zc({props:f}),es.push(()=>Kl(s,"value",d));let h=r[0]&&Ba(r),v=r[2].length>0&&Va(r);return{c(){e=se("div"),t=se("div"),st(n.$$.fragment),i=xe(),st(s.$$.fragment),o=xe(),h&&h.c(),l=xe(),v&&v.c(),u=Ce(),this.h()},l(g){e=ae(g,"DIV",{class:!0});var m=fe(e);t=ae(m,"DIV",{class:!0});var E=fe(t);at(n.$$.fragment,E),i=Ie(E),at(s.$$.fragment,E),E.forEach(L),o=Ie(m),h&&h.l(m),m.forEach(L),l=Ie(g),v&&v.l(g),u=Ce(),this.h()},h(){pe(t,"class","flex flex-row items-center w-full"),pe(e,"class","p-5 flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600")},m(g,m){J(g,e,m),de(e,t),ot(n,t,null),de(t,i),ot(s,t,null),de(e,o),h&&h.m(e,null),J(g,l,m),v&&v.m(g,m),J(g,u,m),c=!0},p(g,m){const E={};m&262144&&(E.$$scope={dirty:m,ctx:g}),n.$set(E);const w={};m&2&&(w.items=g[1].signature.operations.map(Qa)),!a&&m&1&&(a=!0,w.value=g[0],Zl(()=>a=!1)),s.$set(w),g[0]?h?(h.p(g,m),m&1&&Q(h,1)):(h=Ba(g),h.c(),Q(h,1),h.m(e,null)):h&&(Rt(),$(h,1,1,()=>{h=null}),Tt()),g[2].length>0?v?(v.p(g,m),m&4&&Q(v,1)):(v=Va(g),v.c(),Q(v,1),v.m(u.parentNode,u)):v&&(Rt(),$(v,1,1,()=>{v=null}),Tt())},i(g){c||(Q(n.$$.fragment,g),Q(s.$$.fragment,g),Q(h),Q(v),c=!0)},o(g){$(n.$$.fragment,g),$(s.$$.fragment,g),$(h),$(v),c=!1},d(g){g&&(L(e),L(l),L(u)),lt(n),lt(s),h&&h.d(),v&&v.d(g)}}}function Cm(r){let e,t;return e=new Ic({props:{class:"flex flex-col justify-center items-center w-full bg-gray-50 h-fit rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600",$$slots:{default:[Pm]},$$scope:{ctx:r}}}),e.$on("drop",r[4]),e.$on("dragover",Bm),e.$on("change",r[5]),{c(){st(e.$$.fragment)},l(n){at(e.$$.fragment,n)},m(n,i){ot(e,n,i),t=!0},p(n,i){const s={};i&262144&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){lt(e,n)}}}function Om(r){let e;return{c(){e=Ft("Operation")},l(t){e=xt(t,"Operation")},m(t,n){J(t,e,n)},d(t){t&&L(e)}}}function Ba(r){let e,t,n,i,s,a,o,l=r[0].config.length>0&&qa(),u=wt(r[0].config),c=[];for(let m=0;m<u.length;m+=1)c[m]=za(Ma(r,u,m));const d=m=>$(c[m],1,1,()=>{c[m]=null});let f=r[0].inputs.length>0&&Ha(),h=wt(r[0].inputs),v=[];for(let m=0;m<h.length;m+=1)v[m]=Ga(La(r,h,m));const g=m=>$(v[m],1,1,()=>{v[m]=null});return a=new gc({props:{class:"mt-2",$$slots:{default:[Dm]},$$scope:{ctx:r}}}),a.$on("click",r[6]),{c(){e=se("div"),l&&l.c(),t=xe();for(let m=0;m<c.length;m+=1)c[m].c();n=xe(),f&&f.c(),i=xe();for(let m=0;m<v.length;m+=1)v[m].c();s=xe(),st(a.$$.fragment),this.h()},l(m){e=ae(m,"DIV",{class:!0});var E=fe(e);l&&l.l(E),t=Ie(E);for(let w=0;w<c.length;w+=1)c[w].l(E);n=Ie(E),f&&f.l(E),i=Ie(E);for(let w=0;w<v.length;w+=1)v[w].l(E);E.forEach(L),s=Ie(m),at(a.$$.fragment,m),this.h()},h(){pe(e,"class","w-full")},m(m,E){J(m,e,E),l&&l.m(e,null),de(e,t);for(let w=0;w<c.length;w+=1)c[w]&&c[w].m(e,null);de(e,n),f&&f.m(e,null),de(e,i);for(let w=0;w<v.length;w+=1)v[w]&&v[w].m(e,null);J(m,s,E),ot(a,m,E),o=!0},p(m,E){if(m[0].config.length>0?l?l.p(m,E):(l=qa(),l.c(),l.m(e,t)):l&&(l.d(1),l=null),E&1){u=wt(m[0].config);let A;for(A=0;A<u.length;A+=1){const S=Ma(m,u,A);c[A]?(c[A].p(S,E),Q(c[A],1)):(c[A]=za(S),c[A].c(),Q(c[A],1),c[A].m(e,n))}for(Rt(),A=u.length;A<c.length;A+=1)d(A);Tt()}if(m[0].inputs.length>0?f?f.p(m,E):(f=Ha(),f.c(),f.m(e,i)):f&&(f.d(1),f=null),E&1){h=wt(m[0].inputs);let A;for(A=0;A<h.length;A+=1){const S=La(m,h,A);v[A]?(v[A].p(S,E),Q(v[A],1)):(v[A]=Ga(S),v[A].c(),Q(v[A],1),v[A].m(e,null))}for(Rt(),A=h.length;A<v.length;A+=1)g(A);Tt()}const w={};E&262144&&(w.$$scope={dirty:E,ctx:m}),a.$set(w)},i(m){if(!o){for(let E=0;E<u.length;E+=1)Q(c[E]);for(let E=0;E<h.length;E+=1)Q(v[E]);Q(a.$$.fragment,m),o=!0}},o(m){c=c.filter(Boolean);for(let E=0;E<c.length;E+=1)$(c[E]);v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)$(v[E]);$(a.$$.fragment,m),o=!1},d(m){m&&(L(e),L(s)),l&&l.d(),tn(c,m),f&&f.d(),tn(v,m),lt(a,m)}}}function qa(r){let e,t;return{c(){e=se("h3"),t=Ft("Configuration"),this.h()},l(n){e=ae(n,"H3",{class:!0});var i=fe(e);t=xt(i,"Configuration"),i.forEach(L),this.h()},h(){pe(e,"class",Gl)},m(n,i){J(n,e,i),de(e,t)},p:er,d(n){n&&L(e)}}}function Um(r){let e,t=r[13].name+"",n;return{c(){e=se("b"),n=Ft(t)},l(i){e=ae(i,"B",{});var s=fe(e);n=xt(s,t),s.forEach(L)},m(i,s){J(i,e,s),de(e,n)},p(i,s){s&1&&t!==(t=i[13].name+"")&&Or(n,t)},d(i){i&&L(e)}}}function za(r){let e,t,n,i,s;return t=new is({props:{for:"config_"+r[13].name,text:r[13].name,class:ql,$$slots:{default:[Um]},$$scope:{ctx:r}}}),i=new ro({props:{id:"config_"+r[13].name,class:zl,placeholder:""}}),{c(){e=se("div"),st(t.$$.fragment),n=xe(),st(i.$$.fragment),this.h()},l(a){e=ae(a,"DIV",{class:!0});var o=fe(e);at(t.$$.fragment,o),n=Ie(o),at(i.$$.fragment,o),o.forEach(L),this.h()},h(){pe(e,"class",Hl)},m(a,o){J(a,e,o),ot(t,e,null),de(e,n),ot(i,e,null),s=!0},p(a,o){const l={};o&1&&(l.for="config_"+a[13].name),o&1&&(l.text=a[13].name),o&262145&&(l.$$scope={dirty:o,ctx:a}),t.$set(l);const u={};o&1&&(u.id="config_"+a[13].name),i.$set(u)},i(a){s||(Q(t.$$.fragment,a),Q(i.$$.fragment,a),s=!0)},o(a){$(t.$$.fragment,a),$(i.$$.fragment,a),s=!1},d(a){a&&L(e),lt(t),lt(i)}}}function Ha(r){let e,t;return{c(){e=se("h3"),t=Ft("Inputs"),this.h()},l(n){e=ae(n,"H3",{class:!0});var i=fe(e);t=xt(i,"Inputs"),i.forEach(L),this.h()},h(){pe(e,"class",Gl)},m(n,i){J(n,e,i),de(e,t)},p:er,d(n){n&&L(e)}}}function Nm(r){let e,t=r[13].name+"",n;return{c(){e=se("b"),n=Ft(t)},l(i){e=ae(i,"B",{});var s=fe(e);n=xt(s,t),s.forEach(L)},m(i,s){J(i,e,s),de(e,n)},p(i,s){s&1&&t!==(t=i[13].name+"")&&Or(n,t)},d(i){i&&L(e)}}}function Ga(r){let e,t,n,i,s,a;return t=new is({props:{for:"input_"+r[13].name,text:r[13].name,class:ql,$$slots:{default:[Nm]},$$scope:{ctx:r}}}),i=new ro({props:{id:"input_"+r[13].name,class:zl}}),{c(){e=se("div"),st(t.$$.fragment),n=xe(),st(i.$$.fragment),s=xe(),this.h()},l(o){e=ae(o,"DIV",{class:!0});var l=fe(e);at(t.$$.fragment,l),n=Ie(l),at(i.$$.fragment,l),s=Ie(l),l.forEach(L),this.h()},h(){pe(e,"class",Hl)},m(o,l){J(o,e,l),ot(t,e,null),de(e,n),ot(i,e,null),de(e,s),a=!0},p(o,l){const u={};l&1&&(u.for="input_"+o[13].name),l&1&&(u.text=o[13].name),l&262145&&(u.$$scope={dirty:l,ctx:o}),t.$set(u);const c={};l&1&&(c.id="input_"+o[13].name),i.$set(c)},i(o){a||(Q(t.$$.fragment,o),Q(i.$$.fragment,o),a=!0)},o(o){$(t.$$.fragment,o),$(i.$$.fragment,o),a=!1},d(o){o&&L(e),lt(t),lt(i)}}}function Dm(r){let e;return{c(){e=Ft("Execute")},l(t){e=xt(t,"Execute")},m(t,n){J(t,e,n)},d(t){t&&L(e)}}}function Va(r){let e,t,n;return t=new xm({props:{lines:r[2]}}),{c(){e=se("div"),st(t.$$.fragment),this.h()},l(i){e=ae(i,"DIV",{class:!0});var s=fe(e);at(t.$$.fragment,s),s.forEach(L),this.h()},h(){pe(e,"class","mt-3")},m(i,s){J(i,e,s),ot(t,e,null),n=!0},p(i,s){const a={};s&4&&(a.lines=i[2]),t.$set(a)},i(i){n||(Q(t.$$.fragment,i),n=!0)},o(i){$(t.$$.fragment,i),n=!1},d(i){i&&L(e),lt(t)}}}function Pm(r){let e,t='<svg aria-hidden="true" class="mb-3 w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <p class="mb-2 text-sm text-gray-500 dark:text-gray-400"><span class="font-semibold">Click to upload</span> or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-400">a Wick .wasm file</p>';return{c(){e=se("div"),e.innerHTML=t,this.h()},l(n){e=ae(n,"DIV",{class:!0,"data-svelte-h":!0}),Ya(e)!=="svelte-1pkbuw5"&&(e.innerHTML=t),this.h()},h(){pe(e,"class","h-64 flex flex-col justify-center items-center")},m(n,i){J(n,e,i)},p:er,d(n){n&&L(e)}}}function km(r){let e,t,n,i;const s=[Cm,Im],a=[];function o(l,u){return l[1]?1:0}return e=o(r),t=a[e]=s[e](r),{c(){t.c(),n=Ce()},l(l){t.l(l),n=Ce()},m(l,u){a[e].m(l,u),J(l,n,u),i=!0},p(l,u){let c=e;e=o(l),e===c?a[e].p(l,u):(Rt(),$(a[c],1,1,()=>{a[c]=null}),Tt(),t=a[e],t?t.p(l,u):(t=a[e]=s[e](l),t.c()),Q(t,1),t.m(n.parentNode,n))},i(l){i||(Q(t),i=!0)},o(l){$(t),i=!1},d(l){l&&L(n),a[e].d(l)}}}function Lm(r){let e,t;return e=new Tm({props:{header:"Wick Component Loader",$$slots:{default:[km]},$$scope:{ctx:r}}}),{c(){st(e.$$.fragment)},l(n){at(e.$$.fragment,n)},m(n,i){ot(e,n,i),t=!0},p(n,[i]){const s={};i&262151&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){lt(e,n)}}}const ql="w-1/3 text-right pr-5",zl="w-2/3 ",Hl="flex flex-row items-center w-full",Gl="text-center";function Mm(r){const e={};for(const t of r.config){const n=document.getElementById(`config_${t.name}`);e[t.name]=t.type==="string"?n.value:JSON.parse(n.value)}return e}const Bm=r=>{r.preventDefault()},Qa=r=>({value:r,name:r.name});function qm(r,e,t){let n,i,s=eu([]);jl(r,s,m=>t(2,n=m));let a;async function o(m){a||t(1,a=await wm(m)),t(0,i=a.signature.operations[0])}function l(m){const E=[];for(const w of m.inputs){const A=document.getElementById(`input_${w.name}`);let S=w.type==="string"?A.value:JSON.parse(A.value);E.push(new Kt(w.name,Cu(S))),E.push(Kt.Done(w.name))}return gd(E)}async function u(m,E){const w=await m.instantiate({config:{}}),A=Mm(E),S=l(E);(await w.invoke(E.name,S,A)).subscribe({next(M){if(!M.data)return;const W=zu(M.data);s.update(Z=>(Z.push(JSON.stringify(W)),Z))},complete(){s.update(M=>(M.push("<Done>"),M))},error(M){s.update(W=>(W.push(`<Error:${M}>`),W)),console.error(M)}})}Jl(c);function c(){a&&a.terminate()}function d(m){var w;m.preventDefault();const E=(w=m.dataTransfer)==null?void 0:w.files;h(E)}function f(m){const E=m.target,w=(E==null?void 0:E.files)||void 0;h(w)}function h(m){if(c(),!!m)for(let E=0;E<m.length;E++){const w=m[E];console.log({fileType:w.type}),w.type.startsWith("application/wasm")&&w.arrayBuffer().then(A=>{o(new Uint8Array(A))})}}function v(m){if(!a){console.warn("component already terminated, aborting invocation");return}if(!i){console.warn("no operation, aborting invocation");return}u(a,i)}function g(m){i=m,t(0,i)}return[i,a,n,s,d,f,v,g]}class Xm extends Lt{constructor(e){super(),Mt(this,e,qm,Lm,ut,{})}}export{Xm as component};
